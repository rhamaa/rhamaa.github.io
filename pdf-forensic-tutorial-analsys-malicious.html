<!DOCTYPE html>
<html>
<head>
    <!-- [[! Document Settings ]] -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- [[! Page Meta ]] -->
    <title>[PDF Forensic] Tutorial Analysis "Malicious" PDF File</title>
    <meta name="description" content="uid=0 (root) - CTF, InfoSec, Banana And More.." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/assets/images/favicon.ico" >

    <!-- [[! Styles'n'Scripts ]] -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css"
          href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />

    <!-- [[! highlight.js ]] -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- [[! Ghost outputs important style and meta data with this tag ]] -->
        <link rel="canonical" href="/" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="/page2/" />

    <meta property="og:site_name" content="uid=0 (root)" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="uid=0 (root)" />
    <meta property="og:description" content="CTF, InfoSec, Banana And More.." />
    <meta property="og:url" content="/" />
    <meta property="og:image" content="/assets/images/cover1.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="uid=0 (root)" />
    <meta name="twitter:description" content="CTF, InfoSec, Banana And More.." />
    <meta name="twitter:url" content="/" />
    <meta name="twitter:image:src" content="/assets/images/cover1.jpg" />

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "uid=0",
    "url": "/",
    "image": "/assets/images/cover1.jpg",
    "description": "CTF, InfoSec, Banana And More.."
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="uid=0 (root)" href="/feed.xml" />


</head>
<body class="home-template nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Home</a></li>
        <li class="nav-about " role="presentation"><a href="/about">About</a></li>
         <li class="nav-archive " role="presentation"><a href="/archive">Archives</a></li>
        <li class="nav-fables " role="presentation"><a href="/tag/CTF">CTF</a></li>
        <li class="nav-speeches " role="presentation"><a href="/tag/Digital Forensic">Digital Forensic</a></li>
        <li class="nav-fiction " role="presentation"><a href="/tag/Pentesting">Pentesting</a></li>
        <li class="nav-author " role="presentation"><a href="/tag/RE">Rerverse Engineering</a></li>
    </ul>
    <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- [[! Everything else gets inserted here ]] -->
        <!-- < default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<header class="main-header post-head " style="background-image: url(/assets/images/forensic.jpg) ">
    <nav class="main-nav  overlay  clearfix">
        <a class="blog-logo" href="/"><img src="/assets/images/ghost.png" alt="Blog Logo" /></a>
        
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-fiction">

        <header class="post-header">
            <h1 class="post-title">[PDF Forensic] Tutorial Analysis "Malicious" PDF File</h1>
            <section class="post-meta">
            <!-- <a href='/'>Aiden Pearce</a> -->
            <time class="post-date" datetime="2016-08-07">07 Aug 2016</time>
                <!-- [[tags prefix=" on "]] -->
                 
                on 
                
                    
                       <a href='/tag/Digital Forensic'>Digital forensic</a>
                       
                
                
            </section>
        </header>

        <section class="post-content">
            
            <ul id="markdown-toc">
  <li><a href="#scanning-pdf-keyword-dengan-pdfid" id="markdown-toc-scanning-pdf-keyword-dengan-pdfid">Scanning PDF Keyword dengan pdfid</a></li>
  <li><a href="#analsys-pdf-dengan-pdf-parser" id="markdown-toc-analsys-pdf-dengan-pdf-parser">Analsys PDF Dengan pdf-parser</a></li>
  <li><a href="#analsys-pdf-dengan-peepdf" id="markdown-toc-analsys-pdf-dengan-peepdf">Analsys PDF Dengan peepdf</a></li>
</ul>

<p><b>
	<span style="font-size: large;">assalamualaikum..</span>
</b></p>

<p><span style="font-size: large;">T</span>
<b>utorial Analsys “Malicious” PDF File</b> - Terkadang kita sering mendownload ebook dengan filetype PDF tanpa memperhatikan apakah file PDF tersebut benar-benar aman atau ada sebuah code yang mencurigakan. Oleh karena itu saya membuat posting ini agar kita selalu berhati-hati dalam mendownload berbagai file sehingga tidak terjadi hal yang tidak diinginkan saat mengeksekusi file tersebut.</p>

<p><b>Tool Yang Digunakan Untuk PDF Forensic</b></p>

<ul>
	<li>pdfid</li>
	<li>pdf-parser</li>
	<li>peepdf</li>
</ul>
<p>Saya menggunakan exploit 
<code>adobe_collectemailinfo</code>yang tersedia di metasploit sebagai bahan uji coba. perlu diketahui saya disini tidak membahas exploit nya.</p>

<h1 id="scanning-pdf-keyword-dengan-pdfid">Scanning PDF Keyword dengan pdfid</h1>
<p>Dimana step ini dibutuhkan untuk mengidentifikasi apakah terdapat berbagai Action tertentu saat file PDF dibuka.</p>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://4.bp.blogspot.com/-gWQoXwwdfp4/V6YYUstsmFI/AAAAAAAABA4/K0Rr5grA8z0Kjgtqm8jg2sADKwBzEqQmgCLcB/s1600/1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img alt="Tutorial Analsys &quot;Malicious&quot; PDF File" border="0" height="320" src="https://4.bp.blogspot.com/-gWQoXwwdfp4/V6YYUstsmFI/AAAAAAAABA4/K0Rr5grA8z0Kjgtqm8jg2sADKwBzEqQmgCLcB/s320/1.png" title="Tutorial Analsys &quot;Malicious&quot; PDF File" width="294" />
	</a>
</div>

<p><b>/JS &amp; /Javascript</b> : file pdf mengandung code javascript yang akan dieksekusi</p>

<p><b>/AA (Additional Action) atau /OpenAction</b> : akan otomatis mengeksekusi Action atau script tertentu saat file dibuka.</p>

<h1 id="analsys-pdf-dengan-pdf-parser">Analsys PDF Dengan pdf-parser</h1>
<p>Setelah melakukan scanning, tahap selanjut nya adalah dengan meneliti alur dari OpenAction agar kita dapat mengetahui object mana saja yang dilewati saat file PDF tersebut dibuka.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>pdf-parser --search<span class="o">=</span>OpenAction malicious.pdf</code></pre></figure>

<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
	<tbody>
		<tr>
			<td style="text-align: center;">
				<a href="https://2.bp.blogspot.com/-97ioaehNg0w/V6YZY94u6fI/AAAAAAAABBA/ZteD7cxySbA_YkOLaTkrvMe4OP88fSOWgCLcB/s1600/Selection_001.png" imageanchor="1" style="margin-left: auto; margin-right: auto;">
					<img alt="Tutorial Analsys &quot;Malicious&quot; PDF File" border="0" height="141" src="https://2.bp.blogspot.com/-97ioaehNg0w/V6YZY94u6fI/AAAAAAAABBA/ZteD7cxySbA_YkOLaTkrvMe4OP88fSOWgCLcB/s400/Selection_001.png" title="Tutorial Analsys &quot;Malicious&quot; PDF File" width="400" />
				</a>
			</td>
		</tr>
		<tr>
			<td class="tr-caption" style="text-align: center;">OpenAction Merujuk atau mengarah ke object 5</td>
		</tr>
	</tbody>
</table>
<p>Ikuti ke object 5</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>pdf-parser --object<span class="o">=</span><span class="m">5</span> malicious.pdf</code></pre></figure>

<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
	<tbody>
		<tr>
			<td style="text-align: center;">
				<a href="https://2.bp.blogspot.com/-PMW5idx6rxA/V6YaMLt_xoI/AAAAAAAABBE/wD2s2agdsSkxtli9SPe1wtfcNdLS5qMtgCEw/s1600/Selection_002.png" imageanchor="1" style="margin-left: auto; margin-right: auto;">
					<img alt="Tutorial Analsys &quot;Malicious&quot; PDF File" border="0" height="145" src="https://2.bp.blogspot.com/-PMW5idx6rxA/V6YaMLt_xoI/AAAAAAAABBE/wD2s2agdsSkxtli9SPe1wtfcNdLS5qMtgCEw/s400/Selection_002.png" title="Tutorial Analsys &quot;Malicious&quot; PDF File" width="400" />
				</a>
			</td>
		</tr>
		<tr>
			<td class="tr-caption" style="text-align: center;">JS mengarah ke object 6</td>
		</tr>
	</tbody>
</table>
<p>Lalu ikuti lagi menuju object 6</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>pdf-parser --object<span class="o">=</span><span class="m">6</span> malicious.pdf</code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://3.bp.blogspot.com/-BJ4sQ8sClX8/V6YasILu6zI/AAAAAAAABBM/TwZeNGZVp7UvZPTCSo1Gf_rAlxBh3F5PgCLcB/s1600/Selection_003.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img alt="Tutorial Analsys &quot;Malicious&quot; PDF File" border="0" height="125" src="https://3.bp.blogspot.com/-BJ4sQ8sClX8/V6YasILu6zI/AAAAAAAABBM/TwZeNGZVp7UvZPTCSo1Gf_rAlxBh3F5PgCLcB/s400/Selection_003.png" title="Tutorial Analsys &quot;Malicious&quot; PDF File" width="400" />
	</a>
</div>
<p>Pada object 6 terdapat filter, filter digunakan untuk mengompress. <br /></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>Hex String : 
/Fl#61t#65#44#65co#64e/A#53#43I#49#48#65#78D#65c#6fde
<span class="c1">#apabila didecode akan menghasilkan </span>
/FlateDecode /ASCIIHexDecode</code></pre></figure>

<p>Untuk melihat isi dari konten yang compress :</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>	pdf-parser --object<span class="o">=</span><span class="m">6</span> --filter malicious.pdf</code></pre></figure>

<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
	<tbody>
		<tr>
			<td style="text-align: center;">
				<a href="https://2.bp.blogspot.com/-ReFHyulo6Ew/V6YbebqpNfI/AAAAAAAABBY/vGL1hd8wsBMbDNTPNBkN4NaqXXL2dFbXQCLcB/s1600/Selection_004.png" imageanchor="1" style="margin-left: auto; margin-right: auto;">
					<img alt="Tutorial Analsys &quot;Malicious&quot; PDF File" border="0" height="300" src="https://2.bp.blogspot.com/-ReFHyulo6Ew/V6YbebqpNfI/AAAAAAAABBY/vGL1hd8wsBMbDNTPNBkN4NaqXXL2dFbXQCLcB/s400/Selection_004.png" title="Tutorial Analsys &quot;Malicious&quot; PDF File" width="400" />
				</a>
			</td>
		</tr>
		<tr>
			<td class="tr-caption" style="text-align: center;">Hore, ternyata itu javascript yang kita cari.</td>
		</tr>
	</tbody>
</table>
<p> Apabila script JS tersebut ingin diDump dapat menggunakan command</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>	pdf-parser --object<span class="o">=</span><span class="m">6</span> --filter --raw --dump<span class="o">=</span>/path/to/dir/ malicious.pdf</code></pre></figure>

<h1 id="analsys-pdf-dengan-peepdf">Analsys PDF Dengan peepdf</h1>

<p>Sama hal nya seperti pdf-parser, peepdf tool yang digunakan untuk pdf forensic.
Langsung saja, gunakan peepdf dalam 
<i>interactive mode</i></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>peepdf -i malicious.pdf</code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://4.bp.blogspot.com/-TSN29IyTv60/V6YcsmyToHI/AAAAAAAABBk/7BhneIkZxFc7uS14G0KgB5s0K7DqGA1vgCLcB/s1600/Selection_005.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img alt="Tutorial Analsys &quot;Malicious&quot; PDF File" border="0" height="386" src="https://4.bp.blogspot.com/-TSN29IyTv60/V6YcsmyToHI/AAAAAAAABBk/7BhneIkZxFc7uS14G0KgB5s0K7DqGA1vgCLcB/s400/Selection_005.png" title="Tutorial Analsys &quot;Malicious&quot; PDF File" width="400" />
	</a>
</div>
<p>”
<i>Suspicious Element</i>” nya langsung ditemukan,dan karena file yang “
<i>malicious.pdf</i>” yang saya gunakan sama dengan saat menggunakan pdf-parser alur nya sudah kita ketahui, jadi langsung saja menuju object 6 dimana terdapat “
<i>Objects with JS code</i>”.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>object <span class="m">6</span></code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://2.bp.blogspot.com/-bx8ex1DlGAc/V6YgB7V9inI/AAAAAAAABBw/B6dVVMuqwVQj9Os2QbiUHgc75Ev4YyHhQCLcB/s1600/Screenshot%2B-%2B08072016%2B-%2B01%253A35%253A44%2BAM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img alt="Tutorial Analsys &quot;Malicious&quot; PDF File" border="0" height="278" src="https://2.bp.blogspot.com/-bx8ex1DlGAc/V6YgB7V9inI/AAAAAAAABBw/B6dVVMuqwVQj9Os2QbiUHgc75Ev4YyHhQCLcB/s400/Screenshot%2B-%2B08072016%2B-%2B01%253A35%253A44%2BAM.png" title="Tutorial Analsys &quot;Malicious&quot; PDF File" width="400" />
	</a>
</div>
<p>Apabila ingin didump jalankan perintah dibawah ini ( di interactice mode ) :</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="nb">set</span> output file /path/to/dirobject <span class="m">6</span></code></pre></figure>

<p>Sekian tutorial sederhana dari saya, semoga dapat bermanfaat bagi kita semua, dan saya  mohon maaf apabila ada salah dalam pemberian definisi maupun penjelasan.</p>


        </section>

        <footer class="post-footer">

            <!-- Everything inside the #author tags pulls data from the author -->
            <!-- #author-->

            
            <figure class="author-image">
                <a class="img" href="/author/rhama" style="background-image: url(/assets/images/casper.png)"><span class="hidden">Aiden Pearce's Picture</span></a>
            </figure>
            

            <section class="author">
                <h4><a href="/author/rhama">Aiden Pearce</a></h4>
                
                
                    <p> Beyond The Limit</p>
                
                <div class="author-meta">
                    <span class="author-location icon-location"> NTB, Indonesia</span> 
                    <span class="author-link icon-link"><a href="127.0.0.1:4000"> 127.0.0.1:4000</a></span> 
                </div>
            </section>

            <!-- /author  -->

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=[PDF Forensic] Tutorial Analysis "Malicious" PDF File&amp;url=127.0.0.1:4000pdf-forensic-tutorial-analsys-malicious"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=127.0.0.1:4000pdf-forensic-tutorial-analsys-malicious"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=127.0.0.1:4000pdf-forensic-tutorial-analsys-malicious"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>
            
            <!-- Add Disqus Comments -->
            
            
        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
        <a class="read-next-story " style="background-image: url(/assets/images/forensic.jpg)" href="/windows-forensic-artifact-registry-part">
            <section class="post">
                <h2>Windows Forensic Artifact - Registry Part 1</h2>
                <p>Menurut Wikipedia, Registry, dalam platform sistem operasi Microsoft Windows 32-bit, merupakan sebuah basis data yang...</p>
            </section>
        </a>
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/forensic.jpg)" href="/pembahasan-soal-level-1-cdc-2015">
            <section class="post">
                <h2>CDC 2015 OFFLINE - POST.PCAPNG Write Up</h2>
                <p>assalamualaikum...saya akan mencoba membahas soal forensic cdc offline 2015.soal nya dapat didownload disini :Soal OfflinePass...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->


        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">uid=0 (root)</a> &copy; 2017</section>
          <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/biomadeira/jasper">Jasper</a></section>
        </footer>
    </div>
    <!-- [[! Ghost outputs important scripts and data with this tag ]] -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <!-- [[! The main JavaScript file for Casper ]] -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-69281367-1', 'auto');
	    ga('send', 'pageview');

     </script>   
</body>
</html>
