<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Windows Forensic Artifact - Registry Part 1</title>
  <meta name="description" content="Menurut Wikipedia, Registry, dalam platform sistem operasi Microsoft Windows 32-bit, merupakan sebuah basis data yang disusun secara hierarkis yang mengandun...">
  
  <meta name="author" content="rhama">
  <meta name="copyright" content="&copy; rhama 2017">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="Menurut Wikipedia, Registry, dalam platform sistem operasi Microsoft Windows 32-bit, merupakan sebuah basis data yang disusun secara hierarkis yang mengandun..." />
  <meta property="og:url" content="https://rhama.my.id" />
  <meta property="og:site_name" content="CTF.Ninja" />
  <meta property="og:title" content="Windows Forensic Artifact - Registry Part 1" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://rhama.my.id/assets/images/forensic.jpg" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Windows Forensic Artifact - Registry Part 1">
  <meta name="twitter:description" content="Menurut Wikipedia, Registry, dalam platform sistem operasi Microsoft Windows 32-bit, merupakan sebuah basis data yang disusun secara hierarkis yang mengandun...">
  <meta name="twitter:image" content="https://rhama.my.id/assets/images/forensic.jpg">
  <meta name="twitter:url" content="https://rhama.my.id">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
   <link rel="stylesheet" href="/css/terminal.css">
  <link rel="canonical" href="https://rhama.my.id/digital/forensic/2016/10/06/windows-forensic-artifact-registry-part.html">
  <link rel="alternate" type="application/rss+xml" title="CTF.Ninja" href="https://rhama.my.id/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="CTF.Ninja">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
          <li class="nav-link"><a href="/posts/">Archives</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/images/forensic.jpg);">
  <div class="scrim has-cover">
    <header class="post-header">
      <h1 class="title">Windows Forensic Artifact - Registry Part 1</h1>
      <p class="info">by <strong>Aiden Pearce</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">October 6, 2016</div>
  <div class="post-categories">
  in 
    
    <a href="/category/Digital">Digital</a>, 
    
  
    
    <a href="/category/Forensic">Forensic</a>
    
  
  </div>
</section>

<article class="post-content">
  <p>Menurut Wikipedia, Registry, dalam platform sistem operasi Microsoft Windows 32-bit, merupakan sebuah basis data yang disusun secara hierarkis yang mengandung informasi mengenai konfigurasi sebuah sistem, mulai dari konfigurasi perangkat keras, perangkat lunak, asosiasi ekstensi berkas dengan aplikasinya hingga preferensi pengguna.”</p>

<p>Pada postingan ini hanya akan membahas hive 
<i>HKCU (HKEY_CURRENT_USER)</i> , HKCU sendiri support pada file 
<i>NTUSER.DAT</i>.</p>

<h1 id="run-command-history">Run Command History</h1>

<p>history Run Command ( CTRL + R ) terletak pada HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU</p>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://1.bp.blogspot.com/-J4m3ieDIUsM/V_UrkB6UUwI/AAAAAAAABC4/UuFx79ddYOsqsakT6fl5Um0t4qL-XQYSwCLcB/s1600/ScreenShot_20161005093330.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://1.bp.blogspot.com/-J4m3ieDIUsM/V_UrkB6UUwI/AAAAAAAABC4/UuFx79ddYOsqsakT6fl5Um0t4qL-XQYSwCLcB/s1600/ScreenShot_20161005093330.png" />
	</a>
</div>
<p>Name nya terdiri dari alfabet, dan MRUList terlihat pada bagian data merupakan history command yang paling terkahir digunakan adalah pada letter ‘b’.</p>

<h1 id="recent-open-and-save-file">Recent Open And Save File</h1>

<p>History Recent Open And Save File terletak pada key HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32, dimana key tersebut mempunyai 2 sub-key penting yaitu OpenSavePidlMRU dan LastVisitedPidlMRU.</p>

<p><b>- OpenSavePidlMRU</b> akan tercatat apabila file yang kita Open/Save melalui “Windows Shell Dialog”, Windows Shell Dialog sendiri merupakan dialog save atau open yang sering kita lihat apabila ingin mendownload gambar misal nya melalui browser, atau saat ingin membuka file pada office word.</p>

<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
	<tbody>
		<tr>
			<td style="text-align: center;">
				<a href="https://1.bp.blogspot.com/-Pb2HY0_g5Bs/V_UwdXYPwpI/AAAAAAAABDM/jkpp9FfgmxQepAUHHRnrRJQB5XleB2B0ACLcB/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;">
					<img border="0" src="https://1.bp.blogspot.com/-Pb2HY0_g5Bs/V_UwdXYPwpI/AAAAAAAABDM/jkpp9FfgmxQepAUHHRnrRJQB5XleB2B0ACLcB/s1600/2.png" />
				</a>
			</td>
		</tr>
		<tr>
			<td class="tr-caption" style="text-align: center;">file : myurl.txt</td>
		</tr>
	</tbody>
</table>
<p>Pada bagian value nya terdapat angka index 0 sampai 3, yang merupakan index file yang pernah saya open/save, untuk value MRUListEx pada bagian data nya berisi masing2 nilai index file, yang paling kiri adalah file paling baru yang di open/save.</p>

<p><b>- LastVisitedPidlMRU</b> berisi value dari nama applikasi yang digunakan untuk Open/Save file pada key OpenSavePidlMRU</p>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://4.bp.blogspot.com/-dlunDM2SQdo/V_Uymtssg2I/AAAAAAAABDY/WEna-GtIQvkeZrNn1E7p0uAfFVptEo1ZwCLcB/s1600/3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://4.bp.blogspot.com/-dlunDM2SQdo/V_Uymtssg2I/AAAAAAAABDY/WEna-GtIQvkeZrNn1E7p0uAfFVptEo1ZwCLcB/s1600/3.png" />
	</a>
</div>
<p>Karena tadi saya membuka file .txt, tepat nya pada index ke 6, tercatat aplikasi notepad.exe yang memang saya gunakan untuk membuka file ‘myurl.txt’ tadi</p>

<h1 id="windows-explorer-search-history">Windows Explorer Search History</h1>

<p>Windows Explorer Search History terletak pada key HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery</p>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://1.bp.blogspot.com/-SP-q__1AD2c/V_U0DAjW5EI/AAAAAAAABDg/92BqGPZQ_DgdI_UOcu8r8remsH1y_TlMwCLcB/s1600/4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://1.bp.blogspot.com/-SP-q__1AD2c/V_U0DAjW5EI/AAAAAAAABDg/92BqGPZQ_DgdI_UOcu8r8remsH1y_TlMwCLcB/s1600/4.png" />
	</a>
</div>
<p>Sebelum nya saya mencari pada windows explorer dengan keyword “ebook file”, dan keyword tersebut  langsung tercatat pada key WordWheelQuery.</p>

<h1 id="running-count-and-last-execution-date-and-time">Running Count And Last Execution date and time</h1>

<p>History Running Count And Last Execution date and time, terletak pada key HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\UserAssist, yang dimana key UserAssist akan menampilkan berapa kali program dijalankan dan kapan waktu terakhir program tersebut dijalankan.</p>

<p>Susunan UserAssist :</p>

<ul>
	<li>&nbsp;&nbsp;&nbsp; Windows XP</li>
</ul>
<p>        {5E6AB780-7743-11CF-A12B-00AA004AE837}
            Count
        {75048700-EF1F-11D0-9888-006097DEACF9}
            Count</p>

<ul>
	<li>Windows 7, 8, 10</li>
</ul>
<p>        {CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}
            Count
        {F4E57C4B-2036-45F0-A9AB-443BCFE33D9F}
            Count</p>
<ul>
  <li>Setiap Value pada subkey “Count” di encode dengan Rot-13.</li>
</ul>

<p>Saya akan mecoba cari tahu berapa kali “Mozilla Firefox” dijalankan pada System, “Mozilla Firefox” apabila di konversi ke rot13 akan menjadi “Zbmvyyn Sversbk”</p>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://3.bp.blogspot.com/-nlloHWdUTAQ/V_U4z5LixMI/AAAAAAAABDw/jEO-IFRJF3w7f9v4bDj9GB_1cgy17NLSQCLcB/s1600/5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://3.bp.blogspot.com/-nlloHWdUTAQ/V_U4z5LixMI/AAAAAAAABDw/jEO-IFRJF3w7f9v4bDj9GB_1cgy17NLSQCLcB/s1600/5.png" />
	</a>
</div>
<p>Mozilla Firefox dijalankan sebanyakan 8 kali sesuai dengan nilai yang ada pada offset 0x04.</p>

<p><b>Catatan Penting :</b></p>

<p>Pada value MRUListEx setiap data nya memiliki ukuran 4 bytes tersimpan dalam little indian. Setiap bagian yang paling kiri adalah yang paling terakhir dibuka/dijalankan.</p>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://4.bp.blogspot.com/-wx86Koose7A/V_U6RIzU55I/AAAAAAAABD8/NMEcN-uaPgElv6YLpK5lc5cn-oKtbhBLACLcB/s1600/NOTE.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://4.bp.blogspot.com/-wx86Koose7A/V_U6RIzU55I/AAAAAAAABD8/NMEcN-uaPgElv6YLpK5lc5cn-oKtbhBLACLcB/s1600/NOTE.png" />
	</a>
</div>
<p>[to..be..continue]……</p>

<p>Sebelumnya mohon maaf apabila ada salah pemberian definisi. Dan semoga postingan ini dapat bermanfaat bagi kita semua.</p>

<p>referensi :</p>

<p>https://digital-forensics.sans.org/blog/2010/04/02/openrunsavemru-lastvisitedmru/
https://msdn.microsoft.com/en-us/library/windows/desktop/ms724877(v=vs.85).aspx
http://www.4n6k.com/2015/05/forensics-quickie-ntuserdat-analysis.html</p>

</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/Digital Forensic">Digital Forensic</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=Windows+Forensic+Artifact+-+Registry+Part+1&u=https%3A%2F%2Frhama.my.id%2Fdigital%2Fforensic%2F2016%2F10%2F06%2Fwindows-forensic-artifact-registry-part.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
      <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent('https://rhama.my.id/digital/forensic/2016/10/06/windows-forensic-artifact-registry-part.html') + '&title=Windows Forensic Artifact - Registry Part 1'; return false">
        <i class="fa fa-reddit-square fa-lg"></i>
      </a>
    
    
  
    
    
    
    
    
    
    
    
  
</section>




</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">CTF.Ninja</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/about/">About</a>
        
        
        
          <li class="nav-link"><a href="/posts/">Archives</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:r4m@protonmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">r4m@protonmail.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://www.facebook.com/eat.sleep.pwn.repeat" title="Friend me on Facebook">
              <i class="fa fa-facebook"></i>
              <span class="username">eat.sleep.pwn.repeat</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">CTF, InfoSec, Banana And More.
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>






  </body>

</html>
