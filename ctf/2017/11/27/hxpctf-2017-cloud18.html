<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>hxp CTF 2017 - cloud18 (web 150)</title>
  <meta name="description" content="We also did an online text editor! We also made it, like, super secure! We are so confident that we even give you the source code.Download:">
  
  <meta name="author" content="rhama">
  <meta name="copyright" content="&copy; rhama 2017">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="We also did an online text editor! We also made it, like, super secure! We are so confident that we even give you the source code.Download:" />
  <meta property="og:url" content="https://rhama.my.id/ctf/2017/11/27/hxpctf-2017-cloud18.html" />
  <meta property="og:site_name" content="CTF.Ninja" />
  <meta property="og:title" content="hxp CTF 2017 - cloud18 (web 150)" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://rhama.my.id/assets/images/CTF.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="hxp CTF 2017 - cloud18 (web 150)">
  <meta name="twitter:description" content="We also did an online text editor! We also made it, like, super secure! We are so confident that we even give you the source code.Download:">
  <meta name="twitter:image" content="https://rhama.my.id/assets/images/CTF.png">
  <meta name="twitter:url" content="https://rhama.my.id/ctf/2017/11/27/hxpctf-2017-cloud18.html">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
   <link rel="stylesheet" href="/css/terminal.css">
  <link rel="canonical" href="https://rhama.my.id/ctf/2017/11/27/hxpctf-2017-cloud18.html">
  <link rel="alternate" type="application/rss+xml" title="CTF.Ninja" href="https://rhama.my.id/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="CTF.Ninja">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
          <li class="nav-link"><a href="/posts/">Archives</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/images/CTF.png);">
  <div class="scrim has-cover">
    <header class="post-header">
      <h1 class="title">hxp CTF 2017 - cloud18 (web 150)</h1>
      <p class="info">by <strong>CTF.Ninja</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">November 27, 2017</div>
  <div class="post-categories">
  in 
    
    <a href="/category/CTF">Ctf</a>
    
  
  </div>
</section>

<article class="post-content">
  <article class="post-content">
<pre style="background:#000;color:#f8f8f8;">We also did an online text editor! We also made it, like, super secure! We are so confident that we even give you the source code.
Download:

<a href="https://2017.CTF.link/assets/files/65e868ae9518a3fd226e71d4041be9d4cd8350d7552b46832f3e7f0b5d6e03af.tar.xz">65e868ae9518a3fd226e71d4041be9d4cd8350d7552b46832f3e7f0b5d6e03af.tar.xz</a>
Connection:

<span style="color:#e18964;text-decoration:underline;">http://35.198.105.111:5475/</span>

</pre>
<p>Diberikan sebuah website beserta source code nya. Tampilan awal web tersebut hanya terdapat form login dan register. fungsi web tersebut adalah online editor, fungsi editor sendiri akan muncul setelah user login.
<img class="wp-image-104 size-lodestar-featured-image aligncenter" src="https://bytetolong.files.wordpress.com/2017/11/screenshot_2017-11-19_12-54-41.png?w=610&amp;h=565&amp;crop=1" alt="" width="610" height="565" />
Berikut daftar file source code yang diberikan</p>
<pre style="background:#000;color:#f8f8f8;">$ ls
editor.php  index.php  logout.php  register.php  stylesheet.css  User.php
</pre>
<p><strong>Snippet editor.php</strong></p>
<div class="language-php highlighter-rouge"><pre class="highlight"><code>if (preg_match("/exec|system|passthru|`|proc_open|popen/", strtolower($_POST["method"].$_POST["text"])) != 0) {
    exit("Do you really think you could pass something to the command line? Functions like this are often disabled! Maybe have a look at the source?");
}
...............
    $editedText = preg_replace_callback("/" . $_POST["regex"] . "/", function ($matches) {
        return call_user_func($_POST["method"], $matches[0]);
    }, $_POST["text"]);
    if($editedText) {
        echo("<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">'alert success'</span><span class="nt">&gt;</span>" . $editedText . "<span class="nt">&lt;/div&gt;</span>");
    }
</code></pre>
</div>
<p><strong>Snippet index.php</strong></p>
<div class="language-php highlighter-rouge"><pre class="highlight"><code>    if($_SESSION["user"]){
        echo "<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">'alert success'</span><span class="nt">&gt;</span>login sucessful<span class="nt">&lt;/div&gt;</span>";
        if($_SESSION["user"]-&gt;getName() === "admin"){
            echo "<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">'alert success'</span><span class="nt">&gt;</span>" . shell_exec("/usr/bin/get_flag") . "<span class="nt">&lt;/div&gt;</span>";
        }
    }
</code></pre>
</div>
<p>Dari source code editor.php, diketahui text inputan akan di edit akan dicocokan dengan <em>regex</em> lalu me return hasil dari fungsi <em>call_user_func</em>.
fungsi dari <em>call_user_func</em> adalah untuk memanggil suatu fungsi, yang dimana parameter pertama nya adalah nama fungsi itu sendiri dan paramter kedua adalah parameter untuk fungsi yang ingin dipanggil.</p>
<p><strong><em>call_user_func(“system”,”id”)</em></strong> akan memanggil fungsi <em>system(“id”)</em>. Tapi karena terdapat filter nama fungsi, fungsi untuk eksekusi external program tidak bisa di digunakan. Karena parameter untuk nama fungsi di ambil dari <strong>$_POST[“method”]</strong> dalam hal ini kita bisa memanipulasi nama fungsi yang dipanggil <em>call_user_func</em> dengan memodifikasi value dari method itu sendiri via inspect element.</p>
<div class="language-html highlighter-rouge"><pre class="highlight"><code>        <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"method"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">""</span> <span class="na">disabled</span> <span class="na">selected</span><span class="nt">&gt;</span>select a method<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"strtoupper"</span><span class="nt">&gt;</span>to upper case<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"strtolower"</span><span class="nt">&gt;</span>to lower case<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"ucfirst"</span><span class="nt">&gt;</span>first letter to upper case<span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;/select&gt;</span>
</code></pre>
</div>
<p>Berdasarkan source code index.php, lokasi flag berada di <strong>“/usr/bin/get_flag”</strong>. Oleh karena itu bisa digunakan fungsi <code class="highlighter-rouge">readfile</code> untuk membaca isi dari <code class="highlighter-rouge">/usr/bin/get_flag</code>.</p>
<p><img class="aligncenter wp-image-103 size-lodestar-featured-image" src="https://bytetolong.files.wordpress.com/2017/11/screenshot_2017-11-19_13-11-47.png?w=593&amp;h=546&amp;crop=1" alt="" width="593" height="546" />
Gunanya regex : <strong>^[ -~]+$</strong> adalah agar match dengan semua dengan karakter yang di input pada bagian text.</p>
<p>Setelah disubmit, akan muncul isi dari <em>/usr/bin/get_flag</em>. tinggal CTR + F “hxp” untuk mendapatkan string Flag.</p>
<p><strong>Flag : hxp{Th1s_w2sn’t_so_h4rd_now_do_web_of_ages!!!Sorry_f0r_f1rst_sh1tty_upload}</strong></p>
</article>

</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/hxpCTF2017">hxpCTF2017</a>,&nbsp;<a href="/tag/CTF">CTF</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=hxp+CTF+2017+-+cloud18+%28web+150%29&u=https%3A%2F%2Frhama.my.id%2Fctf%2F2017%2F11%2F27%2Fhxpctf-2017-cloud18.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
      <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent('https://rhama.my.id/ctf/2017/11/27/hxpctf-2017-cloud18.html') + '&title=hxp CTF 2017 - cloud18 (web 150)'; return false">
        <i class="fa fa-reddit-square fa-lg"></i>
      </a>
    
    
  
    
    
    
    
    
    
    
    
  
</section>




</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">CTF.Ninja</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/about/">About</a>
        
        
        
          <li class="nav-link"><a href="/posts/">Archives</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:r4m@protonmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">r4m@protonmail.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://www.facebook.com/eat.sleep.pwn.repeat" title="Friend me on Facebook">
              <i class="fa fa-facebook"></i>
              <span class="username">eat.sleep.pwn.repeat</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">CTF, InfoSec, Banana And More.
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>






  </body>

</html>
