<!DOCTYPE html>
<html>
<head>
    <!-- [[! Document Settings ]] -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- [[! Page Meta ]] -->
    <title>Tutorial Memory Forensic Dengan Volatility</title>
    <meta name="description" content="uid=0 (root) - CTF, InfoSec, Banana And More.." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/assets/images/favicon.ico" >

    <!-- [[! Styles'n'Scripts ]] -->
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css"
          href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css" />

    <!-- [[! highlight.js ]] -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- [[! Ghost outputs important style and meta data with this tag ]] -->
        <link rel="canonical" href="/" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="/page2/" />

    <meta property="og:site_name" content="uid=0 (root)" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="uid=0 (root)" />
    <meta property="og:description" content="CTF, InfoSec, Banana And More.." />
    <meta property="og:url" content="/" />
    <meta property="og:image" content="/assets/images/cover1.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="uid=0 (root)" />
    <meta name="twitter:description" content="CTF, InfoSec, Banana And More.." />
    <meta name="twitter:url" content="/" />
    <meta name="twitter:image:src" content="/assets/images/cover1.jpg" />

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "uid=0",
    "url": "/",
    "image": "/assets/images/cover1.jpg",
    "description": "CTF, InfoSec, Banana And More.."
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="uid=0 (root)" href="/feed.xml" />


</head>
<body class="home-template nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Home</a></li>
        <li class="nav-about " role="presentation"><a href="/about">About</a></li>
         <li class="nav-archive " role="presentation"><a href="/archive">Archives</a></li>
        <li class="nav-fables " role="presentation"><a href="/tag/CTF">CTF</a></li>
        <li class="nav-speeches " role="presentation"><a href="/tag/Digital Forensic">Digital Forensic</a></li>
        <li class="nav-fiction " role="presentation"><a href="/tag/Pentesting">Pentesting</a></li>
        <li class="nav-author " role="presentation"><a href="/tag/RE">Rerverse Engineering</a></li>
    </ul>
    <a class="subscribe-button icon-feed" href="/feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- [[! Everything else gets inserted here ]] -->
        <!-- < default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<header class="main-header post-head " style="background-image: url(/assets/images/forensic.jpg) ">
    <nav class="main-nav  overlay  clearfix">
        <a class="blog-logo" href="/"><img src="/assets/images/ghost.png" alt="Blog Logo" /></a>
        
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-fiction">

        <header class="post-header">
            <h1 class="post-title">Tutorial Memory Forensic Dengan Volatility</h1>
            <section class="post-meta">
            <!-- <a href='/'>Aiden Pearce</a> -->
            <time class="post-date" datetime="2016-03-18">18 Mar 2016</time>
                <!-- [[tags prefix=" on "]] -->
                 
                on 
                
                    
                       <a href='/tag/Digital Forensic'>Digital forensic</a>
                       
                
                
            </section>
        </header>

        <section class="post-content">
            
            <p>Terdapat Challenge Memory Forensic yang diberikan oleh 
<i>Indonesia Digital Forensic Community</i> pada halaman facebook nya
( https://www.facebook.com/idforensic/posts/571872846243270 )</p>

<p>Berikut adalah pertanyaan dari Challenge tersebut</p>

<p><b>Memory analysis challenge : </b></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="m">1</span>. Identifikasi jenis OS-nya
<span class="m">2</span>. Identifikasi proses yang mencurigakan
<span class="m">3</span>. Identifikasi service yang mencurigakan
<span class="m">4</span>. Identifikasi remote IP yang mentriger proses tersebut
<span class="m">5</span>. Apakah tipe malware yang menginfeksi komputer tersebut
<span class="m">6</span>. Apakah dikomputer tersebut terinstall antivirus 
<span class="m">7</span>. Temukan aplikasi atau service yang <span class="s2">&quot;vulnerable&quot;</span> yang mungkin dimanfaatkan oleh si hacker untuk masuk ke dalam komputer tersebut
<span class="m">8</span>. Pertanyaan Bonus :
Hacker tersebut ternyata juga berhasil mencuri informasi yang tersimpan pada suatu file di komputer tersebut. Informasi tersebut adalah
akun yang dapat digunakan untuk mengakses suatu server. Dapatkah anda menemukan informasi yang tersimpan pada file tersebut ?</code></pre></figure>

<p>    Banyak sekali tool yang dapat digunakan untuk melakukan memory forensic, tapi saya memilih
<b>volatility</b> untuk mengerjakan Challenge ini, karena 
<b>volatility</b> powerfull dan mudah digunakan. Untuk penggunaka distro pentest seperti kali linux dan backbox seperti Volatility sudah terinstall otomatis, dan untuk distro linux yang belum terinstall volatility bisa langsung mengunjungi situs resmi nya di ( http://www.volatilityfoundation.org/ ). 
<b>Volatility</b> ditulis menggunakan bahasa python jadi tidak menutup kemungkinan dapat berjalan di platform Windows, tapi pada tutorial ini saya menggunakan linux dan semua step nya sama saja dengan os-os lain.</p>

<p><b>Detail File Challenge :</b></p>

<p>Name : RAM.mem
MD5 : 47ca9f4ef6549705a9337166ac45ea82
Size : 536809472 bytes</p>

<h1 id="proof-of-concept">Proof Of Concept</h1>

<p>syntaxt umum :</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>vol -f FileName &lt;Options&gt;</code></pre></figure>

<h2 id="pertanyaan-nomor-1-nbsp-identifikasi-jenis-os-nya">Pertanyaan nomor 1 :  Identifikasi jenis OS-nya</h2>
<p>Untuk identifikasi jenis os nya kita dapat menggunakan Plugin imageinfo</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>vol -f RAM.mem imageinfo</code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://3.bp.blogspot.com/-ZKgmjPDoMuA/VuuQMpgbkgI/AAAAAAAAA8Y/ANqXovR3kIshFROaygBt1dE6pxqN7g9Cg/s1600/image1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://3.bp.blogspot.com/-ZKgmjPDoMuA/VuuQMpgbkgI/AAAAAAAAA8Y/ANqXovR3kIshFROaygBt1dE6pxqN7g9Cg/s1600/image1.png" />
	</a>
</div>
<p>pada bagian 
<i>Suggested Profile(s)</i> dapat kita lihat bahwa RAM.mem didump pada os Windows XP.
Tapi kenapa ada muncul 2 , 
<i>WinXPSP2</i> Dan 
<i>WinXPSP3</i> ? Iyaa karena itu profile yang tersedia pada   Volatility yang dapat kita gunakan untuk melakukan kegiatan seperti melihat prosses, history dan sebagai nya menggunakan Volatility.</p>

<h2 id="pertanyaan-nomo-2-nbsp-identifikasi-proses-yang-mencurigakan">Pertanyaan Nomo 2 :  Identifikasi proses yang mencurigakan</h2>
<p>Untuk indentifikasi proses kita bisa menggunakan salah satu Plugin pslist, psscan serta pstree karena ketiga Plugin tersebut digunakan untuk melihat running proses.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>vol -f RAM.mem --profile<span class="o">=</span>WinXPSP2x86 pslist</code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://2.bp.blogspot.com/-85mmBd3u49E/VuuQQhb7lEI/AAAAAAAAA8c/qNRpTDtOvccZBbDtbsUrQmpJVJFn6FRMQ/s1600/image2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://2.bp.blogspot.com/-85mmBd3u49E/VuuQQhb7lEI/AAAAAAAAA8c/qNRpTDtOvccZBbDtbsUrQmpJVJFn6FRMQ/s1600/image2.png" />
	</a>
</div>
<p>Dari output tersebut kita dapat menentukan proses mana yang mencurigakan, dan saya perhatikan ada proses dengan nama 
<i>wscript.exe</i> pada pid 584, 
<i>metsvc.exe</i> pada pid 1644 serta 
<i>qNPEwOBAwGzOSN.</i> Pada pid 1760. karena ane mencuriguakan ketiga proses tersebut merupakan payload dari metasploit ( https://www.offensive-security.com/metasploit-unleashed/interacting-metsvc/ ).</p>

<h2 id="pertanyaannbsp-nomor-3--identifikasi-remote-ip-yang-mentriger-proses-tersebut">Pertanyaan  nomor 3 : Identifikasi remote IP yang mentriger proses tersebut</h2>
<p>Untuk indentifikasi remote ip tentu kita harus mengecek connection layak nya kita menggunakan 
<code>netstat</code>, Plugin yang digunakan untuk proses ini bisa kita gunakan 
<code>connections</code> untuk melihat koneksi yang terbukan ( Windows XP dan Windows Server 2003) serta 
<code>connscan</code>untuk melihat koneksi TCP</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>vol -f RAM.mem --profile<span class="o">=</span>WinXPSP2x86 connections
vol -f RAM.mem --profile<span class="o">=</span>WinXPSP2x86 connscan</code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://4.bp.blogspot.com/-AvKlQF9S4Vw/VuuQSPtrfzI/AAAAAAAAA8g/xyNdqvATg3o7C_D4MVMSZm_NJDTgkKvPg/s1600/image3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://4.bp.blogspot.com/-AvKlQF9S4Vw/VuuQSPtrfzI/AAAAAAAAA8g/xyNdqvATg3o7C_D4MVMSZm_NJDTgkKvPg/s1600/image3.png" />
	</a>
</div>
<p>Terdapat 2 ip yang mempunyai remote koneksi, terus yang mana ini yang bener ? Karena kita tadi mencurigai ini merupakan payload metsvc metasploit, jadi kita coba melihat history internet explore apakah korban mengakses sesuatu yang menyebabkan payload ini bisa dieksekusi di PC korban</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>vol -f RAM.mem --profile<span class="o">=</span>WinXPSP2x86 iehistory</code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://2.bp.blogspot.com/-hgwq55hF9-A/VuuQUhkb6HI/AAAAAAAAA8k/ut7Q0Seetz8_qWDq1Mye-161Co3E_cGkw/s1600/image4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://2.bp.blogspot.com/-hgwq55hF9-A/VuuQUhkb6HI/AAAAAAAAA8k/ut7Q0Seetz8_qWDq1Mye-161Co3E_cGkw/s1600/image4.png" />
	</a>
</div>
<p>Terdapat koneksi ke 
<i>http://192.168.88.44:8080/payloads/trojan.exe</i> dan 
<i>http://192.168.88.44:8080/payloads/ </i>.  Dan tentu kita semua tau ini adalah payload dari metasploit yang kita curigrai sebelum nya.
Ternyata IP yang  mentriger proses tersebut adalah ip 
<b>192.168.88.44</b></p>

<h2 id="pertanyaan-nomor-5-nbsp-apakah-tipe-malware-yang-menginfeksi-komputer-tersebut">Pertanyaan nomor 5 :  Apakah tipe malware yang menginfeksi komputer tersebut</h2>
<p>Untuk mengetahui tipe dari malware yang menginfeksi tentu kita bisa menggunakan anti virus, dan agar bisa di scan menggunakan anti virus tentu malware tersebut harus ada, oleh karena itu kita bisa dump malware tersebut dengan Plugin 
<code>procdump</code></p>

<p>Ingat !! proses mencurigakan yang kita kumpulkan pada soal nomor 2 adalah  
<i>wscript.exe</i> pada pid 584, 
<i>metsvc.exe</i> pada pid 1644 serta 
<i>qNPEwOBAwGzOSN.</i> Pada pid 1760, tapi disini kita hanya perlu 
<i>dump</i> file  metsvc.exe dan qNPEwOBAwGzOSN. Karena wscript tersebut ada karena adanya file trojan.exe tadi sehingga wscript menciptakan proses qNPEwOBAwGzOSN.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>vol -f RAM.mem --profile<span class="o">=</span>WinXPSP2x86 procdump -p <span class="m">1644</span>,1760 -D virus</code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://1.bp.blogspot.com/-49vY6oDhsqo/VuuQ9pQ7pRI/AAAAAAAAA8s/vy9GkOuHAnAC9gJYQKO6MWNbKIK2uERJA/s1600/image5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://1.bp.blogspot.com/-49vY6oDhsqo/VuuQ9pQ7pRI/AAAAAAAAA8s/vy9GkOuHAnAC9gJYQKO6MWNbKIK2uERJA/s1600/image5.png" />
	</a>
</div>
<p>Output dari dump tersebut berada pada directory virus. Selanjutnya mari kita scanning dengan http://virustotal.com/</p>

<p><b>Hasil Scan Virustotal : </b></p>

<p>executable.1644.exe
Detection ratio:
16 / 57</p>

<p>https://www.virustotal.com/en/file/065d005d090ebbf6376907bcda3341d6a2fd1b3199ce1045221f55ab6313e147/analysis/</p>

<p>executable.1760.exe
Detection ratio:
44 / 55</p>

<p>https://www.virustotal.com/en/file/3e8719442ab0bc70bf4cc76da0052e57fbd1dcaac57a7b5738661b81299c67b0/analysis/</p>

<p>Tipe malware tersebut adalah 
<b>Trojan</b></p>

<p>Pertanyaan nomor nomor 6 : Apakah dikomputer tersebut terinstall antivirus 
Untuk melihat apakah dikomputer ini terinstall antivirus kita bisa menggunakan plugin shimcache</p>

<blockquote class="tr_bq">vol -f RAM.mem --profile=WinXPSP2x86 shimcache</blockquote>
<div class="separator" style="clear: both; text-align: center;">
	<a href="https://1.bp.blogspot.com/-BWvw2eyyelc/VuuRALhqoFI/AAAAAAAAA8w/o1HsNYtuaW8pMp0D0552_oWMlraxZtG9g/s1600/image6.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://1.bp.blogspot.com/-BWvw2eyyelc/VuuRALhqoFI/AAAAAAAAA8w/o1HsNYtuaW8pMp0D0552_oWMlraxZtG9g/s1600/image6.png" />
	</a>
</div>
<p>Ternyata komputer tersebut menggunakan 
<b>Anti-Virus Kaspersky Internet Security.</b></p>

<h2 id="pertanyaan-nomornbsp-7--temukan-aplikasi-atau-service-yang-vulnerable-yang-mungkin-dimanfaatkan-oleh-si-hacker-untuk-masuk-ke-dalam-komputer-tersebut">Pertanyaan nomor  7 : Temukan aplikasi atau service yang “vulnerable” yang mungkin dimanfaatkan oleh si hacker untuk masuk ke dalam komputer tersebut</h2>

<p>Sebenar nya saya bingung untuk menjawab pertanyaan ini karena pengetahuan saya yang masih kurang, kita dilihat dari proses yang running tidak melihat adanya vulnerable applications, tapi untuk mengecek service nya bisa menggunakan plugin svcscan.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>vol -f RAM.mem --profile<span class="o">=</span>WinXPSP2x86 svcscan</code></pre></figure>

<div class="separator" style="clear: both; text-align: center;">
	<a href="https://1.bp.blogspot.com/-a76IRYwxMOI/VuuRB-Oh8-I/AAAAAAAAA80/jYStHcwYILoiFTTiPdES8-x8aPKH8oWbQ/s1600/image7.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
		<img border="0" src="https://1.bp.blogspot.com/-a76IRYwxMOI/VuuRB-Oh8-I/AAAAAAAAA80/jYStHcwYILoiFTTiPdES8-x8aPKH8oWbQ/s1600/image7.png" />
	</a>
</div>
<p>Pada service metsvc tersebut tercipta karena ada nya payload metasploit yang dieksekusi pada komputer korban. Jadi saya simpulkan bahwa service yang vulnrable itu metsvc nya</p>

<p>Untuk pertanyaan bonus nomor 8 masih menjadi misteri, karena sampai saat ini saya belum bisa mengambil file tersebut, file yang dimaksud adalah file account.txt yang terletak di C:/Documents and Settings/WINVICTIM/My Documents/</p>

<p><b>Akhir kata..</b></p>

<p>Semoga tutorial ini dapat bermanfaat bagi kita semua dan mohon maaf apabila ada yang salah dalam pemberian definisi</p>


        </section>

        <footer class="post-footer">

            <!-- Everything inside the #author tags pulls data from the author -->
            <!-- #author-->

            
            <figure class="author-image">
                <a class="img" href="/author/rhama" style="background-image: url(/assets/images/casper.png)"><span class="hidden">Aiden Pearce's Picture</span></a>
            </figure>
            

            <section class="author">
                <h4><a href="/author/rhama">Aiden Pearce</a></h4>
                
                
                    <p> Beyond The Limit</p>
                
                <div class="author-meta">
                    <span class="author-location icon-location"> NTB, Indonesia</span> 
                    <span class="author-link icon-link"><a href="127.0.0.1:4000"> 127.0.0.1:4000</a></span> 
                </div>
            </section>

            <!-- /author  -->

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Tutorial Memory Forensic Dengan Volatility&amp;url=127.0.0.1:4000memory-forensic-dengan-volatility"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=127.0.0.1:4000memory-forensic-dengan-volatility"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=127.0.0.1:4000memory-forensic-dengan-volatility"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>
            
            <!-- Add Disqus Comments -->
            
            
        </footer>

    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
        <a class="read-next-story " style="background-image: url(/assets/images/forensic.jpg)" href="/tutorial-dump-windows-memory-untuk">
            <section class="post">
                <h2>Tutorial Dump Windows Memory Untuk Forensic</h2>
                <p>Assalamualaikum... Dump Windows Memory - Proses analys barang bukti kejahatan haruslah ditangani dengan tepat agar...</p>
            </section>
        </a>
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/forensic.jpg)" href="/tutorial-menggunakan-autopsy-forensic">
            <section class="post">
                <h2>Tutorial Menggunakan Autopsy Forensic Browser</h2>
                <p>Tutorial Menggunakan Autopsy Forensic Untuk Digital Forensic - Autopsy adalah tool yang dibuat menggunakan bahasa...</p>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->


        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">uid=0 (root)</a> &copy; 2017</section>
          <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/biomadeira/jasper">Jasper</a></section>
        </footer>
    </div>
    <!-- [[! Ghost outputs important scripts and data with this tag ]] -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <!-- [[! The main JavaScript file for Casper ]] -->
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-69281367-1', 'auto');
	    ga('send', 'pageview');

     </script>   
</body>
</html>
